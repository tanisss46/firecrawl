{
  "content": "# Testing financial account integration\n\n## Learn how to ensure your financial accounts are functioning correctly.\n\nStripe Treasury includes a live mode and test mode. You can toggle between modes\nfrom your Dashboard using the mode toggle in the upper-right corner.\n\n![Upper-corner of Dashboard with a red box highlighting the test mode\ntoggle.](https://b.stripecdn.com/docs-statics-srv/assets/test-mode.13546c94012a516a6d6069120f064c99.png)\n\nTest mode toggle\n\n#### Note\n\nYou must complete the [Gaining API access to\nTreasury](https://docs.stripe.com/treasury/access) guide’s live mode steps\nbefore you have access to live mode financial accounts.\n\nTo access test mode in the API, use the test mode API key with your requests.\nThe test mode API key is included within most documentation code examples, but\nyou can also find it in the **Developers** page of your\n[Dashboard](https://dashboard.stripe.com/test/apikeys). Make sure to use the\ntest key for testing and not the live one. The test key has the form\n`sk_test_xxx`, whereas the live key is in the form `sk_live_xxx`.\n\nBefore creating a test financial account, create a test connected account using\n`POST /v1/accounts`. Use the connected account ID you receive from the response\nto assign the financial account you create in the next step to this account.\nTreasury is supported only in the US, so assign `US` to the `country` parameter.\nYou’re also requesting capabilities for the connected account that Treasury\nrequires to function properly. Make note of the `id` value in the response. As\nmentioned, you use the ID as the value for the `Stripe-Account` header in the\nfollowing code example.\n\n```\ncurl https://api.stripe.com/v1/accounts \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d country=US \\\n -d type=custom \\\n -d business_type=company \\\n -d \"capabilities[card_payments][requested]\"=true \\\n -d \"capabilities[transfers][requested]\"=true \\\n -d \"capabilities[treasury][requested]\"=true\n```\n\nIf successful, the response returns the new connected account\n[Account](https://docs.stripe.com/api/accounts) object.\n\n```\n{\n \"id\": \"{{CUSTOM_ACCOUNT_ID}}\",\n \"livemode\": false,\n ...\n}\n```\n\nNext, create a financial account using `POST /v1/treasury/financial_accounts`.\nInclude a `Stripe-Account` header set to the value of the connected account ID\nyou created in the previous instruction. The only required value in the body is\nto set `supported_currencies[]` to `usd`. To learn more about financial\naccounts, see [Working with financial\naccounts](https://docs.stripe.com/treasury/account-management/financial-accounts)\nor the\n[FinancialAccounts](https://docs.stripe.com/api/treasury/financial_accounts)\nobject description in the Stripe API reference.\n\n```\ncurl https://api.stripe.com/v1/treasury/financial_accounts \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -H \"Stripe-Account: {{CONNECTED_ACCOUNT_ID}}\" \\\n -d \"supported_currencies[]\"=usd \\\n -d \"features[financial_addresses][aba][requested]\"=true\n```\n\nIf successful, the response returns the newly created `FinancialAccount` object.\n\n```\n{\n \"id\": \"{{FINANCIAL_ACCOUNT_ID}}\",\n \"livemode\": false,\n \"active_features\": [],\n \"pending_features\": [],\n \"restricted_features\": [\"financial_addresses.aba\"],\n ...\n}\n```\n\nYou now have a test mode financial account attached to a test mode connected\naccount. However, the connected account hasn’t been onboarded so required\ninformation is missing from the `requirements` hash. If you call `GET\n/v1/treasury/financial_accounts/{{FINANCIAL_ACCOUNT_ID}}` using the financial\naccount ID in the JSON response of the previous instruction, you see the\n`financial_addresses` array of hashes has an entry for the requested `aba` with\na `status` of `restricted` because the connected account has\n`requirements_past_due`.\n\n```\n{\n …\n \"financial_addresses\": {\n \"aba\": {\n \"requested\": true,\n \"status\": \"restricted\",\n \"status_details\": [\n {\n \"code\": \"requirements_past_due\",\n \"resolution\": \"provide_information\"\n }\n ]\n }\n }\n …\n}\n```\n\nTo enable requested features on your test mode financial account without first\ngoing through connected account onboarding, you must use `POST\n/v1/accounts/{{CONNECTED_ACCOUNT_ID}}` to [provide test\nvalues](https://docs.stripe.com/connect/testing-verification) that fulfill all\nthe requirements, as in the following request that uses a previously created\nconnected account to apply the required account details.\n\n#### Note\n\nYou can’t create a test mode financial account attached to a live mode connected\naccount.\n\n```\ncurl https://api.stripe.com/v1/accounts/{{CONNECTED_ACCOUNT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"tos_acceptance[date]\"=1547923073 \\\n -d \"tos_acceptance[ip]\"=\"172.18.80.19\" \\\n -d \"settings[treasury][tos_acceptance][date]\"=1547923073 \\\n -d \"settings[treasury][tos_acceptance][ip]\"=\"172.18.80.19\" \\\n -d \"business_profile[mcc]\"=5045 \\\n --data-urlencode \"business_profile[url]\"=\"https://bestcookieco.com\" \\\n -d \"company[address][city]\"=Schenectady \\\n -d \"company[address][line1]\"=\"123 State St\" \\\n -d \"company[address][postal_code]\"=12345 \\\n -d \"company[address][state]\"=NY \\\n -d \"company[tax_id]\"=000000000 \\\n -d \"company[name]\"=\"The Best Cookie Co\" \\\n -d \"company[phone]\"=8888675309 \\\n -d \"individual[first_name]\"=Jenny \\\n -d \"individual[last_name]\"=Rosen\n```\n\n## Links\n\n- [Gaining API access to Treasury](https://docs.stripe.com/treasury/access)\n- [Dashboard](https://dashboard.stripe.com/test/apikeys)\n- [Account](https://docs.stripe.com/api/accounts)\n- [Working with financial\naccounts](https://docs.stripe.com/treasury/account-management/financial-accounts)\n- [FinancialAccounts](https://docs.stripe.com/api/treasury/financial_accounts)\n- [provide test values](https://docs.stripe.com/connect/testing-verification)\n- [https://bestcookieco.com](https://bestcookieco.com)",
  "metadata": {
    "title": "Testing financial account integration | Stripe Documentation",
    "description": "Learn how to ensure your financial accounts are functioning correctly.",
    "sourceURL": "https://docs.stripe.com/treasury/account-management/testing-financial-account-integration"
  }
}