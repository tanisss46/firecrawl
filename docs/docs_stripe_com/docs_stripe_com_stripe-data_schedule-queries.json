{
  "content": "# Schedule queries\n\n## Learn how to schedule queries in Sigma that run on a recurring basis.\n\nYou can automate your Sigma queries by scheduling them to run on a daily,\nweekly, or monthly basis. Results for each scheduled query are sent with an\n[email](https://docs.stripe.com/stripe-data/schedule-queries#subscribers) to\nspecified team members or as [webhook\nevents](https://docs.stripe.com/stripe-data/schedule-queries#receiving-results-as-webhooks).\n\n## Scheduling a query\n\nWith a query loaded into the editor, click **Schedule**. We recommend you\nuniquely name all your scheduled queries to avoid confusion. If your query\ndoesn’t already have a name (or you wish to modify it), you can update it during\nthe scheduling process.\n\n!\n\n### Schedule\n\nEach scheduled query can be run on a daily, weekly, or monthly basis. Queries\nrun as soon as the data for that period is available.\n\nScheduleDescriptionDailyQueries run as soon as the data for each day (ending at\n12:00am UTC) is processed. Query results for the previous day are usually\navailable by 2pm UTC.WeeklyQueries run every week as soon as the data for the\nprevious week (ending on Sunday at 12:00am UTC) is processed. Query results for\nthe previous week are usually available by 2pm UTC the following\nMonday.MonthlyQueries run every month as soon as the data for the previous month\n(ending at 12:00am UTC) is processed. Query results for the previous month are\nusually available by 2pm UTC on the 1st of the month.\n## Subscribers\n\nCreators of scheduled queries are added as subscribers to email notifications by\ndefault. To notify other [team\nmembers](https://docs.stripe.com/get-started/account/teams) as well, enter their\nemail addresses. Results sent with an email include the name and date of the\nscheduled query, and a link to download the results in CSV format. To preview\nwhat the email looks like, click **Preview email**.\n\nYou or your team members can stop receiving notifications at any time by\nclicking the **Unsubscribe** link in the email. You can also edit the scheduled\nquery in the Dashboard and add or remove subscribers.\n\n### Timeline\n\nBased upon your chosen schedule, the timeline displays the date your query runs\nnext, and the processing date of the data it uses (additional time is required\nto make your account data available to query).\n\nManaging scheduled queries Upcoming scheduled queries are displayed under\n**Scheduled** within the **Queries** tab. Schedules are grouped based on whether\nthey were created by you or other members of your team.\n\nTo edit a scheduled query, select it and click **Edit schedule**. To delete it,\nclick **—** and select **Delete**.\n\n### Receiving results as webhooks\n\nIf you make use of [webhooks](https://docs.stripe.com/webhooks), you can receive\nnotifications for scheduled queries as webhook events. For example, Stripe sends\nthe `sigma.scheduled_query_run.created` event each time a scheduled query is\nrun. See below for a sample event.\n\nThe `data.object.file.url` subfield of the webhook payload contains the URL\nwhere you can access the results file **using your live secret API key**. For\nexample, if your server received the webhook below, it could download the\nresults using this `curl` command:\n\n```\ncurl https://files.stripe.com/v1/files/{{ FILE ID }}/contents -u\nsk_live_XXXXXXX:\n```\n\nFor more on how to integrate webhooks, see our [webhook\ndocumentation](https://docs.stripe.com/webhooks).\n\n```\n// Sample payload of a sigma.scheduled_query_run.created webhook\n\n{\n \"object\": \"event\",\n \"pending_webhooks\": 2,\n \"created\": 1504794194,\n \"type\": \"sigma.scheduled_query_run.created\",\n \"livemode\": true,\n \"request\": null,\n \"data\": {\n \"object\": {\n \"id\": \"sqr_\",\n \"object\": \"scheduled_query_run\",\n \"status\": \"completed\",\n \"data_load_time\": 1504656000,\n \"file\": {\n \"id\": \"{{ FILE ID }}\",\n \"object\": \"file\",\n \"url\": \"https://files.stripe.com/v1/files/{{ FILE ID }}/contents\",\n \"created\": 1507841188,\n \"purpose\": \"sigma_scheduled_query\",\n \"size\": 53075,\n \"type\": \"csv\"\n },\n \"title\": \"Scheduled Query Example\",\n \"sql\": \"SELECT count(*) FROM charges WHERE created >= date('2017-01-01')\",\n \"created\": 1504794194,\n \"result_available_until\": 1505398933,\n \"error\": null,\n \"livemode\": true\n }\n }\n}\n```\n\n## Links\n\n- [team members](https://docs.stripe.com/get-started/account/teams)\n- [webhooks](https://docs.stripe.com/webhooks)",
  "metadata": {
    "title": "Schedule queries | Stripe Documentation",
    "description": "Learn how to schedule queries in Sigma that run on a recurring basis.",
    "sourceURL": "https://docs.stripe.com/stripe-data/schedule-queries"
  }
}