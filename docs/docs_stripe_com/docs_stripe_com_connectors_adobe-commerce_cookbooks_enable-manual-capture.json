{
  "content": "# Enable manual capture\n\n## Allow separate authorization and capture for eligible Stripe payment methods.\n\nStripe supports manual capture for some payment method types. You can configure\nthis behavior in the application settings page by setting the `Payment Action`\nproperty of an eligible payment method to **Authorize Only**.\n\nTypically, enabling manual capture for a newly launched payment method that\nsupports it requires upgrading your Stripe module. This guide instructs you how\nto enable manual capture for eligible payment methods without upgrading the\nStripe module by updating the payment method helper file directly.\n\n## Create a new module\n\nCreate a new module with the following directory structure. Replace `Vendor`\nwith your preferred vendor name.\n\n```\napp/code/Vendor/StripeCustomizations/\n├── etc/\n│ ├── module.xml\n│ └── di.xml\n├── Plugin/\n│ └── Helper/\n│ └── PaymentMethodPlugin.php\n├── registration.php\n\n```\n\nInside `registration.php`, register your module with Magento.\n\n```\n<?php\n\\Magento\\Framework\\Component\\ComponentRegistrar::register(\n \\Magento\\Framework\\Component\\ComponentRegistrar::MODULE,\n 'Vendor_StripeCustomizations',\n __DIR__\n);\n```\n\nInside `etc/module.xml`, define the module and set up dependencies to make sure\nit loads after the Stripe module.\n\n```\n<?xml version=\"1.0\"?>\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:noNamespaceSchemaLocation=\"urn:magento:framework:Module/etc/module.xsd\">\n <module name=\"Vendor_StripeCustomizations\" setup_version=\"1.0.0\">\n <sequence>\n <module name=\"StripeIntegration_Payments\"/>\n </sequence>\n </module>\n</config>\n```\n\nInside `etc/di.xml`, define the following plugin:\n\n```\n<?xml version=\"1.0\"?>\n<config xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:noNamespaceSchemaLocation=\"urn:magento:framework:ObjectManager/etc/config.xsd\">\n <type name=\"StripeIntegration\\Payments\\Helper\\PaymentMethod\">\n <plugin\n name=\"vendor_stripecustomizations_helper_paymentmethod_plugin\"\n type=\"Vendor\\StripeCustomizations\\Plugin\\Helper\\PaymentMethodPlugin\"\n sortOrder=\"10\"\n disabled=\"false\" />\n </type>\n</config>\n```\n\nInside `Plugin/Helper/PaymentMethodPlugin.php`, create the an `afterMethod`\ninterceptor:\n\n```\n<?php\n\nnamespace Vendor\\Module\\Plugin;\n\nclass PaymentMethodPlugin\n{\n public function afterGetPaymentMethodsThatCanCaptureManually(\n \\StripeIntegration\\Payments\\Helper\\PaymentMethod $subject,\n $result\n ) {\n// Modify or extend the result to include another payment method code that\nsupports manual capture.\n $result[] = 'new_payment_method_code';\n\n return $result;\n }\n}\n```\n\nEnable the module:\n\n```\nphp bin/magento module:enable Vendor_StripeCustomizations\nphp bin/magento setup:upgrade\nphp bin/magento cache:clean\nphp bin/magento cache:flush\n\n```\n\n## Links\n\n-\n[http://www.w3.org/2001/XMLSchema-instance](http://www.w3.org/2001/XMLSchema-instance)",
  "metadata": {
    "title": "Enable manual capture | Stripe Documentation",
    "description": "Allow separate authorization and capture for eligible Stripe payment methods.",
    "sourceURL": "https://docs.stripe.com/connectors/adobe-commerce/cookbooks/enable-manual-capture"
  }
}