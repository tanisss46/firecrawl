{
  "content": "# Alipay payments with Sources\n\n## Use Sources to accept payments using Alipay, a popular payment method in China.\n\n#### Warning\n\nWe deprecated the Sources API and plan to remove support for local payment\nmethods. If you currently integrate with Alipay using the Sources API, you must\n[migrate to the Payment Methods\nAPI](https://docs.stripe.com/payments/payment-methods/transitioning).\n\nFor information about integrating Alipay with the current APIs, see [Alipay\npayments](https://docs.stripe.com/payments/alipay).\n\nStripe users can use [Sources](https://docs.stripe.com/sources) to accept\n[Alipay](https://alipay.com/) payments from customers from China.\n\nDuring the payment process, a [Source](https://docs.stripe.com/api#sources)\nobject is created and your customer is redirected to Alipay for authorization.\nAfter completing this, your integration uses the source to make a charge request\nand complete the payment.\n\nAlipay is a [push](https://docs.stripe.com/sources#pull-or-push-of-funds)-based,\n[single-use](https://docs.stripe.com/sources#single-use-or-reusable) and\n[synchronous](https://docs.stripe.com/sources#synchronous-or-asynchronous-confirmation)\nmethod of payment. This means that your customer takes action to authorize the\npush of funds through a\n[redirect](https://docs.stripe.com/sources#flow-for-customer-action). There is\nimmediate confirmation about the success or failure of a payment.\n\n[Create a Source object](https://docs.stripe.com/sources/alipay#create-source)\nA `Source` object is either created client-side using\n[Stripe.js](https://docs.stripe.com/payments/elements) or server-side using the\n[Source creation endpoint](https://docs.stripe.com/api#create_source), with the\nfollowing parameters:\n\nParameterValue`type`alipay`currency`cny or the default currency for your\ncountry. Accepted currencies are aud, cad, cny, eur, gbp, hkd, jpy, nzd, sgd, or\nusd. Users in Denmark, Norway, Sweden, or Switzerland must use\neur.`redirect[return_url]`The URL the customer should be redirected to after the\nauthorization process.`amount` A positive integer in the [smallest currency\nunit](https://docs.stripe.com/currencies#zero-decimal) representing the amount\nto charge the customer (for example, 1099 for a 10.99 USD payment).\nTo create a source with [Stripe.js](https://docs.stripe.com/payments/elements),\nfirst include the library within your website and set your [publishable API\nkey](https://dashboard.stripe.com/apikeys). Once included, use the following\n`createSource` method to create a source client-side:\n\n```\nstripe.createSource({\n type: 'alipay',\n amount: 1099,\n currency: 'usd',\n redirect: {\n return_url: '__TOKEN_PLACEHOLDER_0__',\n },\n}).then(function(result) {\n // handle result.error or result.source\n});\n```\n\nUsing either method, Stripe returns a `Source` object containing the relevant\ndetails for the method of payment used. Information specific to Alipay is\nprovided within the `alipay` subhash.\n\n```\n{\n \"id\": \"src_16xhynE8WzK49JbAs9M21jaR\",\n \"object\": \"source\",\n \"amount\": 1099,\n \"client_secret\": \"src_client_secret_UfwvW2WHpZ0s3QEn9g5x7waU\",\n \"created\": 1445277809,\n \"currency\": \"usd\",\n \"flow\": \"redirect\",\n \"livemode\": true,\n \"owner\": {\n```\n\nSee all 33 lines\n### Error codes\n\nSource creation for Alipay payments may return any of the following errors:\n\nErrorDescription`payment_method_not_available`The payment method is currently\nnot available. You should invite your customer to fallback to another payment\nmethod to proceed.`processing_error`An unexpected error occurred preventing us\nfrom creating the source. The source creation should be retried.[Have the\ncustomer complete\nauthorization](https://docs.stripe.com/sources/alipay#customer-action)\nWhen creating a source, its status is initially set to `pending` and cannot yet\nbe used to make a charge request. Your customer must authorize an Alipay payment\nto make the source chargeable. To allow your customer to authorize the payment,\nredirect them to the URL provided within the`redirect[url]` attribute of the\n`Source` object.\n\nAfter the authorization process, your customer is redirected back to the URL\nprovided as a value of `redirect[return_url]`. This happens regardless of\nwhether authorization was successful or not. If the customer has authorized the\npayment, the `Source` object’s status will transition to `chargeable` when it is\nready to be used in a charge request. If your customer declines the payment, the\nstatus will transition to `failed`.\n\nStripe populates the `redirect[return_url]` with the following GET parameters\nwhen returning your customer to your website:\n\n- `source`: a string representing the original ID of the `Source` object\n- `livemode`: indicates if this is a live payment, either `true` or `false`\n- `client_secret`: used to confirm that the returning customer is the same one\nwho triggered the creation of the source (source IDs are not considered secret)\n\nYou may include any other GET parameters you may need when specifying\n`redirect[return_url]`. Do not use the above as parameter names yourself as\nthese would be overridden with the values we populate.\n\n### Mobile applications\n\nTo integrate Alipay within a mobile application, provide your application URI\nscheme as the `redirect[return_url]` value. By doing so, your customers are\nreturned to your app after completing authorization. Direct redirects to the\nAlipay app are also supported when using our native SDKs.\n\nFor Android sources, the [Alipay\nSDK](https://doc.open.alipay.com/doc2/detail.htm?treeId=54&articleId=104509&docType=1)\nis required for app-to-app support.\n\n### Testing the redirect process\n\nWhen creating a `Source` object using your test API keys, you can follow the URL\nreturned in the `redirect[url]` field. This leads to a Stripe page that displays\ninformation about the API request, and where you can either authorize or cancel\nthe payment. Authorizing the payment redirects you to the URL specified in\n`redirect[return_url]`.\n\n[Charge the Source](https://docs.stripe.com/sources/alipay#charge-request)\nOnce the customer has authorized the payment, the source’s `status` transitions\nto `chargeable` and it can be used to make one charge request. This transition\nhappens asynchronously and may occur after the customer was redirected back to\nyour website.\n\nSome customers using Alipay assume that the order process is complete once they\nhave authorized the payment and received confirmation on Alipay’s site or app.\nThis results in customers who close their browser instead of following the\nredirect and returning to your app or website.\n\nFor these reasons it is essential that your integration rely on\n[webhooks](https://docs.stripe.com/webhooks) to determine when the source\nbecomes chargeable in order to create a charge. Please refer to our [best\npractices](https://docs.stripe.com/sources/best-practices) for more details on\nhow to best integrate payment methods using webhooks.\n\n### Webhooks\n\nThe following webhook events are sent to notify you about changes to the\nsource’s status:\n\nEventDescription`source.chargeable`A `Source` object becomes `chargeable` after\na customer has authorized and verified a payment.`source.failed`A `Source`\nobject failed to become chargeable as your customer declined to authorize the\npayment.`source.canceled`A `Source` object expired and cannot be used to create\na charge.\n### Make a charge request using the source\n\nOnce the source is chargeable, from your `source.chargeable` webhook handler,\nyou can make a charge request using the source ID as the value for the `source`\nparameter to complete the payment.\n\n```\ncurl https://api.stripe.com/v1/charges \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d amount=\"1099\" \\\n -d currency=\"eur\" \\\n -d source=src_18eYalAHEMiOZZp1l9ZTjSU0\n```\n\nBy default, your account’s [statement\ndescriptor](https://docs.stripe.com/get-started/account/statement-descriptors)\nappears on customer statements whenever you create an Alipay payment.\n\n### Error codes\n\nCharge creation for Alipay payments may return any of the following errors:\n\nErrorDescription`insufficient_funds`The Alipay account has insufficient funds to\ncomplete the purchase. The customer should fund their account and try again, or\nuse an alternative payment method.`invalid_amount`This occurs if the charge\namount is larger than what is supported by Alipay.[Confirm that the charge has\nsucceeded](https://docs.stripe.com/sources/alipay#charge-confirmation)\nSince the customer has already authorized the payment as part of the redirect,\nunless there is an unexpected error, the\n[Charge](https://docs.stripe.com/api#charge_object) will immediately succeed.\n\nYou will also receive the following webhook event as the charge is created:\n\nEventDescription`charge.succeeded`The charge succeeded and the payment is\ncomplete.\nWe recommend that you rely on the `charge.succeeded` webhook event to notify\nyour customer that the payment process has been completed and their order is\nconfirmed. Please refer to our [best\npractices](https://docs.stripe.com/sources/best-practices) for more details on\nhow to best integrate payment methods using webhooks.\n\n## Disputed payments\n\nIf a customer’s Alipay account is used illicitly, Alipay and Stripe handle the\nissue internally. Alipay payments are disputed only if the customer has a\ncomplaint about the provided goods or service. Should a dispute occur, a\n`charge.dispute.created` webhook event is sent to your webhook endpoint, and\nStripe deducts the amount of the dispute from your Stripe balance.\n\n## Refunds\n\nPayments made with Alipay can only be submitted for refund within 90 days from\nthe date of the original charge. After 90 days, it is no longer possible to\nrefund the charge.\n\n## Single-use Sources expiration\n\nA single-use Alipay source must be charged within six hours of becoming\n`chargeable`, or before 23:45 China Standard Time (GMT+8) due to Chinese\ngovernment restrictions around settlement. If it is not, its status is\nautomatically transitioned to `canceled` and your integration receives a\n`source.canceled` webhook event. Once a chargeable source is canceled, the\ncustomer’s authorized Alipay payment is refunded automatically—no money is moved\ninto your account. For this reason, make sure the order is canceled on your end\nand the customer is notified when you receive the `source.canceled` event.\n\nAdditionally, `pending` sources are canceled after one hour if they’re not used\nto authorize a payment, ensuring that all sources eventually transition out of\ntheir `pending` state to the `canceled` state if they’re not used.\n\n## Settlement currencies\n\nAlipay supports settlement in the default currency of your account. If you have\na bank account in another currency and would like to create Alipay sources in\nthat currency, please [get in touch](https://support.stripe.com/email). Support\nfor additional currencies is provided on a case-by-case basis.\n\n## See also\n\n- [Other supported payment methods](https://docs.stripe.com/sources)\n- [Sources API reference](https://docs.stripe.com/api#sources)\n- [Best practices](https://docs.stripe.com/sources/best-practices)\n\n## Links\n\n- [migrate to the Payment Methods\nAPI](https://docs.stripe.com/payments/payment-methods/transitioning)\n- [Alipay payments](https://docs.stripe.com/payments/alipay)\n- [Sources](https://docs.stripe.com/sources)\n- [Alipay](https://alipay.com/)\n- [Source](https://docs.stripe.com/api#sources)\n- [push](https://docs.stripe.com/sources#pull-or-push-of-funds)\n- [single-use](https://docs.stripe.com/sources#single-use-or-reusable)\n-\n[synchronous](https://docs.stripe.com/sources#synchronous-or-asynchronous-confirmation)\n- [redirect](https://docs.stripe.com/sources#flow-for-customer-action)\n- [Stripe.js](https://docs.stripe.com/payments/elements)\n- [Source creation endpoint](https://docs.stripe.com/api#create_source)\n- [smallest currency unit](https://docs.stripe.com/currencies#zero-decimal)\n- [publishable API key](https://dashboard.stripe.com/apikeys)\n- [Alipay\nSDK](https://doc.open.alipay.com/doc2/detail.htm?treeId=54&articleId=104509&docType=1)\n- [webhooks](https://docs.stripe.com/webhooks)\n- [best practices](https://docs.stripe.com/sources/best-practices)\n- [statement\ndescriptor](https://docs.stripe.com/get-started/account/statement-descriptors)\n- [Charge](https://docs.stripe.com/api#charge_object)\n- [get in touch](https://support.stripe.com/email)",
  "metadata": {
    "title": "Alipay payments with Sources | Stripe Documentation",
    "description": "Use Sources to accept payments using Alipay, a popular payment method in China.",
    "sourceURL": "https://docs.stripe.com/sources/alipay"
  }
}