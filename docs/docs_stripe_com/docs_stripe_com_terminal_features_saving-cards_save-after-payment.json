{
  "content": "# Save card details after payment\n\n## Take an in-person payment and save card details to use later, when the cardholder is not physically present.\n\nYou can use Stripe Terminal to save payment details from an in-store card\npurchase. A successful `card_present` payment returns a reusable `card`\nPaymentMethod in the `generated_card` attribute. There are several use cases:\n\n- A gym customer pays in person for an initial session and a membership\nsubscription. The transaction sets up a `generated_card` to use for future\nautomatic membership renewals.\n- A customer at a clothing store provides their email address when making a\npurchase at the checkout counter. The transaction creates a customer record and\nan associated saved `generated_card`. That allows the customer to log into the\nstore’s website later and place an order using the same card.\n\nThe initial, in-person payment benefits from liability shift and, in certain\nmarkets, [lower pricing](https://stripe.com/terminal#pricing) for standard\nTerminal payments. However, subsequent payments using the `generated_card` are\ncard-not-present online transactions, without the liability shift.\n\n#### Note\n\n[Digital wallet payments](https://docs.stripe.com/payments/wallets) such as\nApple Pay or Google Pay can’t be saved and don’t create a `generated_card`.\nHowever, for businesses in [certain\nverticals](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#saving-digital-wallets),\nStripe offers a limited private beta feature that allows you to save digital\nwallet payment methods. To request access, contact\n[stripe-terminal-betas@stripe.com](mailto:stripe-terminal-betas@stripe.com).\n\nServer-drivenJavaScriptiOSAndroidReact Native[Create a\ncustomer](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#create-customer)\nTo set a card up for future payments, you must attach it to a\n[Customer](https://docs.stripe.com/api/customers). Create a Customer object when\nyour customer creates an account with your business. Customer objects allow for\nreusing payment methods and tracking across multiple payments.\n\n```\ncurl https://api.stripe.com/v1/customers \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d name=\"Jenny Rosen\" \\\n --data-urlencode email=\"jennyrosen@example.com\"\n```\n\nSuccessful creation returns the\n[Customer](https://docs.stripe.com/api/customers/object) object. You can inspect\nthe object for the customer `id` and store the value in your database for later\nretrieval.\n\nYou can find these customers in the\n[Customers](https://dashboard.stripe.com/customers) page in the Dashboard.\n\n[Create a\nPaymentIntent](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#create-paymentintent)\nRequest a `generated_card` when you create a PaymentIntent by specifying a value\nfor\n[setup_future_usage](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-setup_future_usage).\nIf you intend to only reuse the payment method when the customer is present in\nthe checkout flow, use `on_session`. Otherwise, use `off_session`.\n\n```\ncurl https://api.stripe.com/v1/payment_intents \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d \"setup_future_usage\"=\"off_session\" \\\n -d \"customer\"=\"{{CUSTOMER_ID}}\" \\\n -d \"amount\"=1000 \\\n -d \"currency\"=\"usd\" \\\n -d \"payment_method_types[]\"=\"card_present\"\n```\n\n#### Note\n\nVisa, Mastercard, American Express, Discover, and co-branded eftpos cards are\nsupported as `card_present` payment methods that can be saved as type `card`.\n\n[Collect and process a payment\nmethod](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#collect-payment-method)\nWhen the customer is ready to pay and has [consented to their card details being\nsaved](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#compliance),\npass\n[allow_redisplay](https://docs.stripe.com/api/payment_methods/object#payment_method_object-allow_redisplay)\nas `always` or `limited` into the `process_payment_intent` or\n`collect_payment_method`Preview call. The value indicates the degree to which a\npayment method can be shown in a customer checkout flow.\n\n```\ncurl\nhttps://api.stripe.com/v1/terminal/readers/{{READER_ID}}/process_payment_intent\n\\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d payment_intent={{PAYMENT_INTENT_ID}} \\\n -d \"process_config[allow_redisplay]\"=always\n```\n\n```\ncurl\nhttps://api.stripe.com/v1/terminal/readers/{{READER_ID}}/collect_payment_method\n\\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d payment_intent={{PAYMENT_INTENT_ID}} \\\n -d \"collect_config[allow_redisplay]\"=always\n```\n\nIf you use the `collect_payment_method` flow, which allows access to useful data\nlike card brand and funding from the PaymentMethod before confirming it, you\nmust also separately confirm the PaymentIntent.\n\n```\ncurl\nhttps://api.stripe.com/v1/terminal/readers/{{READER_ID}}/confirm_payment_intent\n\\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d payment_intent={{PAYMENT_INTENT_ID}}\n```\n\n[Access the\ngenerated_card](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#access-generated-card)\nA successful payment with a card that supports future use returns a\nPaymentIntent in the `requires_capture` or `succeeded` state, with a\n[generated_card](https://docs.stripe.com/api/charges/object#charge_object-payment_method_details-card_present-generated_card)\nattribute containing the reusable PaymentMethod. If you passed the customer ID\ninto the PaymentIntent creation call, the reusable PaymentMethod is\nautomatically attached to the [Customer](https://docs.stripe.com/api/customers)\nobject. Otherwise, you can [manually attach\nit](https://docs.stripe.com/api/payment_methods/attach) in a separate call.\n\nAlways verify that the\n[PaymentIntent.latest_charge](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-latest_charge)\ncontains a `generated_card` value. Digital wallet payments might not create a\ngenerated card. If that happens, and you require a reusable payment method, you\nhave two options:\n\n- Prompt the cardholder to save a different card using the flow to [save a card\nwithout taking a\npayment](https://docs.stripe.com/terminal/features/saving-cards/save-cards-directly).\n- Refund the in-person payment, indicate that the transaction failed, and\ninstruct the cardholder to use a different card.\n\n## Compliance\n\nYou’re responsible for your compliance with all applicable laws, regulations,\nand network rules when saving a customer’s payment details. For example, the\nEuropean Data Protection Board has issued guidance regarding saving payment\ndetails. These requirements generally apply if you want to save your customer’s\npayment method for future use, such as presenting a customer’s payment method to\nthem in the checkout flow for a future purchase or charging them when they’re\nnot actively using your website or app.\n\nAdd terms to your website or app that state how you plan to save payment method\ndetails and allow customers to opt in. If you plan to charge the customer while\nthey’re offline, then at a minimum, make sure that your terms also cover the\nfollowing:\n\n- The customer’s agreement to your initiating a payment or a series of payments\non their behalf for specified transactions.\n- The anticipated timing and frequency of payments (for instance, whether\ncharges are for scheduled installment or subscription payments, or for\nunscheduled top-ups).\n- How the payment amount is determined.\n- Your cancellation policy, if you’re setting up the payment method for a\nsubscription service.\n\nMake sure you keep a record of your customer’s written agreement to these terms.\n\nWhen you save a payment method, it can only be used for the specific usage that\nyou included in your terms. If you want to charge customers when they’re offline\nand also save the customer’s payment method to present to them as a saved\npayment method for future purchases, you must explicitly collect consent from\nthe customer. One way to do so is with a “Save my payment method for future use”\ncheckbox.\n\n## Save digital wallets\n\nIf your MCC is in one of the following ranges, you might be eligible to\nparticipate in a limited beta for saving digital wallet payment methods. For\nmore details, contact\n[stripe-terminal-betas@stripe.com](mailto:stripe-terminal-betas@stripe.com).\n\n- Car Rental Agencies (3351 - 3500)\n- Lodging – Hotels, Motels, Resorts (3501 - 3999)\n- Steamship and Cruise Lines (4411)\n- Boat Rentals and Leasing (4457)\n- Lodging - Hotels, Motels, Resorts, Central Reservations Services (Not\nElsewhere Classified) (7011)\n- Trailer Parks and Campgrounds (7033)\n- Equipment, Tool, Furniture, and Appliance Rental and Leasing (7394)\n- Car Rental Agencies (Not Elsewhere Classified) (7512)\n- Truck and Utility Trailer Rentals (7513)\n- Motor Home and Recreational Vehicle Rentals (7519)\n\nWhen you save a digital wallet payment method, the `generated_card` has\n`allow_redisplay=limited`, because checkout flows are prohibited from presenting\nsaved digital wallets as a payment option. You can only charge saved digital\nwallet payment methods for\n[off_session](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-off_session)\npayments.\n\n## Links\n\n- [lower pricing](https://stripe.com/terminal#pricing)\n- [Digital wallet payments](https://docs.stripe.com/payments/wallets)\n- [certain\nverticals](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#saving-digital-wallets)\n- [Customer](https://docs.stripe.com/api/customers)\n- [Customer](https://docs.stripe.com/api/customers/object)\n- [Customers](https://dashboard.stripe.com/customers)\n- [Create a PaymentIntent](https://docs.stripe.com/api/payment_intents/create)\n-\n[setup_future_usage](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-setup_future_usage)\n-\n[process_payment_intent](https://docs.stripe.com/api/terminal/readers/process_payment_intent)\n-\n[collect_payment_method](https://docs.stripe.com/api/terminal/readers/collect_payment_method)\n- [consented to their card details being\nsaved](https://docs.stripe.com/terminal/features/saving-cards/save-after-payment#compliance)\n-\n[allow_redisplay](https://docs.stripe.com/api/payment_methods/object#payment_method_object-allow_redisplay)\n-\n[confirm_payment_intent](https://docs.stripe.com/api/terminal/readers/confirm_payment_intent)\n-\n[generated_card](https://docs.stripe.com/api/charges/object#charge_object-payment_method_details-card_present-generated_card)\n- [manually attach it](https://docs.stripe.com/api/payment_methods/attach)\n-\n[PaymentIntent.latest_charge](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-latest_charge)\n- [save a card without taking a\npayment](https://docs.stripe.com/terminal/features/saving-cards/save-cards-directly)\n-\n[off_session](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-off_session)",
  "metadata": {
    "title": "Save card details after payment | Stripe Documentation",
    "description": "Take an in-person payment and save card details to use later, when the cardholder is not physically present.",
    "sourceURL": "https://docs.stripe.com/terminal/features/saving-cards/save-after-payment"
  }
}