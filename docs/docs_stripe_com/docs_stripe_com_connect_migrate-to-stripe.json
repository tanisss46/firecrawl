{
  "content": "# Migrating accounts to Stripe\n\n## Start processing accounts on Stripe without disrupting payments.\n\nStripe enables you to migrate your existing connected accounts along with your\npayment and customer data. Doing so allows you to continue to [collect payments\nand pay out](https://docs.stripe.com/connect/collect-then-transfer-guide) or\n[enable other businesses to accept payments\ndirectly](https://docs.stripe.com/connect/enable-payment-acceptance-guide). To\nsuccessfully bring your existing platform business to Stripe, you need to:\n\n- Create a migration plan and timeline\n- Update your integration for connected accounts\n- Create and onboard accounts\n- Handle outstanding and ongoing requirements\n- Migrate payment and customer data to Stripe\n\n## Create a migration plan\n\nA successful migration to Stripe includes a migration plan, a timeline, and KYC\ninformation for connected accounts, as well as payment and customer data.\n\nConnected accounts must onboard to Stripe, which requires sending Stripe Know\nYour Customer (KYC) data for each account. Stripe’s requirements can require\ncollecting additional information from your accounts. Perform an analysis to\nunderstand what data has been collected with your previous provider and what\ndata Stripe requires. Stripe verifies KYC data before activating connected\naccounts. Monitor account verification status using the\n[account.updated](https://docs.stripe.com/api/events/types#event_types-account.updated)\nevent or the [Retrieve Account](https://docs.stripe.com/api/account/retrieve)\nAPI. Accounts that fail to verify require action before they’re activated.\n\nInclude a hard cutover date for payment data after onboarding accounts to\nStripe. Payment and customer data requires [a PAN\nimport](https://docs.stripe.com/get-started/data-migrations/pan-import) as part\nof the cutover. We recommend that you import accounts in batches.\n\n## Update your integration\n\nYour application can require changes as part of the integration updates to\nmigrate to Stripe. For example, consider any changes to your connected accounts’\nusage of your platform, such as pricing updates. Stripe recommends communicating\nany changes to your accounts ahead of time.\n\n### Stripe terms of service agreement\n\nYour connected accounts must accept the Stripe terms of service before they’re\nactivated.\n\nFor accounts where Stripe is responsible for collecting updated information when\nrequirements are due or change (including Standard and Express accounts), the\naccount accepts Stripe’s terms of service as part of the onboarding flow.\n\nIf your platform is responsible for [collecting updated\ninformation](https://docs.stripe.com/api/accounts/object#account_object-controller-requirement_collection)\nfrom a connected account (including Custom accounts) when requirements change,\nyou can [wrap Stripe’s terms of service in your own terms of\nservice](https://docs.stripe.com/connect/updating-service-agreements#adding-stripes-service-agreement-to-your-terms-of-service).\nWe recommend placing terms of service acceptance at the end of the onboarding\nflow, but you can also have it at the start if that makes more sense for your\nbusiness. When creating or updating connected accounts, record acceptance of the\n[updated Terms of Service\ninformation](https://docs.stripe.com/api/accounts/update#update_account-tos_acceptance)\nto send to Stripe, and communicate that to the accounts.\n\n### Onboard connected accounts to Stripe\n\nStripe offers different levels of onboarding support for your connected\naccounts. Build an onboarding flow for your connected accounts using any of the\nfollowing methods:\n\nMethodProsCons[Stripe-hosted\nonboarding](https://docs.stripe.com/connect/custom/onboarding#stripe-hosted-onboarding)-\nLowest effort integration\n- Stripe-branded with limited platform branding\n- Limited control over the flow logic\n- Connected accounts redirect to Stripe instead of completing the process\nwithout leaving your site\n[Embedded\nonboarding](https://docs.stripe.com/connect/custom/onboarding#embedded-onboarding)-\n[Highly\nthemeable](https://docs.stripe.com/connect/customize-connect-embedded-components)\n- Limited or no Stripe branding\n- Connected accounts remain in the flow of your site\n- Low effort integration\n- Limited control over the flow logic\n[API-based\nonboarding](https://docs.stripe.com/connect/custom/onboarding#api-based-onboarding)\n- Exercise full control over your own UI\n- Expensive and time-consuming to build\n- Continuing high maintenance, especially to keep in compliance with changing\nglobal requirements\n- Can’t resolve Stripe risk reviews\n\n## Create and onboard accounts\n\nThe following is an overview of the process:\n\n[Get requirements for\naccount](https://docs.stripe.com/connect/required-verification-information)\n\nCollect account data\n\n[Create\naccount](https://docs.stripe.com/connect/custom/onboarding#create-the-connected-account)\n\nIf `requirements.currently_due` isn’t empty\n\nDo you have the information?\n\nPresent a [dynamically generated\nUI](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\nto collect and validate fields\n\nUse a [Stripe\nUI](https://docs.stripe.com/connect/custom/onboarding#embedded-onboarding) to\ncollect and validate fields\n\n[Update the\naccount](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\nwith collected fields\n\nYes\n### Establish account requirements\n\nThe following factors affect the [onboarding\nrequirements](https://docs.stripe.com/connect/required-verification-information)\nfor your connected accounts:\n\n- The origin country of the connected accounts\n- The [service agreement\ntype](https://docs.stripe.com/connect/service-agreement-types) applicable to the\nconnected accounts\n- The [capabilities](https://docs.stripe.com/connect/account-capabilities)\nrequested for the connected accounts\n- The [business\ntype](https://docs.stripe.com/api/accounts/object#account_object-business_type)\n(for example, individual or company) and\n[company.structure](https://docs.stripe.com/api/accounts/object#account_object-company-structure)\n(for example, public corporation or private partnership)\n\nUse the interactive form to see how changing these factors affects the\nrequirements.\n\n### Requirements form\n\n### Create the connected account\n\nFor each account to be migrated to Stripe, create an associated Account.\n\nStandardExpressCustomController properties\nUse the [Create Account](https://docs.stripe.com/api/accounts/create) API to\ncreate a connected account with `controller` set to the desired account\npreferences. You can prefill any information, but at a minimum, you must specify\nthe `controller`. The country of the account defaults to the same country as\nyour platform, and the account confirms the selection during onboarding.\n\n#### Note\n\nThis example includes only some of the fields you can set when creating an\naccount. For a full list of the fields you can set, such as `address` and\n`website_url`, see the [Create Account API\nreference](https://docs.stripe.com/api/accounts/create).\n\n```\ncurl https://api.stripe.com/v1/accounts \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"controller[fees][payer]\"=account \\\n -d \"controller[losses][payments]\"=stripe \\\n -d \"controller[stripe_dashboard][type]\"=none \\\n -d \"controller[requirement_collection]\"=stripe \\\n -d country=US \\\n -d \"capabilities[card_payments][requested]\"=true \\\n -d \"capabilities[transfers][requested]\"=true\n```\n\nIf you’ve already collected information for your connected accounts, you can\nprefill that information on the `Account` object. You can prefill any account\ninformation, including personal and business information, external account\ninformation, and so on.\n\nConnect Onboarding doesn’t ask for the prefilled information. However, it does\nask the account holder to confirm the prefilled information before accepting the\n[Connect service\nagreement](https://docs.stripe.com/connect/service-agreement-types).\n\nWhen testing your integration, prefill account information using [test\ndata](https://docs.stripe.com/connect/testing).\n\nSuccessful creation returns the [account\nobject](https://docs.stripe.com/api/accounts/object). Inspect the object for the\nconnected account `id` and store the value in your database.\n\n```\n{\n ...\n \"id\": \"{{CONNECTED_ACCOUNT_ID}}\",\n ...\n}\n```\n\nAfter updating Stripe with all existing data, look for any outstanding\nrequirements. Any outstanding requirements are listed in the `currently_due`\narray. All `currently_due` requirements need to be collected from the account\nfor Stripe to verify the account and activate the account’s capabilities.\n\n```\n{\n ...\n \"requirements\": {\n \"alternatives\": [],\n \"current_deadline\": null,\n \"currently_due\": [\n \"business_profile.url\",\n \"external_account\",\n \"individual.first_name\",\n \"individual.last_name\",\n \"tos_acceptance.date\",\n \"tos_acceptance.ip\"\n ],\n \"disabled_reason\": \"requirements.past_due\",\n \"errors\": [],\n```\n\nSee all 36 lines\nAfter providing all existing data on an account, direct the account to a Stripe\nUI to set up Stripe credentials, confirm the information, and accept the Stripe\nterms of service.\n\n### Take new accounts through an onboarding flow\n\nIn addition to migrating existing accounts, build a flow for new accounts to\nonboard to Stripe. You can also use this onboarding flow to collect missing data\nfor accounts being migrated.\n\nReview [onboarding options](https://docs.stripe.com/connect/onboarding) to\ncreate your onboarding flow.\n\n## Handle outstanding and ongoing requirements\n\nWhen the connected account’s data is submitted, Stripe verifies it. This process\nmight take minutes or hours depending on the nature of the verification\nrequired. During this process, the capabilities you requested have [a pending\nstatus](https://docs.stripe.com/api/accounts/object#account_object-capabilities).\n\n### Review status\n\nYou can retrieve the status of your connected account’s capabilities by:\n\n- Inspecting the Account object’s\n[capabilities](https://docs.stripe.com/api/accounts/object#account_object-capabilities)\nhash for the relevant capability.\n- Requesting capabilities directly from the [Capabilities\nAPI](https://docs.stripe.com/api/capabilities/retrieve) and inspecting the\nstatus of the relevant capability.\n- Listening for `account.updated`\n[events](https://docs.stripe.com/api/events/types#event_types-account.updated)\nin your [webhook](https://docs.stripe.com/connect/webhooks) endpoint and\ninspecting the `capabilities` hash for the relevant capability.\n\nAfter verifications are complete, the capability becomes `active` and available\nto the connected account. Account verifications run continuously, and if a\nfuture verification fails, a capability can transition out of `active`. Listen\nfor `account.updated` events to detect changes to capability states.\n\nConfirm that your Connect integration is compliant and operational by checking\nthat the account’s `charges_enabled` and `payouts_enabled` are both true. You\ncan use the API or listen for `account.updated` events. For details on other\nrelevant fields, check the account’s\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)\nhash. You can’t confirm the integration based on a single value because statuses\ncan vary depending on the application and related policies.\n\n-\n[charges_enabled](https://docs.stripe.com/api/accounts/object#account_object-charges_enabled)\nconfirms that your full charge path including the charge and transfer works\ncorrectly and evaluates if either `card_payments` or `transfers` capabilities\nare active.\n-\n[payouts_enabled](https://docs.stripe.com/api/accounts/object#account_object-payouts_enabled)\nevaluates whether your connected account can pay out to an external account.\nDepending on your risk policies, you can allow your connected account to start\ntransacting without payouts enabled. You [must eventually enable\npayouts](https://docs.stripe.com/connect/manage-payout-schedule) to pay your\nconnected accounts.\n\nYou can use the following logic as a starting point for defining a summary\nstatus to display to your connected account.\n\n```\n# Set your secret key. Remember to switch to your live secret key in production.\n# See your keys here: https://dashboard.stripe.com/apikeys\nStripe.api_key = 'sk_test_BQokikJOvBiI2HlWgH4olfQ2'\n\ndef account_state(account)\n reqs = account.requirements\n\n if reqs.disabled_reason && reqs.disabled_reason.include?(\"rejected\")\n \"rejected\"\n elsif account.payouts_enabled && account.charges_enabled\n if reqs.pending_verification\n \"pending enablement\"\n elsif !reqs.disabled_reason && !reqs.currently_due\n if !reqs.eventually_due\n \"complete\"\n else\n \"enabled\"\n end\n else\n \"restricted\"\n end\n elsif !account.payouts_enabled && account.charges_enabled\n \"restricted (payouts disabled)\"\n elsif !account.charges_enabled && account.payouts_enabled\n \"restricted (charges disabled)\"\n elsif reqs.past_due\n \"restricted (past due)\"\n elsif reqs.pending_verification\n \"pending (disabled)\"\n else\n \"restricted\"\n end\nend\n\naccounts = Stripe::Account.list(limit: 10)\n\naccounts.each do |account|\n puts \"#{account.id} has state: #{account_state(account)}\"\nend\n```\n\n### Handle verification errors\n\nHandle verification failures differently depending on your onboarding flow.\n\n#### Note\n\nYou can’t use the API to respond to Stripe risk reviews. You can enable your\nconnected accounts to respond using embedded components, Stripe-hosted\nonboarding, or remediation links. You can also use the Dashboard to respond to\nrisk reviews on behalf of your connected accounts.\n\nAPIEmbeddedHosted\nListen to the\n[account.updated](https://docs.stripe.com/api/events/types#event_types-account.updated)\nevent. If the account contains any `currently_due` fields when the\n`current_deadline` arrives, the corresponding functionality is disabled and\nthose fields are added to `past_due`.\n\n[Create a\nform](https://docs.stripe.com/connect/migrate-to-stripe#create-forms-to-collect-information)\nwith clear instructions that the account can use to correct the information.\nNotify the account, then [submit the corrected\ninformation](https://docs.stripe.com/connect/migrate-to-stripe#update-the-connected-account)\nusing the Accounts API.\n\n[account.updated\nevent](https://docs.stripe.com/api/events/types#event_types-account.updated)\n\nIf `requirements.currently_due` contains fields\n\nDirect account to onboarding in time to finish before\n[current_deadline](https://docs.stripe.com/api/accounts/object#account_object-requirements-current_deadline)\n\nNo action required\n\nIf `requirements.past_due` contains fields\n\nAccount possibly disabled; direct it to onboarding\n\nPresent [dynamically generated\nUI](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\nto collect and validate fields\n\n[Update\naccount](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\nwith fields collected\n\nIf `requirements.currently_due` contains fields\n\nYesNo\nIf you plan to create custom flows to handle all your verification errors:\n\n- Review the details regarding all possible [verification errors and how to\nhandle them](https://docs.stripe.com/connect/handling-api-verification).\n- [Test verification\nstates](https://docs.stripe.com/connect/testing-verification).\n\n## Migrate payment and customer data to Stripe\n\nAfter your connected accounts are created on Stripe, [request a PAN data\nimport](https://docs.stripe.com/get-started/data-migrations/pan-import), which\nmigrates your payment and customer data for use on Stripe.\n\n## See also\n\n- [Choose your onboarding\nconfiguration](https://docs.stripe.com/connect/onboarding)\n- [Handling identity verification with the\nAPI](https://docs.stripe.com/connect/handling-api-verification)\n- [Testing account identity\nverification](https://docs.stripe.com/connect/testing-verification)\n\n## Links\n\n- [collect payments and pay\nout](https://docs.stripe.com/connect/collect-then-transfer-guide)\n- [enable other businesses to accept payments\ndirectly](https://docs.stripe.com/connect/enable-payment-acceptance-guide)\n-\n[account.updated](https://docs.stripe.com/api/events/types#event_types-account.updated)\n- [Retrieve Account](https://docs.stripe.com/api/account/retrieve)\n- [a PAN import](https://docs.stripe.com/get-started/data-migrations/pan-import)\n- [collecting updated\ninformation](https://docs.stripe.com/api/accounts/object#account_object-controller-requirement_collection)\n- [wrap Stripe’s terms of service in your own terms of\nservice](https://docs.stripe.com/connect/updating-service-agreements#adding-stripes-service-agreement-to-your-terms-of-service)\n- [updated Terms of Service\ninformation](https://docs.stripe.com/api/accounts/update#update_account-tos_acceptance)\n- [Stripe-hosted\nonboarding](https://docs.stripe.com/connect/custom/onboarding#stripe-hosted-onboarding)\n- [Embedded\nonboarding](https://docs.stripe.com/connect/custom/onboarding#embedded-onboarding)\n- [Highly\nthemeable](https://docs.stripe.com/connect/customize-connect-embedded-components)\n- [API-based\nonboarding](https://docs.stripe.com/connect/custom/onboarding#api-based-onboarding)\n- [Get requirements for\naccount](https://docs.stripe.com/connect/required-verification-information)\n- [Create\naccount](https://docs.stripe.com/connect/custom/onboarding#create-the-connected-account)\n- [dynamically generated\nUI](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\n- [Update the\naccount](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\n- [service agreement\ntype](https://docs.stripe.com/connect/service-agreement-types)\n- [capabilities](https://docs.stripe.com/connect/account-capabilities)\n- [business\ntype](https://docs.stripe.com/api/accounts/object#account_object-business_type)\n-\n[company.structure](https://docs.stripe.com/api/accounts/object#account_object-company-structure)\n- [Create Account](https://docs.stripe.com/api/accounts/create)\n- [test data](https://docs.stripe.com/connect/testing)\n- [account object](https://docs.stripe.com/api/accounts/object)\n- [onboarding options](https://docs.stripe.com/connect/onboarding)\n- [a pending\nstatus](https://docs.stripe.com/api/accounts/object#account_object-capabilities)\n- [Capabilities API](https://docs.stripe.com/api/capabilities/retrieve)\n- [webhook](https://docs.stripe.com/connect/webhooks)\n-\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)\n-\n[charges_enabled](https://docs.stripe.com/api/accounts/object#account_object-charges_enabled)\n-\n[payouts_enabled](https://docs.stripe.com/api/accounts/object#account_object-payouts_enabled)\n- [must eventually enable\npayouts](https://docs.stripe.com/connect/manage-payout-schedule)\n- [https://dashboard.stripe.com/apikeys](https://dashboard.stripe.com/apikeys)\n-\n[current_deadline](https://docs.stripe.com/api/accounts/object#account_object-requirements-current_deadline)\n- [verification errors and how to handle\nthem](https://docs.stripe.com/connect/handling-api-verification)\n- [Test verification\nstates](https://docs.stripe.com/connect/testing-verification)",
  "metadata": {
    "title": "Migrating accounts to Stripe | Stripe Documentation",
    "description": "Start processing accounts on Stripe without disrupting payments.",
    "sourceURL": "https://docs.stripe.com/connect/migrate-to-stripe"
  }
}