{
  "content": "# Working with connected accounts in Treasury\n\n## Request the Treasury capability and collect onboarding requirements for your connected accounts.\n\nTo use Stripe Treasury, your platform must have a Stripe\n[Connect](https://docs.stripe.com/connect) integration. Stripe Connect enables a\nplatform to provide connected accounts to sellers and service providers. For an\noverview of how connected accounts fit into the Stripe Treasury account\nstructure, see the [Stripe Treasury accounts\nstructure](https://docs.stripe.com/treasury/account-management/treasury-accounts-structure)\nguide.\n\nTreasury only supports connected accounts that don’t use a Stripe-hosted\ndashboard and where your platform is responsible for requirements collection and\nloss liability, including Custom connected accounts. Learn how to [create\nconnected\naccounts](https://docs.stripe.com/connect/design-an-integration?connect-onboarding-surface=api&connect-dashboard-type=none&connect-economic-model=buy-rate&connect-loss-liability-owner=platform&connect-charge-type=direct)\nthat work with Treasury.\n\n#### Private preview\n\nEnabling Treasury on non-custom connected accounts is a new feature. Email\n[treasury-support@stripe.com](mailto:treasury-support@stripe.com) to request\naccess.\n\nAs a platform with connected accounts, you’re responsible for maintaining a\nminimum API version, communicating terms of service updates to your connected\naccounts, handling information requests from them, and providing them with\nsupport. Because your platform is ultimately responsible for the losses your\nconnected accounts incur, you’re also responsible for vetting them for fraud. To\nlearn more, read the [Treasury fraud\nguide](https://docs.stripe.com/treasury/examples/fraud-guide).\n\nConnected accounts require specific capabilities enabled on the account to use\nfeatures of Treasury. Different features require different capabilities, which\nmight require additional information about your connected account owners. The\n`treasury` capability, for example, is a requirement on connected accounts for\nTreasury access. When you request `treasury` for an account, additional fields\nbecome required for that connected account before the account can use Treasury.\n\nBefore you create connected accounts in live mode for your Treasury integration,\nwe recommend you first create test connected accounts in [test\nmode](https://docs.stripe.com/test-mode). Test mode connected accounts can’t\nreceive or send real money and can’t be used in live mode, but are otherwise\nidentical in configuration and functionality.\n\n## Checking current connected account types\n\nIf your platform already has a Connect integration with connected accounts but\nare unsure of their type, you can use the Dashboard or API to retrieve this\ninformation.\n\nDashboardAPI request\nNavigate to the [Connected accounts\npage](https://dashboard.stripe.com/test/connect/accounts/overview) in the\nDashboard. We list your connected accounts in a table format.\n\n![Table of connected\naccounts](https://b.stripecdn.com/docs-statics-srv/assets/account-dashboard.f7c91e5c9e06a1ca68102ed2cbaaa8ce.png)\n\nConnected accounts\n\nTo find the account features, select an account in the table to open the\ndetailed view, then click **Profile** > **Account information**.\n\n![Account details section of the dashboard displaying one account of type\nCustom.](https://b.stripecdn.com/docs-statics-srv/assets/account-information.22a76ce6f2d50771ebd78a0f21020fb3.png)\n\nAccount information\n\n## Create a new connected account with the treasury capability\n\n#### Note\n\nThis guide demonstrates how to create a new connected account using the Stripe\nAPI for Treasury and isn’t exhaustive. For complete documentation on creating a\nconnected account, including through hosted onboarding, see the [Connect\nintegration\nguide](https://docs.stripe.com/connect/design-an-integration?connect-onboarding-surface=api&connect-dashboard-type=none&connect-economic-model=buy-rate&connect-loss-liability-owner=platform&connect-charge-type=direct).\n\nUse `POST /v1/accounts` to create a new connected account. Request the following\ncapabilities for the account, which are required to use Stripe Treasury:\n\n- `transfers` (required for all connected accounts)\n- `treasury`\n\n#### Note\n\nYou can update the account later to request these capabilities if you don’t do\nso when creating the account.\n\nIf you want to issue cards with Stripe Issuing to your connected account, you\nmust request the `card_issuing` capability, as well. See the [Working with\nStripe Issuing\ncards](https://docs.stripe.com/treasury/account-management/issuing-cards) guide\nfor more information.\n\nIf you want to use ACH to transfer funds to or from an external account, you\nmust also request the `us_bank_account_ach_payments` capability.\n\nWith all the previous options included, the request resembles the following:\n\n```\nconst account = await stripe.accounts.create({\n country: 'US',\n email: email,\n capabilities: {\n transfers: {requested: true},\n treasury: {requested: true},\n card_issuing: {requested: true},\n },\n controller: {\n dashboard: {type: \"none\"},\n losses: {payments: \"application\"},\n requirement_collection: \"application\",\n fees: {payer: \"application\"}\n },\n});\n```\n\nIf successful, the response you receive confirms the connected account and\nrequested `capabilities`.\n\n```\n{\n \"id\": \"acct_1234\",\n \"object\": \"account\",\n \"capabilities\": {\n\"card_issuing\": \"inactive\", // Should be requested only for Stripe Issuing\nusers.\n \"treasury\": \"inactive\",\n \"us_bank_account_ach_payments\": \"inactive\"\n },\n ...\n}\n```\n\nTo learn more about connected account capabilities, see the [Account\ncapabilities](https://docs.stripe.com/connect/account-capabilities) guide for\nConnect.\n\n## Update a connected account to include the treasury capability\n\nIf you already have a connected account with `card_payments` enabled, use `POST\n/v1/accounts/{{CONNECTED_ACCOUNT_ID}}` to update the account with the associated\nID with a request for the `treasury` capability. The following request updates a\nconnected account with a request for the `treasury` capability, and includes the\noptional capabilities of `card_issuing` and `us_bank_account_ach_payments`:\n\n```\ncurl https://api.stripe.com/v1/accounts/{{CONNECTED_ACCOUNT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"capabilities[treasury][requested]\"=true \\\n -d \"capabilities[card_issuing][requested]\"=true \\\n -d \"capabilities[us_bank_account_ach_payments][requested]\"=true\n```\n\nUse `POST /v1/accounts/{{CONNECTED_ACCOUNT_ID}}` to update connected account\ncapabilities for connected accounts that already have a `FinancialAccount`\nassigned. See [Working with financial\naccounts](https://docs.stripe.com/treasury/account-management/financial-accounts)\nor the [FinancialAccount\nobject](https://docs.stripe.com/api/treasury/financial_accounts/object) API\ndocumentation for more information.\n\n## Onboard the connected account\n\nAfter you create an account, you must onboard the seller or service provider to\nthe account for ownership. The\n[Account](https://docs.stripe.com/api/accounts/object#account_object-requirements-currently_due)\nobject that represents the connected account has a `requirements` hash that\ncontains `currently_due` [identity\nverification](https://docs.stripe.com/connect/handling-api-verification)\nrequirements. The seller or service provider on your platform must provide the\ndetails itemized in the `requirements` hash to enable charges and\n[payouts](https://docs.stripe.com/payouts) on their connected account and enable\nall requested features of their financial account.\n\nYou have two options for onboarding connected account owners to Treasury:\n[hosted\nonboarding](https://docs.stripe.com/treasury/account-management/connected-accounts#using-hosted-onboarding)\nand [custom\nonboarding](https://docs.stripe.com/treasury/account-management/connected-accounts#using-custom-onboarding).\nWe recommend hosted onboarding.\n\nIf you create an `Account` object in test mode and want to bypass onboarding\nrequirements to test functionality, use `POST\n/v1/accounts/{{CONNECTED_ACCOUNT_ID}}` to [provide test\nvalues](https://docs.stripe.com/connect/testing-verification) that fulfill all\nthe requirements. The following request uses a previously created connected\naccount to apply the required account details.\n\n```\ncurl https://api.stripe.com/v1/accounts/{{CONNECTED_ACCOUNT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"tos_acceptance[date]\"=1547923073 \\\n -d \"tos_acceptance[ip]\"=\"172.18.80.19\" \\\n -d \"settings[treasury][tos_acceptance][date]\"=1547923073 \\\n -d \"settings[treasury][tos_acceptance][ip]\"=\"172.18.80.19\" \\\n -d \"business_profile[mcc]\"=5045 \\\n --data-urlencode \"business_profile[url]\"=\"https://bestcookieco.com\" \\\n -d \"company[address][city]\"=Schenectady \\\n -d \"company[address][line1]\"=\"123 State St\" \\\n -d \"company[address][postal_code]\"=12345 \\\n -d \"company[address][state]\"=NY \\\n -d \"company[tax_id]\"=000000000 \\\n -d \"company[name]\"=\"The Best Cookie Co\" \\\n -d \"company[phone]\"=8888675309 \\\n -d \"individual[first_name]\"=Jenny \\\n -d \"individual[last_name]\"=Rosen\n```\n\n### Using hosted onboarding\n\nUse Connect Onboarding to efficiently collect required information. That\noffloads the verification complexity from your platform to Stripe and collects\nthe terms of the service agreement. Alternatively, you can write your own API\nrequests for initial integration, but must monitor for changes to compliance\nrequirements to keep your onboarding workflow current. Learn how to [create\nconnected\naccounts](https://docs.stripe.com/connect/design-an-integration?connect-onboarding-surface=api&connect-dashboard-type=none&connect-economic-model=buy-rate&connect-loss-liability-owner=platform&connect-charge-type=direct)\nthat work with Treasury.\n\nBefore you can use Connect Onboarding, you must provide the name, color, and\nicon of your brand in the **Branding** section of your [Connect settings\npage](https://dashboard.stripe.com/test/settings/connect). Doing so customizes\nthe visual appearance of the form that sellers and service providers interact\nwith when onboarding to your platform.\n\nTo take advantage of Connect Onboarding, use `POST /v1/account_links` to create\nan `AccountLink` to provide to the seller or service provider who’s going to\ntake ownership of the connected account:\n\n#### Warning\n\nFor security, don’t email, text, or otherwise send account link URLs directly to\nyour user. Instead, redirect the authenticated user to the account link URL from\nwithin your platform’s application.\n\n```\ncurl https://api.stripe.com/v1/account_links \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d account={{CONNECTED_ACCOUNT_ID}} \\\n --data-urlencode refresh_url=\"https://example.com/reauth\" \\\n --data-urlencode return_url=\"https://example.com/return\" \\\n -d type=account_onboarding\n```\n\nThe response you receive includes the URL to provide to your user.\n\n```\n{\n \"object\": \"account_link\",\n \"created\": 1612927106,\n \"expires_at\": 1612927406,\n \"url\": \"https://connect.stripe.com/setup/s/iCtLfmYb2tEU\"\n}\n```\n\n### Using custom onboarding\n\nIf you prefer to build custom onboarding for your users, use `POST\n/v1/accounts/{{CONNECTED_ACCOUNT_ID}}` and `POST\n/v1/accounts/{{CONNECTED_ACCOUNT_ID}}/persons/{{PERSON_ID}}` to update the\nrelevant `Account` and `Person` objects with the required information.\n\nYou must also confirm that the connected account owner has read and agreed to\nthe [Stripe Treasury\nAgreement](https://stripe.com/treasury-connect-account/legal). See [Handling\nverification with the\nAPI](https://docs.stripe.com/connect/handling-api-verification) for additional\ndetails on fulfilling onboarding requirements.\n\n```\ncurl https://api.stripe.com/v1/accounts/{{CONNECTED_ACCOUNT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"company[name]\"=Homebox \\\n -d \"company[address][line1]\"=\"123 Market St.\" \\\n -d \"company[address][city]\"=\"San Francisco\" \\\n -d \"company[address][state]\"=CA \\\n -d \"company[address][postal_code]\"=94107 \\\n -d \"company[address][country]\"=US\n```\n\n### Requirements\n\nThe fields in the following table are required for Treasury users.\n\nEntity typeAt onboardingIndividual, Sole proprietorshipEntity details:- Business\nnames (customer facing and legal)\n- Legal entity type\n- Business address\n- Business phone number\n- Product or service description\n- Industry or Merchant category code\n- Tax ID Number (SSN, ITIN, or EIN)\n- Treasury TOS acceptance\n- Stripe TOS acceptance\nOwner details:- Legal name\n- Date of birth\n- Email address\n- Residential address\n- Full SSN, or ID document scan for non-US persons or if SSN can’t be verified\n- Title\n- Phone number\nCompanies (LLCs, corporations, non-profits, partnerships, and so on)Entity\ndetails:- Business names (customer facing and legal)\n- Legal entity type\n- Business address\n- Business phone number\n- Product or service description\n- Industry or Merchant category code\n- Tax ID Number (EIN)\n- Treasury TOS acceptance\n- Stripe TOS acceptance\nOwner/representative details:- Legal name\n- Date of birth\n- Email address\n- Residential address\n- Phone number\n- Title\n- Percent ownership of company\n- Full SSN, or ID document scan for non-US persons or if SSN can’t be verified\n\n### Completion\n\nThe connected account onboarding process is complete when you receive an\n`account.updated` [webhook](https://docs.stripe.com/webhooks) confirming the\nfollowing fields on your connected account:\n\n```\n{\n \"object\": {\n \"object\": \"account\",\n \"id\": \"acct_1234\",\n \"capabilities\": {\n \"treasury\": \"active\",\n\"card_issuing\": \"active\", // Only appears if requesting the `card_issuing`\ncapability.\n\"us_bank_account_ach_payments\": \"active\", // Only appears if requesting the\n`us_bank_account_ach_payments` capability.\n },\n ...\n }\n}\n\n```\n\nAccount onboarding latency when your platform’s bank partner is Evolve Bank &\nTrust is less than 5 minutes.\n\n### Updates to requirements\n\nTo adapt to changes in financial regulations, Stripe must occasionally update\ninformation collection requirements for Treasury. The\n`requirements.eventually_due` array on the `Account` object captures the updated\ninformation required by these regulation changes. Learn more about the\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)\nhash.\n\n## Links\n\n- [Connect](https://docs.stripe.com/connect)\n- [Stripe Treasury accounts\nstructure](https://docs.stripe.com/treasury/account-management/treasury-accounts-structure)\n- [create connected\naccounts](https://docs.stripe.com/connect/design-an-integration?connect-onboarding-surface=api&connect-dashboard-type=none&connect-economic-model=buy-rate&connect-loss-liability-owner=platform&connect-charge-type=direct)\n- [Treasury fraud guide](https://docs.stripe.com/treasury/examples/fraud-guide)\n- [test mode](https://docs.stripe.com/test-mode)\n- [Connected accounts\npage](https://dashboard.stripe.com/test/connect/accounts/overview)\n- [Working with Stripe Issuing\ncards](https://docs.stripe.com/treasury/account-management/issuing-cards)\n- [Account capabilities](https://docs.stripe.com/connect/account-capabilities)\n- [Working with financial\naccounts](https://docs.stripe.com/treasury/account-management/financial-accounts)\n- [FinancialAccount\nobject](https://docs.stripe.com/api/treasury/financial_accounts/object)\n-\n[Account](https://docs.stripe.com/api/accounts/object#account_object-requirements-currently_due)\n- [identity\nverification](https://docs.stripe.com/connect/handling-api-verification)\n- [payouts](https://docs.stripe.com/payouts)\n- [hosted\nonboarding](https://docs.stripe.com/treasury/account-management/connected-accounts#using-hosted-onboarding)\n- [custom\nonboarding](https://docs.stripe.com/treasury/account-management/connected-accounts#using-custom-onboarding)\n- [provide test values](https://docs.stripe.com/connect/testing-verification)\n- [https://bestcookieco.com](https://bestcookieco.com)\n- [Connect settings page](https://dashboard.stripe.com/test/settings/connect)\n- [https://example.com/reauth](https://example.com/reauth)\n- [https://example.com/return](https://example.com/return)\n-\n[https://connect.stripe.com/setup/s/iCtLfmYb2tEU](https://connect.stripe.com/setup/s/iCtLfmYb2tEU)\n- [Stripe Treasury Agreement](https://stripe.com/treasury-connect-account/legal)\n- [webhook](https://docs.stripe.com/webhooks)\n-\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)",
  "metadata": {
    "title": "Working with connected accounts in Treasury | Stripe Documentation",
    "description": "Request the Treasury capability and collect onboarding requirements for your connected accounts.",
    "sourceURL": "https://docs.stripe.com/treasury/account-management/connected-accounts"
  }
}