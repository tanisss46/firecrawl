{
  "content": "# Reviewing uncaptured payments\n\n## Learn how to use reviews if your Stripe integration uses auth and capture.\n\nBy default, you [create Stripe\npayments](https://docs.stripe.com/payments/accept-a-payment) in one step, which\nrequires no further action on your part to send the funds to your bank account.\n\nHowever, Stripe also supports two-step payments, often called [auth and\ncapture](https://support.stripe.com/questions/does-stripe-support-authorize-and-capture).\nIf your integration uses this technique, keep in mind that **approving a review\nand capturing a payment are separate actions.**\n\n## Reviewing uncaptured payments in the Dashboard\n\nWhen Stripe places an uncaptured payment in review, the Dashboard displays a\n**Capture** button in addition to the set of buttons for closing the review by\napproving or refunding it. Also, because refunding uncaptured payments is often\ncalled “releasing” or\n“[reversing](https://docs.stripe.com/refunds#refund-requests),” uncaptured\npayments have a **Cancel** button instead of a **Refund** button.\n\n#### Note\n\nApproving the review doesn’t automatically capture the charge. You still need to\nclick **Capture**.\n\n!\n\n## Using the API to automatically capture approved payments\n\nThrough the API, you can set up your integration to:\n\n- Immediately capture payments *not* placed in `review`\n- Leave payments placed in `review` uncaptured\n- When the review is approved, capture the payment\n\n### Immediately capture payments not placed in review\n\nTo create an uncaptured payment, set the capture behavior accordingly in the API\nrequest. On success, check the payment intent’s\n[review](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-review)\nattribute. If the attribute is empty, capture the charge.\n\n```\n# Set your secret key. Remember to switch to your live secret key in production.\n# See your keys here: https://dashboard.stripe.com/apikeys\nStripe.api_key = 'sk_test_BQokikJOvBiI2HlWgH4olfQ2'\n\n# Get the credit card details submitted by the form\n# Create a PaymentIntent with manual capture\npayment_intent = Stripe::PaymentIntent.create({\n amount: 1000,\n currency: 'usd',\n payment_method: '{{PAYMENT_METHOD_ID}}',\n description: 'Example charge',\n confirm: true,\n capture_method: 'manual',\n})\n\n# Check if the payment is in review. If not, capture it.\nif !payment_intent.review\n payment_intent.capture\nend\n```\n\n### Capturing a payment after a review is approved\n\nBy design, the previous step left the payments in `review` uncaptured. In this\nstep, use [webhooks](https://docs.stripe.com/webhooks) to automate the process\nof capturing these payments upon approval.\n\nStart by [configuring your\nwebhooks](https://docs.stripe.com/webhooks#register-webhook) to listen for the\n`review.closed` event. The event data includes the [review\nobject](https://docs.stripe.com/api#review_object), and the object’s `reason`\nattribute indicates whether the review was approved, or if it was closed for\nsome other reason (for example, the payment was refunded).\n\n```\n// Review object included in review.closed event webhook.\n{\n \"id\": \"prv_08voh1589O8KAxCGPcIQpmkz\",\n \"object\": \"review\",\n \"payment_intent\": \"pi_1D0CsEITpIrAk4QYdrWDnbRS\",\n \"created\": 1474379631,\n \"livemode\": false,\n \"open\": false,\n \"reason\": \"approved\"\n}\n```\n\nIf `reason` is `approved`, capture the charge.\n\n```\n# Set your secret key. Remember to switch to your live secret key in production.\n# See your keys here: https://dashboard.stripe.com/apikeys\nStripe.api_key = 'sk_test_BQokikJOvBiI2HlWgH4olfQ2'\n\npost \"/my/webhook/url\" do\n event_json = JSON.parse(request.body.read)\n event = Stripe::Event.retrieve(event_json[\"id\"])\n\n if event.type == 'review.closed'\n review = event.object\n if review.reason == 'approved'\n pi = Stripe::PaymentIntent.retrieve(review.payment_intent)\n pi.capture\n end\n end\n\n status 200\nend\n```\n\nTo capture approved payments, the review process must be completed within 7\ndays. Otherwise, as with any other uncaptured payment, the authorization\nautomatically expires and you can no longer capture the payment.\n\n## Links\n\n- [create Stripe payments](https://docs.stripe.com/payments/accept-a-payment)\n- [auth and\ncapture](https://support.stripe.com/questions/does-stripe-support-authorize-and-capture)\n- [reversing](https://docs.stripe.com/refunds#refund-requests)\n-\n[review](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-review)\n- [https://dashboard.stripe.com/apikeys](https://dashboard.stripe.com/apikeys)\n- [webhooks](https://docs.stripe.com/webhooks)\n- [configuring your webhooks](https://docs.stripe.com/webhooks#register-webhook)\n- [review object](https://docs.stripe.com/api#review_object)",
  "metadata": {
    "title": "Reviewing uncaptured payments | Stripe Documentation",
    "description": "Learn how to use reviews if your Stripe integration uses auth and capture.",
    "sourceURL": "https://docs.stripe.com/radar/reviews/auth-and-capture"
  }
}