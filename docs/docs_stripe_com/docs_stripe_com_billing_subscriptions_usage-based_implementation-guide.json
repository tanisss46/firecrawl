{
  "content": "# Set up usage-based billing\n\n## Learn how to charge customers based on their usage of your product or service.\n\nUsage-based billing enables you to charge customers based on their usage of your\nproduct or service.\n\nThis guide demonstrates how to create a meter, set up pricing and billing, and\nsend meter events to record customer usage. You’ll learn core concepts of a\nusage-based billing model through a fictional GenAI company called Alpaca AI.\nAlpaca AI charges their customers 0.04 USD per hundred tokens, and bills them at\nthe end of the month in arrears.\n\nThe following diagram shows the core concepts of usage-based billing:\n\nCustomer action\n\nMeter event\n\nMeter\n\nMeter event summaries\n\nPrice\n\nInvoice\n\nSubscription\n\nCustomer\n\ngeneratesaggregatesrated with pricerate usage (price x\nquantity)generateshashasBilling meter concepts[Create a\nmeter](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#create-meter)\nMeters specify how to aggregate meter events over a billing period. Meter events\nrepresent the raw actions that customers take in your system. Meters attach to\nprices and form the basis of what’s billed.\n\nFor the Alpaca AI example, meter events are the number of tokens a customer uses\nin a query. The meter is the sum of tokens over a month.\n\nYou can use the Stripe Dashboard or API to [create a\nmeter](https://docs.stripe.com/billing/subscriptions/usage-based/recording-usage#configure-meter).\nIf you want to use the API with the Stripe CLI to create a meter, learn how to\n[get started with the Stripe CLI](https://docs.stripe.com/stripe-cli).\n\nDashboardAPI- On the [Meters](https://dashboard.stripe.com/test/meters) page,\nclick **Create meter**.\n- On the **Create meter** page, do the following:- For **Meter name**, enter the\nname of the meter to display and for organization purposes. For the Alpaca AI\nexample, enter `Alpaca AI tokens`.\n- For **Event name**, enter the name to display in meter events when reporting\nusage to Stripe. For the Alpaca AI example, enter `alpaca_ai_tokens`.\n- Select **Sum** from the **Aggregation method** dropdown to set the aggregation\nformula.\n- Click **Create meter**.\n[Create a pricing\nmodel](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#create-pricing-model)\nUse the Stripe Dashboard or API to create a [pricing\nmodel](https://docs.stripe.com/products-prices/pricing-models) that includes\nyour [Products](https://docs.stripe.com/api/products) and their pricing options.\n[Prices](https://docs.stripe.com/api/prices) define the unit cost, currency, and\nbilling cycle.\n\nFor the Alpaca AI example, you create a product with a metered price of 0.04 USD\nper hundred units, billed at a monthly interval. You use the meter that you\ncreated in the previous step.\n\nDashboardAPI- On the [Product\ncatalog](https://dashboard.stripe.com/products?active=true) page, click **Create\nproduct**.\n- On the **Add a product** page, do the following:- For **Name**, enter the name\nof your product. For the Alpaca AI example, enter `Alpaca AI`.\n- *(Optional)* For **Description**, add a description that appears at checkout\nin the [customer portal](https://docs.stripe.com/customer-management) and in\n[quotes](https://docs.stripe.com/quotes).\n- Select **Recurring**.\n- Under **Billing period**, select **More pricing options**.\n- On the **Add price** page, do the following:- Under **Choose your pricing\nmodel**, select **Usage-based** and **Per package**.\n- Under **Price**, set the **Amount** to `0.04 USD` per `1000` units.\n- Under **Meter**, select **Alpaca AI tokens** from the dropdown.\n- Under **Billing period**, select **Monthly**.\n- Click **Next**.\n- On the **Add a product** page, click **Add product**.\n[Create a\ncustomer](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#create-customer)\nNext, create a [customer](https://docs.stripe.com/api/customers).\n\nDashboardAPI- On the [Customers](https://dashboard.stripe.com/test/customers)\npage, click **Add customer**.\n- On the **Create customer** page, do the following:- For **Name**, enter the\nname of your customer. For the Alpaca AI example, enter `John Doe`.\n- *(Optional)* Add an email address and description for your customer.\n- Click **Add customer**.\n[Create a\nsubscription](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#create-subscription)\n[Subscriptions](https://docs.stripe.com/api/subscriptions) allow you to charge\nrecurring amounts by associating a customer with a specific price.\n\nUse the Stripe Dashboard or API to create a subscription that includes your\ncustomer, product, and usage-based price.\n\nFor the Alpaca AI example, you create a subscription for the Alpaca AI product,\nwith a metered price of 0.04 USD per unit, billed monthly to John Doe.\n\n#### Note\n\nYou can associate a single metered price with one or more subscriptions.\n\nDashboardAPI- On the\n[Subscriptions](https://dashboard.stripe.com/test/subscriptions) page, click\n**Create test subscription**.\n- On the **Create a test subscription** page, do the following:- Under\n**Customer**, select the name of your customer. For the Alpaca AI example,\nselect **John Doe**.\n- Under **Product**, select your price. For the Alpaca AI example, select the\nprice under **Alpaca AI**.\n- *(Optional)* Modify the subscription details and settings as needed.\n- Click **Create test subscription**.\n[Send a test meter\nevent](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#test-usage)\nUse [Meter Events](https://docs.stripe.com/api/billing/meter-event) to [record\ncustomer\nusage](https://docs.stripe.com/billing/subscriptions/usage-based/recording-usage#record-usage)\nfor your meter. At the end of the billing period, Stripe bills the reported\nusage.\n\nYou can test your usage-based billing by sending a meter event through the\nStripe Dashboard or API. When using the API, specify the customer ID and value\nfor the `payload`.\n\nAfter you send meter events, you can view usage details for your meter on the\n[Meters](https://dashboard.stripe.com/test/meters) page in the Dashboard.\n\nDashboardAPI- On the [Meters](https://dashboard.stripe.com/test/meters) page,\nselect the meter name. For the Alpaca AI example, select **Alpaca AI tokens**.\n- On the meter page, click **Add usage** > **Manually input usage**.\n- On the **Add usage** page, do the following:- Select your customer from the\n**Customer** dropdown.\n- For **Value**, enter a sample value. For the Alpaca AI example, enter `3000`.\n- Click **Submit**.\n[Retrieve an upcoming\ninvoice](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#retrieve-upcoming-invoice)\n[Retrieve an upcoming invoice](https://docs.stripe.com/api/invoices/upcoming) to\nsee a preview of a customer’s invoice that includes details such as the meter\nprice and usage quantity.\n\nDashboardAPI- On the\n[Subscriptions](https://dashboard.stripe.com/test/subscriptions) page, select a\nsubscription. For the Alpaca AI example, select the subscription for **John\nDoe**.\n- On the subscription details page, scroll down to the **Upcoming invoice**\nsection. The preview invoice shows the subscription amount to bill the customer\non the specified date.\n- Click **View full invoice** to see complete details for the upcoming invoice,\nincluding:\n\n- Customer\n- Billing method\n- Creation date\n- Connected subscription\n- Subscription details (usage quantity and meter price)\n- Amount due\n\nBecause Stripe processes meter events asynchronously, upcoming invoices might\nnot immediately reflect recently received meter events.\n[OptionalRetrieve usage for a custom time\nperiod](https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide#retrieve-usage)\n## Next steps\n\n- [Accept payments with Stripe\nCheckout](https://docs.stripe.com/payments/checkout)\n- [Set up alerts and\nthresholds](https://docs.stripe.com/billing/subscriptions/usage-based/alerts-and-thresholds)\n- [Set up billing\ncredits](https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits/implementation-guide)\n\n## Links\n\n- [create a\nmeter](https://docs.stripe.com/billing/subscriptions/usage-based/recording-usage#configure-meter)\n- [get started with the Stripe CLI](https://docs.stripe.com/stripe-cli)\n- [Meters](https://dashboard.stripe.com/test/meters)\n- [pricing model](https://docs.stripe.com/products-prices/pricing-models)\n- [Products](https://docs.stripe.com/api/products)\n- [Prices](https://docs.stripe.com/api/prices)\n- [Product catalog](https://dashboard.stripe.com/products?active=true)\n- [customer portal](https://docs.stripe.com/customer-management)\n- [quotes](https://docs.stripe.com/quotes)\n- [customer](https://docs.stripe.com/api/customers)\n- [Customers](https://dashboard.stripe.com/test/customers)\n- [Subscriptions](https://docs.stripe.com/api/subscriptions)\n- [Subscriptions](https://dashboard.stripe.com/test/subscriptions)\n- [Meter Events](https://docs.stripe.com/api/billing/meter-event)\n- [record customer\nusage](https://docs.stripe.com/billing/subscriptions/usage-based/recording-usage#record-usage)\n- [Retrieve an upcoming invoice](https://docs.stripe.com/api/invoices/upcoming)\n- [Accept payments with Stripe\nCheckout](https://docs.stripe.com/payments/checkout)\n- [Set up alerts and\nthresholds](https://docs.stripe.com/billing/subscriptions/usage-based/alerts-and-thresholds)\n- [Set up billing\ncredits](https://docs.stripe.com/billing/subscriptions/usage-based/billing-credits/implementation-guide)",
  "metadata": {
    "title": "Set up usage-based billing | Stripe Documentation",
    "description": "Learn how to charge customers based on their usage of your product or service.",
    "sourceURL": "https://docs.stripe.com/billing/subscriptions/usage-based/implementation-guide"
  }
}