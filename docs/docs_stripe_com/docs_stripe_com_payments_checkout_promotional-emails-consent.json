{
  "content": "# Collect consent for promotional emailsUS only\n\n## Learn how to collect permission from customers so that you can send them promotional emails.\n\nStripe-hosted pageEmbedded formEmbedded componentsPublic preview\nPromotional emails are often sent to inform customers of new products and to\nshare coupons and discounts. For example, you can use them to subscribe\ncustomers to company newsletters or [send cart abandonment\nemails](https://docs.stripe.com/payments/checkout/abandoned-carts).\n\n![Collect consent for promotional\nemails](https://b.stripecdn.com/docs-statics-srv/assets/promotional-consent-collection.444ead1668bd41537b9a07b2dbdc219a.png)\n\nCollect consent from customers to send them promotional emails\n\nTo protect consumers from unwanted spam, customers must agree to receiving\npromotional emails before you can contact them. Checkout helps you collect the\nnecessary consent, where applicable, to send promotional emails. Learn more\nabout [promotional email\nrequirements](https://docs.stripe.com/payments/checkout/compliant-promotional-emails).\n\n[Collect\nconsent](https://docs.stripe.com/payments/checkout/promotional-emails-consent#collect-consent)\nYou can collect promotional email consent with Stripe Checkout when you create\nthe session:\n\n```\ncurl https://api.stripe.com/v1/checkout/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"line_items[0][price]\"={{PRICE_ID}} \\\n -d \"line_items[0][quantity]\"=2 \\\n -d customer={{CUSTOMER_ID}} \\\n -d mode=payment \\\n --data-urlencode success_url=\"https://example.com/success\" \\\n --data-urlencode cancel_url=\"https://example.com/cancel\" \\\n -d \"consent_collection[promotions]\"=auto\n```\n\nWhen `consent_collection.promotions='auto'`, Checkout dynamically displays a\ncheckbox for collecting the customer’s consent to promotional content.\n\n#### Note\n\nWhen the checkbox is shown, the default state depends on the customer’s country\nand the country your business is based in. Data privacy laws vary by\njurisdiction, so Checkout disables or limits this feature when local regulations\nprohibit it.\n\n[Store consent and email\naddress](https://docs.stripe.com/payments/checkout/promotional-emails-consent#store-consent)\nThe Checkout Session’s\n[consent](https://docs.stripe.com/api/checkout/sessions/object#checkout_session_object-consent)\nattribute records whether or not the session collected promotional consent from\nthe customer.\n\nAs customers complete purchases, keep track of which customers consent to\npromotional content. You can create or update an existing\n[webhook](https://docs.stripe.com/webhooks) handler to do this. Listen to the\n`checkout.session.completed` event, check for the `consent.promotions` status,\nand then store email addresses for customers who give consent.\n\n```\n// Find your endpoint's secret in your Dashboard's webhook settings\nconst endpointSecret = 'whsec_...';\n\n// Using Express\nconst app = require('express')();\n\n// Use body-parser to retrieve the raw body as a buffer\nconst bodyParser = require('body-parser');\n\nconst recordPromotionalEmailConsent = (email, promoConsent) => {\n // TODO: fill me in\n console.log(\"Recording promotional email consent\", email, promoConsent);\n}\n\napp.post('/webhook', bodyParser.raw({type: 'application/json'}), (request,\nresponse) => {\n const payload = request.body;\n const sig = request.headers['stripe-signature'];\n\n let event;\n\n try {\n event = stripe.webhooks.constructEvent(payload, sig, endpointSecret);\n } catch (err) {\n return response.status(400).send(`Webhook Error: ${err.message}`);\n }\n\n // Handle the checkout.session.completed event\n if (event.type === 'checkout.session.completed') {\n const session = event.data.object;\n const promoConsent = session.consent?.promotions;\n const email = session.customer_details.email;\n\n// Record whether or not the customer has agreed to receive promotional emails\n recordPromotionalEmailConsent(email, promoConsent)\n\n // Handle order fulfillment\n }\n response.status(200).end();\n});\n```\n\nAfter you’ve configured Checkout to collect consent for sending customers\npromotional content, you can [recover abandoned\ncarts](https://docs.stripe.com/payments/checkout/abandoned-carts) by following\nup with leads for customers that left the checkout flow before completing\npayment.\n\n## Links\n\n- [send cart abandonment\nemails](https://docs.stripe.com/payments/checkout/abandoned-carts)\n- [promotional email\nrequirements](https://docs.stripe.com/payments/checkout/compliant-promotional-emails)\n- [https://example.com/success](https://example.com/success)\n- [https://example.com/cancel](https://example.com/cancel)\n-\n[consent](https://docs.stripe.com/api/checkout/sessions/object#checkout_session_object-consent)\n- [webhook](https://docs.stripe.com/webhooks)",
  "metadata": {
    "title": "Collect consent for promotional emails | Stripe Documentation",
    "description": "Learn how to collect permission from customers so that you can send them promotional emails.",
    "sourceURL": "https://docs.stripe.com/payments/checkout/promotional-emails-consent"
  }
}