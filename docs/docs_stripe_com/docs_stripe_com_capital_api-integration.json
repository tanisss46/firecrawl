{
  "content": "# Build a custom Capital programPrivate preview\n\n## Integrate with our API to build a custom Capital program.\n\n[Stripe\nCapital](https://docs.stripe.com/capital/how-capital-for-platforms-works)\nenables your platform to retrieve pre-qualified financing offers for your\nconnected accounts, expose a compliant loan application, and provide ongoing\nreporting for in-progress financing.\n\nThis guide outlines how platforms using\n[Connect](https://docs.stripe.com/connect) can integrate with the [Capital\nAPI](https://docs.stripe.com/api/capital/financing_offers).\n\n### Capital lifecycle\n\nTo launch the program, your platform must support the three phases of the\nCapital lifecycle:\n\n- Marketing financing offers to eligible users.\n- Providing access to the financing reporting page for in-progress financing.\n- Continuing to provide access to the financing reporting page after users have\nfully repaid their financing.\n\nThis guide explains how to:\n\n- Retrieve financing offers for eligible users.\n- Make the financing application available to users.\n- Provide users access to the financing reporting page.\n[Confirm your branding\nsettingsDashboard](https://docs.stripe.com/capital/api-integration#confirm-branding)\nAll users who receive Capital offers see your business name, icon, logo, and\nbranding color in the offer emails, application, and financing reporting page.\n\nNavigate to your **Connect branding settings**, and make sure your platform’s\nbranding settings are correct.\n\n![Capital offer application\npage](https://b.stripecdn.com/docs-statics-srv/assets/offer-page.66c647c99e2b25b314b7ca8be2cc98a4.png)\n\n[Create an undelivered financing offer in test\nmodeDashboard](https://docs.stripe.com/capital/api-integration#create-undelivered-offer)\nWe recommend using test mode tooling to build your integration. In test mode,\nvisit the [Capital\nDashboard](https://dashboard.stripe.com/test/connect/capital).\n\n- Click **Create** to open the **Create financing offer** modal, which allows\nyou to create financing offers in test mode. The default options create an\nundelivered financing offer with a 1,000 USD loan amount.\n- Leave the default options, and click **Create financing offer**.\n- From the Dashboard, click the row corresponding to the offer you created.\n\nThe loans and financing section of the connected account details page displays\ndetails about the user’s financing offer.\n\n[Retrieve financing\noffersServer-side](https://docs.stripe.com/capital/api-integration#retrieve-financing-offers)\nYou can retrieve financing offers for all of your platform’s users with the\n[List financing\noffers](https://docs.stripe.com/api/capital/financing_offers/list) endpoint.\n\n```\ncurl https://api.stripe.com/v1/capital/financing_offers \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2:\n```\n\nIf the offer is successfully created, you receive a response similar to the\nfollowing:\n\n```\n{\n \"object\": \"list\",\n \"url\": \"/v1/capital/financing_offers\",\n \"has_more\": false,\n \"data\": [\n {\n \"id\": \"financingoffer_abc123\",\n \"object\": \"capital.financing_offer\",\n ...,\n },\n {...}\n ]\n}\n```\n\nYou can look up a financing offer using the [Retrieve financing\noffer](https://docs.stripe.com/api/capital/financing_offers/retrieve#retrieve_financing_offer)\nendpoint. Retrieve the first financing offer from the list above.\n\n```\ncurl https://api.stripe.com/v1/capital/financing_offers/financingoffer_abc123 \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2:\n```\n\n[Send offer\nemailServer-side](https://docs.stripe.com/capital/api-integration#send-offer-email)\nStripe sends the `capital.financing_offer.created`\n[webhook](https://docs.stripe.com/webhooks) after a financing offer is created.\nUpdate your webhook integration to listen for the\n`capital.financing_offer.created` webhook. If you send your own offer emails,\nthe webhook is an important notification to notify the user of their offer.\n\n#### Warning\n\nMake sure the contents of your offer email comply with banking regulations by\nreviewing the [marketing guidance](https://docs.stripe.com/capital/marketing)\npage. Submit all changes to user-facing materials for review at\n[capital-review@stripe.com](mailto:capital-review@stripe.com).\n\nIn the email, link users to a dedicated Capital section in your platform\ndashboard. Users access the Capital financing application with [Account\nLinks](https://docs.stripe.com/api/account_links). Account Links expire shortly\nafter they’re generated, so provide a way for users to regenerate the\napplication link. Include a link to the financing application in your platform\ndashboard by generating an Account Link of type `capital_financing_offer`.\n\n```\ncurl https://api.stripe.com/v1/account_links \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d account=acct_123 \\\n# The URL the user will be redirected to if the account link is expired, has\nbeen previously-visited, or is otherwise invalid.\n -d refresh_url=\"https://example.com/reauth\" \\\n # The URL the user will be redirected to after completing the linked flow.\n -d return_url=\"https://example.com/thanks\" \\\n -d type=capital_financing_offer\n```\n\nIf the creation of an account link is successful, you receive a response similar\nto the following:\n\n```\n{\n \"object\": \"account_link\",\n \"created\": 1611264596,\n \"expires_at\": 1611264896,\n \"url\": \"https://connect.stripe.com/capital/offer/SrjgLUfa0O7K\"\n}\n```\n\nAfter updating your webhook integration, create another offer in the\n[Dashboard](https://dashboard.stripe.com/test/connect/capital), and verify you\nreceive the `capital.financing_offer.created` webhook.\n\n### Mark the offer as delivered\n\nUpdate your webhook integration to [mark the financing offer as\ndelivered](https://docs.stripe.com/api/capital/financing_offers/mark_delivered)\nafter sending the offer email. Marking an offer as delivered is required and is\nan affirmation that you have marketed the offer to the user.\n\n```\ncurl\nhttps://api.stripe.com/v1/capital/financing_offers/financingoffer_abc123/mark_delivered\n\\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2:\n```\n\nVerify the status of the financing offer is delivered using the\n[Dashboard](https://dashboard.stripe.com/test/connect/capital) or the [financing\noffer API](https://docs.stripe.com/api/capital/financing_offers/retrieve).\n\n[Listen for status\nchangesServer-side](https://docs.stripe.com/capital/api-integration#listen-status-changes)\nIn addition to the `capital.financing_offer.created` webhook, Stripe sends\nadditional webhooks as the financing offer transitions through different states.\nThe following is a full list of the webhooks you can receive:\n\nWebhook identifierTrigger`capital.financing_offer.created`Financing offer is\ncreated`capital.financing_offer.accepted`User submits their offer\napplication`capital.financing_offer.paid_out`Stripe approves the offer\napplication and funds are paid out to the\nuser`capital.financing_offer.fully_repaid`User fully repays the financing\nbalance`capital.financing_offer.canceled`User cancels the financing\noffer`capital.financing_offer.rejected`User’s application isn’t\napproved`capital.financing_offer.expired`Financing offer expires and is no\nlonger available`capital.financing_offer.replacement_created`Financing offer is\n[replaced](https://docs.stripe.com/capital/replacements) with a new financing\noffer\nFrom the [Dashboard](https://dashboard.stripe.com/test/connect/capital), find\nthe offer you delivered earlier.\n\n- Click the overflow menu ().\n- Click the **Expire offer** option, which lets you simulate expiring the offer.\n- Verify you receive the `capital.financing_offer.expired` webhook.\n\nWith the exception of `capital.financing_offer.canceled`, you can simulate all\nwebhooks using test mode tooling.\n\n[Apply for an\nofferDashboardServer-side](https://docs.stripe.com/capital/api-integration#apply-for-offer)\nYou can simulate the `capital.financing_offer.accepted` webhook by applying for\nan offer.\n\n- From the [Dashboard](https://dashboard.stripe.com/test/connect/capital),\ncreate a delivered offer with a maximum loan amount of 20,000 USD.\n- Generate an account link of type `capital_financing_offer`, and navigate to\nthe link. Here, you can preview what the application looks like for your users.\n- Continue to the end of the application, and click **Submit**.\n- Verify you received the `capital.financing_offer.accepted` webhook.\n- View the offer in the Dashboard, and check it has status accepted.\n\n### View the application tracker\n\nA financing offer with status accepted is pending application review by the\nStripe [servicing](https://docs.stripe.com/capital/servicing) team. While this\nreview takes place, you can direct the user to the financing reporting page. The\nfinancing reporting page contains an application tracker with an approximate\ntimeline of the application review.\n\nGenerate an [Account Link](https://docs.stripe.com/api/account_links) of type\n`capital_financing_reporting`.\n\n```\ncurl https://api.stripe.com/v1/account_links \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d account=acct_123 \\\n # When the user refreshes the page, where should we redirect them\n -d refresh_url=\"https://example.com/reauth\" \\\n # When the user completes the application, where should they return\n -d return_url=\"https://example.com/thanks\" \\\n -d type=capital_financing_reporting\n```\n\nNavigate to the link, and view the application tracker.\n\n[Approve the\napplicationDashboard](https://docs.stripe.com/capital/api-integration#approve-application)\nIn the [Dashboard](https://dashboard.stripe.com/test/connect/capital), find the\nrow corresponding to the accepted offer.\n\n- Click the overflow menu ().\n- Click the **Approve and disburse funds** option, which lets you simulate an\napplication approval and funds disbursal.\n- Verify you receive the `capital.financing_offer.paid_out` webhook, which\nnotifies you that the financing has been paid out.\n- Generate another [Account Link](https://docs.stripe.com/api/account_links) of\ntype `capital_financing_reporting`. The reporting page now provides access to\npayout and repayment transaction details for the user’s in-progress financing.\n- Click **Make payment**, and create a payment transaction.\n\n#### Note\n\nIt takes up to 15 minutes for the **Make payment** button to be enabled on the\nreporting page for test mode financing offers.\n\nAfter the transaction is processed, view the payment in the transactions table.\nYou can programmatically view the user’s paid-down financing amount for\nin-progress financing using the [financing summary\nAPI](https://docs.stripe.com/api/capital/financing_summary).\n\n```\ncurl https://api.stripe.com/v1/capital/financing_summary \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -H \"Stripe-Account: {{CONNECTED_ACCOUNT_ID}}\" \\\n```\n\nIf the retrieval of the financing summary is successful, you receive a response\nsimilar to the following:\n\n```\n{\n \"object\": \"capital.financing_summary\",\n \"details\": {\n \"currency\": \"usd\",\n \"advance_amount\": 1000000,\n \"fee_amount\": 100000,\n \"withhold_rate\": 0.2,\n \"remaining_amount\": 999950,\n \"paid_amount\": 50,\n \"current_repayment_interval\": {\n \"due_at\": 123456789,\n \"remaining_amount\": 50,\n \"paid_amount\": 50\n },\n \"repayments_begin_at\": 123456789,\n \"advance_paid_out_at\": 123456789\n }\n}\n```\n\n[Fully repay the\nfinancingDashboard](https://docs.stripe.com/capital/api-integration#fully-repay-financing)\nIn the [Dashboard](https://dashboard.stripe.com/test/connect/capital), find the\nrow corresponding to the paid-out financing.\n\n- Click the overflow menu ().\n- Click the **Repay offer** option, which lets you simulate fully paying down\nthe financing balance.\n- Verify you receive the `capital.financing_offer.fully_repaid` webhook, which\nnotifies you that the financing has been fully paid down.\n- Generate another [Account Link](https://docs.stripe.com/api/account_links) of\ntype `capital_financing_reporting`.\n\nAfter a user pays down their financing, they can access past financing details\non the reporting page at any time.\n\n[Review your test mode\nintegration](https://docs.stripe.com/capital/api-integration#review-test-mode-integration)\nBy now, your integration:\n\n- Responds to the `capital.financing_offer.created` webhook by sending an offer\nemail and marking the offer as delivered\n- Exposes the financing application link in your platform dashboard\n- Exposes the financing reporting link in your platform dashboard\n\nThe Capital section of your platform dashboard might appear differently\ndepending on which phase the user’s financing is in. Review the state diagram\nbelow for a list of possible financing offer status values.\n\nUndelivered\n\nDelivered\n\nAccepted\n\nPaid out\n\nFully repaid\n\nReplaced\n\nExpired\n\nRejected\n\nCanceled\n\nCapital financing offer state machine[Prepare to enable automatic\noffers](https://docs.stripe.com/capital/api-integration#prepare-enable-auto-offers)\nWhen automatic offers are enabled in live mode, Stripe automatically creates\nfinancing offers for your users on a daily basis. Before enabling automatic\noffers, make sure that you:\n\n- Confirm and update email addresses for your users through [Comms\nCenter](https://dashboard.stripe.com/connect/comms_center/collect). To be\neligible for Capital financing, users must have an email saved with Stripe so\nthat they can receive transactional emails such as payment progress updates.\n- [Contact us](mailto:capital-review@stripe.com) to enable live mode access to\nthe financing offers API.\n\n### Enable additional features\n\nOver time, some of your users might become eligible for refills. Refills are\nadditional financing offers sent to users who have made substantial repayment\nprogress towards their in-progress loans. Follow the [refills integration\nguide](https://docs.stripe.com/capital/refills) to update your integration to\nsupport refill financing offers.\n\nIf you want to include Capital transactions on your platform dashboard, see the\n[reporting and reconciliation\nguide](https://docs.stripe.com/capital/reporting-and-reconciliation).\n\n## Links\n\n- [Stripe\nCapital](https://docs.stripe.com/capital/how-capital-for-platforms-works)\n- [Connect](https://docs.stripe.com/connect)\n- [Capital API](https://docs.stripe.com/api/capital/financing_offers)\n- [Connect branding\nsettings](https://dashboard.stripe.com/settings/connect/stripe-dashboard/branding)\n- [Capital Dashboard](https://dashboard.stripe.com/test/connect/capital)\n- [List financing\noffers](https://docs.stripe.com/api/capital/financing_offers/list)\n- [Retrieve financing\noffer](https://docs.stripe.com/api/capital/financing_offers/retrieve#retrieve_financing_offer)\n- [webhook](https://docs.stripe.com/webhooks)\n- [marketing guidance](https://docs.stripe.com/capital/marketing)\n- [Account Links](https://docs.stripe.com/api/account_links)\n- [https://example.com/reauth](https://example.com/reauth)\n- [https://example.com/thanks](https://example.com/thanks)\n-\n[https://connect.stripe.com/capital/offer/SrjgLUfa0O7K](https://connect.stripe.com/capital/offer/SrjgLUfa0O7K)\n- [mark the financing offer as\ndelivered](https://docs.stripe.com/api/capital/financing_offers/mark_delivered)\n- [financing offer\nAPI](https://docs.stripe.com/api/capital/financing_offers/retrieve)\n- [replaced](https://docs.stripe.com/capital/replacements)\n- [servicing](https://docs.stripe.com/capital/servicing)\n- [financing summary API](https://docs.stripe.com/api/capital/financing_summary)\n- [Comms Center](https://dashboard.stripe.com/connect/comms_center/collect)\n- [refills integration guide](https://docs.stripe.com/capital/refills)\n- [reporting and reconciliation\nguide](https://docs.stripe.com/capital/reporting-and-reconciliation)",
  "metadata": {
    "title": "Build a custom Capital program | Stripe Documentation",
    "description": "Integrate with our API to build a custom Capital program.",
    "sourceURL": "https://docs.stripe.com/capital/api-integration"
  }
}