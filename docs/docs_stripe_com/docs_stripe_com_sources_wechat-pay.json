{
  "content": "# WeChat Pay payments with SourcesDeprecated\n\n## Use Sources to accept payments using WeChat Pay, a popular payment method in China.\n\n#### Warning\n\nWe deprecated the Sources API and plan to remove support for local payment\nmethods. If you currently integrate with WeChat Pay using the Sources API, you\nmust [migrate to the Payment Methods\nAPI](https://docs.stripe.com/payments/payment-methods/transitioning).\n\nFor information about integrating WeChat Pay with the current APIs, see [WeChat\nPay payments](https://docs.stripe.com/payments/wechat-pay).\n\nStripe users can use [Sources](https://docs.stripe.com/sources)—a single\nintegration path for creating payments using any supported method—to accept\n[WeChat Pay](https://pay.weixin.qq.com/index.php/public/wechatpay) payments from\ncustomers from China.\n\nDuring the payment process, a [Source](https://docs.stripe.com/api#sources)\nobject is created and you receive a WeChat Pay URL that is used to authorize the\npayment in the WeChat app by scanning a QR code. After completing this, your\nintegration uses the source to make a charge request and complete the payment.\n\nWeChat Pay is a\n[push](https://docs.stripe.com/sources#pull-or-push-of-funds)-based,\n[single-use](https://docs.stripe.com/sources#single-use-or-reusable) and\n[synchronous](https://docs.stripe.com/sources#synchronous-or-asynchronous-confirmation)\nmethod of payment. This means that once your customer takes action to authorize\nthe charge there is immediate confirmation about the success or failure of a\npayment.\n\n[Create a Source\nobject](https://docs.stripe.com/sources/wechat-pay#create-source)\nA `Source` object is either created client-side using\n[Stripe.js](https://docs.stripe.com/payments/elements) or server-side using the\n[Source creation endpoint](https://docs.stripe.com/api#create_source), with the\nfollowing parameters:\n\nParameterValue`type`wechat`amount`A positive integer in the [smallest currency\nunit](https://docs.stripe.com/currencies#zero-decimal) representing the amount\nto charge the customer (for example, 1099 for a 10.99 USD payment).`currency`The\ncurrency of the payment. Must be the default currency for your country. Can be\naud, cad, eur, gbp, hkd, jpy, sgd, or usd.`statement_descriptor` (optional)A\ncustom statement descriptor for the payment.\nTo create a source with [Stripe.js](https://docs.stripe.com/payments/elements),\nfirst include the library within your website and set your [publishable API\nkey](https://dashboard.stripe.com/apikeys). Once included, use the following\n`createSource` method to create a source client-side:\n\n```\nstripe.createSource({\n type: 'wechat',\n amount: 1099,\n currency: 'usd',\n}).then(function(result) {\n // handle result.error or result.source\n});\n```\n\nUsing either method, Stripe returns a `Source` object containing the relevant\ndetails for the method of payment used. Information specific to WeChat is\nprovided within the `wechat` subhash.\n\n```\n{\n \"id\": \"src_18eYalAHEMiOZZp1l9ZTjSU0\",\n \"object\": \"source\",\n \"amount\": 1099,\n \"client_secret\": \"src_client_secret_UfwvW2WHpZ0s3QEn9g5x7waU\",\n \"created\": 1445277809,\n \"currency\": \"usd\",\n \"flow\": \"none\",\n \"livemode\": true,\n \"metadata\": {},\n```\n\nSee all 27 lines\n### Optional: Provide a custom statement descriptor\n\nWeChat Pay can accept a [statement\ndescriptor](https://support.stripe.com/questions/when-i-charge-a-customer-what-will-they-see-on-their-card-statements)\nbefore the customer is redirected to authorize the payment. By default, your\nStripe account’s statement descriptor is used (you can review this in the\n[Dashboard](https://dashboard.stripe.com/settings/public)). You can provide a\ncustom descriptor by specifying `statement_descriptor` when creating a source.\nWeChat statement descriptors support a maximum of 32 characters.\n\n```\nstripe.createSource({\n type: 'wechat',\n amount: 1099,\n currency: 'usd',\n statement_descriptor: 'ORDER AT11990',\n owner: {\n name: 'Jenny Rosen',\n },\n}).then(function(result) {\n // handle result.error or result.source\n});\n```\n\nProviding a custom statement descriptor within a subsequent charge request has\nno effect.\n\n### Error codes\n\nSource creation for WeChat Pay payments may return any of the following errors:\n\nErrorDescription`payment_method_not_available`The payment method is currently\nnot available. You should invite your customer to fallback to another payment\nmethod to proceed.`processing_error`An unexpected error occurred preventing us\nfrom creating the source. The source creation should be retried.[Have the\ncustomer authorize the\npayment](https://docs.stripe.com/sources/wechat-pay#customer-action)\nWhen creating a source, its status is initially set to `pending` and cannot yet\nbe used to make a charge request. Your customer must authorize a WeChat Pay\npayment to make the source chargeable.\n\nTo do so, you will need to show the customer a QR code created from the URL\nprovided within `wechat[qr_code_url]`.\n\nAfter the authorization process, if the customer has authorized the payment, the\n`Source` object’s status will transition to `chargeable`; it is then ready to be\nused in a charge request. If your customer declines the payment, the status will\ntransition to `failed`.\n\nTo receive notifications of status changes on `Source` objects, your integration\nmust use [webhooks](https://docs.stripe.com/webhooks).\n\n### Testing\n\nFor sources created while testing, the `wechat[qr_code_url]` can be scanned\nusing any QR Code scanning application rather than WeChat. The URL leads to a\nStripe page that displays information about the API request, and where you can\neither authorize or cancel the payment.\n\n[Charge the Source](https://docs.stripe.com/sources/wechat-pay#charge-request)\nOnce the customer has authorized the payment, the source’s `status` transitions\nto `chargeable` and it can be used to make a charge request. This transition\nhappens asynchronously.\n\nSome customers using WeChat Pay will assume that the order process is complete\nonce they have authorized the payment and received confirmation on WeChat Pay’s\napp. It is essential that your integration rely on\n[webhooks](https://docs.stripe.com/webhooks) to determine when the source\nbecomes chargeable in order to create a charge. See our [best\npractices](https://docs.stripe.com/sources/best-practices) for more details on\nhow to best integrate payment methods using webhooks.\n\n### Webhooks\n\nThe following webhook events are sent to notify you about changes to the\nsource’s status:\n\nEventDescription`source.chargeable`A `Source` object becomes `chargeable` after\na customer has authorized and verified a payment.`source.failed`A `Source`\nobject failed to become chargeable as your customer declined to authorize the\npayment.`source.canceled`A `Source` object expired and cannot be used to create\na charge.\n### Make a charge request using the source\n\nOnce the source is chargeable, from your `source.chargeable` webhook handler,\nyou can make a charge request using the source ID as the value for the `source`\nparameter to complete the payment.\n\n```\ncurl https://api.stripe.com/v1/charges \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d amount=\"1099\" \\\n -d currency=\"usd\" \\\n -d source=src_18eYalAHEMiOZZp1l9ZTjSU0\n```\n\nWeChat Pay Sources are\n[single-use](https://docs.stripe.com/sources#single-use-or-reusable) and cannot\nbe used for recurring or additional payments. Learn more about using [Sources\nwith Customer objects](https://docs.stripe.com/sources/customers).\n\n[Confirm that the charge has\nsucceeded](https://docs.stripe.com/sources/wechat-pay#charge-confirmation)\nSince WeChat Pay is a\n[synchronous](https://docs.stripe.com/sources#synchronous-or-asynchronous-confirmation)\npayment method and the customer has already authorized the payment using the\nWeChat application, the [Charge](https://docs.stripe.com/api#charge_object) will\nimmediately succeed unless there’s an unexpected error.\n\nYou receive the following webhook event when the charge succeeds:\n\nEventDescription`charge.succeeded`The charge succeeded and the payment is\ncomplete.\nStripe recommends that you rely on the `charge.succeeded` webhook event to\nnotify your customer that the payment process has been completed and their order\nis confirmed. See [best\npractices](https://docs.stripe.com/sources/best-practices) for more details on\nintegrating payment methods using webhooks.\n\n### Disputed payments\n\nIf a customer’s WeChat Pay account is used illicitly, WeChat Pay and Stripe\nhandle the issue internally. In the context of WeChat Pay, payments are only\ndisputed if the customer has a complaint about the provided goods or service.\nShould a dispute occur, a `charge.dispute.created` webhook event is sent, and\nStripe deducts the amount of the dispute from your Stripe balance.\n\n### Refunds\n\nPayments made with WeChat Pay can only be submitted for refund within 180 days\nfrom the date of the original charge. After 180 days, it is no longer possible\nto refund the charge.\n\n### Sources expiration\n\nA WeChat Pay source must be charged within six hours of becoming `chargeable`,\nor before 23:45 China Standard Time (GMT+8) due to Chinese government\nrestrictions around settlement. If it is not, its status is automatically\ntransitioned to `canceled` and your integration receives a `source.canceled`\nwebhook event. Once a chargeable source is canceled, the customer’s authorized\nWeChat Pay payment is refunded automatically—no money is moved into your\naccount. For this reason, make sure the order is canceled on your end and the\ncustomer is notified when you receive the `source.canceled` event.\n\nAdditionally, `pending` sources are canceled after 1 hour if they aren’t used to\nauthorize a payment to make sure that all sources transition out of their\n`pending` state to the `canceled` state if they aren’t used.\n\n## See also\n\n- [Other supported payment methods](https://docs.stripe.com/sources)\n- [Sources API reference](https://docs.stripe.com/api#sources)\n- [Best practices](https://docs.stripe.com/sources/best-practices)\n\n## Links\n\n- [migrate to the Payment Methods\nAPI](https://docs.stripe.com/payments/payment-methods/transitioning)\n- [WeChat Pay payments](https://docs.stripe.com/payments/wechat-pay)\n- [Sources](https://docs.stripe.com/sources)\n- [WeChat Pay](https://pay.weixin.qq.com/index.php/public/wechatpay)\n- [Source](https://docs.stripe.com/api#sources)\n- [push](https://docs.stripe.com/sources#pull-or-push-of-funds)\n- [single-use](https://docs.stripe.com/sources#single-use-or-reusable)\n-\n[synchronous](https://docs.stripe.com/sources#synchronous-or-asynchronous-confirmation)\n- [Stripe.js](https://docs.stripe.com/payments/elements)\n- [Source creation endpoint](https://docs.stripe.com/api#create_source)\n- [smallest currency unit](https://docs.stripe.com/currencies#zero-decimal)\n- [publishable API key](https://dashboard.stripe.com/apikeys)\n- [statement\ndescriptor](https://support.stripe.com/questions/when-i-charge-a-customer-what-will-they-see-on-their-card-statements)\n- [Dashboard](https://dashboard.stripe.com/settings/public)\n- [webhooks](https://docs.stripe.com/webhooks)\n- [best practices](https://docs.stripe.com/sources/best-practices)\n- [Sources with Customer objects](https://docs.stripe.com/sources/customers)\n- [Charge](https://docs.stripe.com/api#charge_object)",
  "metadata": {
    "title": "WeChat Pay payments with Sources | Stripe Documentation",
    "description": "Use Sources to accept payments using WeChat Pay, a popular payment method in China.",
    "sourceURL": "https://docs.stripe.com/sources/wechat-pay"
  }
}