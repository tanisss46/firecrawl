{
  "content": "# Migrating from the Charges API\n\n## Upgrade to the Payment Intents API.\n\nIf you previously collected customer payment details with Stripe using the [Bank\nAccounts API](https://docs.stripe.com/ach-deprecated), you can continue using\nthe saved `BankAccount` as a\n[PaymentMethod](https://docs.stripe.com/api/payment_methods). You can use\ncustomer [bank accounts](https://docs.stripe.com/api/customer_bank_accounts)\nwith the [Payment Intents API](https://docs.stripe.com/api/payment_intents)\nafter you meet the following requirements:\n\n- The customer’s bank account has been verified.\n- An [active\nmandate](https://docs.stripe.com/payments/ach-direct-debit/migrating-from-charges#mandate-acknowledgement)\nexists for that bank account.\n\n## Compatibility with the Bank Accounts API\n\n### Create a PaymentIntent with a Bank Account\n\n[Bank Accounts](https://docs.stripe.com/api/customer_bank_accounts) that are\nalready [verified](https://docs.stripe.com/ach-deprecated#verifying) and have\nbeen attached to a [Customer](https://docs.stripe.com/api/customers) are usable\nin any API that accepts a `PaymentMethod` object. You can use a saved\n`BankAccount` as a [PaymentMethod](https://docs.stripe.com/api/payment_methods)\nwhen creating a PaymentIntent. This eliminates the need to recollect payment\ndetails. However, make sure that you also [update your\nintegration](https://docs.stripe.com/payments/ach-direct-debit/accept-a-payment)\nto begin creating PaymentMethods instead.\n\n```\ncurl https://api.stripe.com/v1/payment_intents \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d \"amount\"=1099 \\\n -d \"currency\"=\"usd\" \\\n -d \"customer\"=\"{{CUSTOMER_ID}}\" \\\n -d \"payment_method_types[]\"=\"us_bank_account\" \\\n -d \"payment_method\"=\"{{BANK_ACCOUNT_ID}}\"\n```\n\nSimilarly, you can use a saved BankAccount as a PaymentMethod when creating a\nSetupIntent.\n\n```\ncurl https://api.stripe.com/v1/setup_intents \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d \"payment_method_types[]\"=\"us_bank_account\" \\\n -d \"customer\"=\"{{CUSTOMER_ID}}\" \\\n -d \"payment_method\"=\"{{BANK_ACCOUNT_ID}}\"\n```\n\n### Collect mandate acknowledgement\n\nConfirming a PaymentIntent or SetupIntent requires having your customer\nauthorize a\n[mandate](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-mandate_data)\nto debit the account. Learn more about [SEC\ncodes](https://docs.stripe.com/payments/ach-direct-debit/sec-codes) to\nunderstand which authorization type is right for your business.\n\nIn some cases, you might have pre-authorization from your customer from an\nearlier purchase or SetupIntent that you can use to create an off-session\npayment. For example:\n\n- If you previously collected an online mandate from the customer, you can use\nboth the IP address and user agent information to create a mandate object.\n- If you previously collected payment and mandate information offline on paper,\nyou can create a [PPD\nmandate](https://docs.stripe.com/payments/ach-direct-debit/sec-codes#ppd-sec-code).\n\nTo create an off-session payment, you can use offline mandate acceptance to\nprovide a record of your customer’s original authorization.\n\nAuthorization is only required the first time you use a `BankAccount` object\nwith the PaymentIntents API. After that, you can use the `BankAccount` object as\na PaymentMethod to [accept future\npayments](https://docs.stripe.com/payments/ach-direct-debit/set-up-payment#web-future-payments).\n\n```\ncurl https://api.stripe.com/v1/payment_intents/{{PAYMENT_INTENT_ID}}/confirm \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d \"mandate_data[customer_acceptance][type]\"=\"offline\" \\\n-d \"mandate_data[customer_acceptance][accepted_at]\"=\"{{ACCEPTANCE_TIMESTAMP}}\" \\\n-d\n\"payment_method_options[us_bank_account][mandate_data][collection_method]\"=\"paper\"\n```\n\n### Retrieving a BankAccount as a PaymentMethod\n\nYou can retrieve saved BankAccounts through the [Payment Methods\nAPI](https://docs.stripe.com/api/payment_methods).\n\n```\ncurl https://api.stripe.com/v1/payment_methods/ba_1IsleZ2eZvKYlo2CI3To1g72 \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2:\n```\n\nWhen using a BankAccount as a PaymentMethod, no new objects are created. The\nPayment Methods API simply provides a different view of the same underlying\nobject.\n\nPaymentMethod ViewBankAccount View\n```\n{\n \"id\": \"ba_1IsleZ2eZvKYlo2CI3To1g72\",\n \"object\": \"payment_method\",\n \"billing_details\": {\n \"address\": {\n \"city\": null,\n \"country\": null,\n \"line1\": null,\n \"line2\": null,\n \"postal_code\": null,\n \"state\": null\n },\n \"email\": null,\n \"name\": \"Jenny Rosen\",\n \"phone\": null\n },\n \"us_bank_account\": {\n \"last4\": \"6789\",\n \"routing_number\": \"110000000\",\n \"fingerprint\": \"1JWtPxqbdX5Gamtc\",\n \"account_holder_type\": \"individual\",\n \"bank_name\": \"STRIPE TEST BANK\",\n },\n \"created\": 123456789,\n \"customer\": \"cus_CY5bH92D99f4mn\",\n \"livemode\": false,\n \"metadata\": {},\n \"type\": \"us_bank_account\"\n}\n```\n\n## Links\n\n- [Bank Accounts API](https://docs.stripe.com/ach-deprecated)\n- [PaymentMethod](https://docs.stripe.com/api/payment_methods)\n- [bank accounts](https://docs.stripe.com/api/customer_bank_accounts)\n- [Payment Intents API](https://docs.stripe.com/api/payment_intents)\n- [verified](https://docs.stripe.com/ach-deprecated#verifying)\n- [Customer](https://docs.stripe.com/api/customers)\n- [update your\nintegration](https://docs.stripe.com/payments/ach-direct-debit/accept-a-payment)\n-\n[mandate](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-mandate_data)\n- [SEC codes](https://docs.stripe.com/payments/ach-direct-debit/sec-codes)\n- [PPD\nmandate](https://docs.stripe.com/payments/ach-direct-debit/sec-codes#ppd-sec-code)\n- [accept future\npayments](https://docs.stripe.com/payments/ach-direct-debit/set-up-payment#web-future-payments)",
  "metadata": {
    "title": "Migrating from the Charges API | Stripe Documentation",
    "description": "Upgrade to the Payment Intents API.",
    "sourceURL": "https://docs.stripe.com/payments/ach-direct-debit/migrating-from-charges"
  }
}