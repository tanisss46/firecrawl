{
  "content": "# Save bank details during a Sofort payment\n\n## Learn how to save your customer's IBAN bank details from a Sofort payment.\n\n#### Warning\n\nNew businesses can’t accept SOFORT payments and our financial partners are in\nthe process of discontinuing SOFORT. For more information, read our [support\npage](https://support.stripe.com/questions/sofort-is-being-deprecated-as-a-standalone-payment-method).\n\n#### Caution\n\nWe recommend that you follow the [Save payment details during\npayment](https://docs.stripe.com/payments/save-during-payment) guide. If you’ve\nalready integrated with Elements, see the [Payment Element migration\nguide](https://docs.stripe.com/payments/payment-element/migration).\n\nSofort is a [single\nuse](https://docs.stripe.com/payments/payment-methods#usage), [delayed\nnotification](https://docs.stripe.com/payments/payment-methods#payment-notification)\npayment method that requires customers to\n[authenticate](https://docs.stripe.com/payments/payment-methods#customer-actions)\ntheir payment. [Customers](https://docs.stripe.com/api/customers) pay with\nSofort by redirecting from your website to their bank’s portal to authenticate\nthe payment. It typically takes 2 to 14 days to receive notification of success\nor failure.\n\nYou can use Sofort to save your customer’s\n[IBAN](https://en.wikipedia.org/wiki/International_Bank_Account_Number) bank\ndetails into a [SEPA Direct Debit](https://docs.stripe.com/payments/sepa-debit)\n[PaymentMethod](https://docs.stripe.com/api/payment_methods). You can then use\nthe SEPA Direct Debit PaymentMethod to [accept\npayments](https://docs.stripe.com/payments/sepa-debit/accept-a-payment) or [set\nup a subscription](https://docs.stripe.com/billing/subscriptions/sepa-debit).\nThis reduces friction for your customer as they don’t have to enter their IBAN\nagain. You also receive their verified name and validated IBAN.\n\n#### Caution\n\nTo use Sofort to set up SEPA Direct Debit payments, you must activate SEPA\nDirect Debit in the\n[Dashboard](https://dashboard.stripe.com/account/payments/settings). You must\nalso comply with the [Sofort Terms of Service](https://stripe.com/sofort/legal)\nand [SEPA Direct Debit Terms of\nService](https://stripe.com/sepa-direct-debit/legal).\n\nWebiOSAndroidReact Native\nAccepting Sofort payments consists of creating a\n[PaymentIntent](https://docs.stripe.com/api/payment_intents) object to track a\npayment, collecting payment method information and mandate acknowledgement, and\nsubmitting the payment to Stripe for processing. Stripe uses the PaymentIntent\nto track and handle all the states of the payment until the payment completes.\nUse the ID of the SEPA Direct Debit\n[PaymentMethod](https://docs.stripe.com/api/payment_methods) collected from your\ninitial Sofort PaymentIntent to create PaymentIntents for future payments.\n\n[Set up\nStripeServer-side](https://docs.stripe.com/payments/sofort/save-during-payment#set-up-stripe)\nFirst, you need a Stripe account. [Register\nnow](https://dashboard.stripe.com/register).\n\nUse our official libraries for access to the Stripe API from your application:\n\n```\n# Available as a gem\nsudo gem install stripe\n```\n\n```\n# If you use bundler, you can add this line to your Gemfile\ngem 'stripe'\n```\n\n[Create a\nCustomerServer-side](https://docs.stripe.com/payments/sofort/save-during-payment#create-customer)\nCreate a [Customer](https://docs.stripe.com/api/customers) when they create an\naccount with your business and associate it with your internal representation of\ntheir account. This enables you to retrieve and use their saved payment method\ndetails later.\n\n```\ncurl -X POST https://api.stripe.com/v1/customers \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\"\n```\n\n[Create a\nPaymentIntentServer-side](https://docs.stripe.com/payments/sofort/save-during-payment#create-payment-intent)\nCreate a `PaymentIntent` on your server and specify the `amount` to collect, the\n`eur` currency, the customer ID, and off_session as an argument for [setup\nfuture\nusage](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-setup_future_usage).\nIf you have an existing [Payment\nIntents](https://docs.stripe.com/payments/payment-intents) integration, add\n`sofort` to the list of [payment method\ntypes](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-payment_method_types).\n\n```\ncurl https://api.stripe.com/v1/payment_intents \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d amount=1099 \\\n -d currency=eur \\\n -d \"payment_method_types[]\"=sofort \\\n -d customer={{CUSTOMER_ID}} \\\n -d setup_future_usage=off_session\n```\n\nThe PaymentIntent includes the payment method ID and a [client\nsecret](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-client_secret),\nwhich is used on the client side to securely complete the payment process\ninstead of passing the entire PaymentIntent object.\n\n[Collect payment method details and mandate\nacknowledgementClient-side](https://docs.stripe.com/payments/sofort/save-during-payment#collect-payment-method-details)\nCreate a payment form on your client to collect the required billing details\nfrom the customer.\n\nHTML + JSReact\n​​To process SEPA Direct Debit payments, you must collect a mandate agreement\nfrom your customer. Display the following standard authorization text for your\ncustomer to implicitly sign the mandate.\n\nReplace *Rocket Rides* with your company name.\n\ndeenesfifritnlAuthorization text template\nBy providing your payment information and confirming this payment, you authorise\n(A) and Stripe, our payment service provider, to send instructions to your bank\nto debit your account and (B) your bank to debit your account in accordance with\nthose instructions. As part of your rights, you are entitled to a refund from\nyour bank under the terms and conditions of your agreement with your bank. A\nrefund must be claimed within 8 weeks starting from the date on which your\naccount was debited. Your rights are explained in a statement that you can\nobtain from your bank. You agree to receive notifications for future debits up\nto 2 days before they occur.\n\n​​Setting up a payment method or confirming a PaymentIntent creates the accepted\nmandate. As the customer has implicitly signed the mandate, you must communicate\nthese terms in your form or through email.\n\nFieldValue`name`The full name (first and last) of the customer.`email`The\ncustomer’s email.\n```\n<form id=\"payment-form\">\n <div class=\"form-row\">\n <label for=\"name\">\n Name\n </label>\n <input id=\"name\" name=\"name\" required>\n </div>\n\n <div class=\"form-row\">\n <label for=\"email\">\n Email\n </label>\n <input id=\"email\" name=\"email\" required>\n </div>\n\n <button id=\"submit-button\">Pay with Sofort</button>\n\n <!-- Display mandate acceptance text. -->\n <div id=\"mandate-acceptance\">\n By providing your payment information and confirming this payment, you\n authorise (A) Rocket Rides and Stripe, our payment service provider, to\n send instructions to your bank to debit your account and (B) your bank to\n debit your account in accordance with those instructions. As part of your\n rights, you are entitled to a refund from your bank under the terms and\n conditions of your agreement with your bank. A refund must be claimed\n within 8 weeks starting from the date on which your account was debited.\n Your rights are explained in a statement that you can obtain from your\n bank. You agree to receive notifications for future debits up to 2 days\n before they occur.\n </div>\n <!-- Used to display form errors. -->\n <div id=\"error-message\" role=\"alert\"></div>\n</form>\n```\n\n[Submit the payment to\nStripeClient-side](https://docs.stripe.com/payments/sofort/save-during-payment#submit-payment)\nRather than sending the entire PaymentIntent object to the client, use its\n[client\nsecret](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-client_secret)\nfrom [step\n3](https://docs.stripe.com/payments/sofort/save-during-payment#web-create-payment-intent).\nThis is different from your API keys that authenticate Stripe API requests.\n\nThe client secret should still be handled carefully because it can complete the\ncharge. Do not log it, embed it in URLs, or expose it to anyone but the\ncustomer.\n\nHTML + JSReact\nUse\n[stripe.confirmSofortPayment](https://docs.stripe.com/js/payment_intents/confirm_sofort_payment)\nto handle the redirect away from your page and to complete the payment. Add a\n[return_url](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-return_url)\nto this function to indicate where Stripe should redirect the user after they\ncomplete the payment on their bank’s website or mobile application.\n\nInclude your customer’s name and email address in\n`payment_method[billing_details]`. They will be used when generating the SEPA\nDirect Debit PaymentMethod.\n\n```\nvar stripe = Stripe('pk_test_TYooMQauvdEDq54NiTphI7jx');\nvar accountholderName = document.getElementById('name');\nvar accountholderEmail = document.getElementById('email');\n\n// Redirects away from the client\nconst {error} = await stripe.confirmSofortPayment(\n '{{PAYMENT_INTENT_CLIENT_SECRET}}',\n {\n payment_method: {\n sofort: {\n country: \"DE\"\n },\n billing_details: {\n name: accountholderName.value,\n email: accountholderEmail.value,\n },\n },\n return_url: 'https://example.com/checkout/complete',\n }\n);\n\nif (error) {\n // Inform the customer that there was an error.\n}\n```\n\nWhen your customer submits a payment, Stripe redirects them to the `return_url`\nand includes the following URL query parameters. The return page can use them to\nget the status of the PaymentIntent so it can display the payment status to the\ncustomer.\n\nWhen you specify the `return_url`, you can also append your own query parameters\nfor use on the return page.\n\nParameterDescription`payment_intent`The unique identifier for the\n`PaymentIntent`.`payment_intent_client_secret`The [client\nsecret](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-client_secret)\nof the `PaymentIntent` object.\nWhen the customer is redirected back to your site, you can use the\n`payment_intent_client_secret` to query for the PaymentIntent and display the\ntransaction status to your customer.\n\n[Charge the SEPA Direct Debit PaymentMethod\nlater](https://docs.stripe.com/payments/sofort/save-during-payment#charge-sepa-pm)\nWhen you need to charge your customer again, create a new PaymentIntent. Find\nthe ID of the SEPA Direct Debit payment method by\n[retrieving](https://docs.stripe.com/api/payment_intents/retrieve) the previous\nPaymentIntent and [expanding](https://docs.stripe.com/api/expanding_objects) the\n`latest_charge` field where you will find the `generated_sepa_debit` ID inside\nof `payment_method_details`.\n\n```\ncurl -G https://api.stripe.com/v1/payment_intents/{{PAYMENT_INTENT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"expand[]\"=latest_charge\n```\n\nThe SEPA Direct Debit payment method ID is the `generated_sepa_debit` ID under\n[payment_method_details](https://docs.stripe.com/api/charges/object#charge_object-payment_method_details-sofort)\nin the response.\n\n```\n{\n \"latest_charge\": {\n \"payment_method_details\": {\n \"sofort\": {\n \"bank_code\": \"VAPE\",\n \"bank_name\": \"VAN DE PUT & CO\",\n \"bics\": \"VAPEBE22\",\n \"iban_last4\": \"7061\",\n \"generated_sepa_debit\": \"pm_1GrddXGf98efjktuBIi3ag7aJQ\",\n \"preferred_language\": \"en\",\n \"verified_name\": \"Jenny Rosen\"\n },\n \"type\": \"sofort\"\n },\n },\n \"payment_method_options\": {\n \"sofort\": {}\n```\n\nSee all 32 lines\nCreate a PaymentIntent with the SEPA Direct Debit and Customer IDs.\n\n```\ncurl https://api.stripe.com/v1/payment_intents \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"payment_method_types[]\"=sepa_debit \\\n -d amount=1099 \\\n -d currency=eur \\\n -d customer={{CUSTOMER_ID}} \\\n -d payment_method={{SEPA_DEBIT_PAYMENT_METHOD_ID}} \\\n -d confirm=true\n```\n\n[Test your\nintegration](https://docs.stripe.com/payments/sofort/save-during-payment#test-your-integration)EmailPaymentMethod\nSet `payment_method.billing_details.email` to one of the following values to\ntest the PaymentIntent status transitions. You can include your own custom text\nat the beginning of the email address followed by an underscore. For example,\n`test_1_generatedSepaDebitIntentsFail@example.com` results in a SEPA Direct\nDebit PaymentMethod that will always fail when used with a PaymentIntent.\n\nCountry:AustriaBelgiumGermanyNetherlandsSpainEmail\nAddressDescriptiongeneratedSepaDebitIntentsSucceedAustria@example.comThe SEPA\nDirect Debit PaymentIntent status transitions from `processing` to\n`succeeded`.generatedSepaDebitIntentsSucceedDelayedAustria@example.comThe SEPA\nDirect Debit PaymentIntent status transitions from `processing` to `succeeded`\nafter at least three minutes.generatedSepaDebitIntentsFailAustria@example.comThe\nSEPA Direct Debit PaymentIntent status transitions from `processing` to\n`requires_payment_method`.generatedSepaDebitIntentsFailDelayedAustria@example.comThe\nSEPA Direct Debit PaymentIntent status transitions from `processing` to\n`requires_payment_method` after at least three\nminutes.generatedSepaDebitIntentsSucceedDisputedAustria@example.comThe SEPA\nDirect Debit PaymentIntent status transitions from `processing` to `succeeded`,\nbut a dispute is created immediately.\n## Handle post-payment events\n\nAs Sofort is a [delayed\nnotification](https://docs.stripe.com/payments/payment-methods#payment-notification)\npayment method, the PaymentIntent’s status remains in a\n[payment_intent.processing](https://docs.stripe.com/api/events/types#event_types-payment_intent.processing)\nstate for up to 14 days from its creation (also known as the cutoff date). In a\n[sandbox](https://docs.stripe.com/sandboxes), the PaymentIntent’s status remains\nin the processing state for three minutes to simulate this.\n\n- Stripe recommends fulfilling purchases during the processing state. On\naverage, you can expect approximately 0.2% of Sofort payment attempts to fail\nafter entering the processing state. This only applies to Sofort payments due to\nits low payment failure rate and doesn’t apply to other [delayed\nnotification](https://docs.stripe.com/payments/payment-methods#payment-notification)\npayment methods.\n- You may prefer to fulfill orders only after receiving the\n[payment_intent.succeeded](https://docs.stripe.com/api/events/types#event_types-payment_intent.succeeded)\nevent. Stripe sends this event after the payment attempt is confirmed and the\nfunds are guaranteed.\n- If a customer doesn’t pay, Stripe sends the\n[payment_intent.failed](https://docs.stripe.com/api/events/types#event_types-payment_intent.failed)\nevent and the PaymentIntent returns to a status of `requires_payment_method`.\n\nUse the Dashboard, a custom [webhook](https://docs.stripe.com/webhooks), or a\npartner solution to receive these events and run actions, like sending an order\nconfirmation email to your customer, logging the sale in a database, or starting\na shipping workflow.\n\n### Manually\n\nUse the Stripe Dashboard to view all your Stripe payments, send email receipts,\nhandle payouts, or retry failed payments.\n\n- [View your test payments in the\nDashboard](https://dashboard.stripe.com/test/payments)\n\n### Custom code\n\nBuild a webhook handler to listen for events and build custom asynchronous\npayment flows. Test and debug your webhook integration locally with the Stripe\nCLI.\n\n- [Build a custom\nwebhook](https://docs.stripe.com/payments/handling-payment-events#build-your-own-webhook)\n\n### Prebuilt apps\n\nHandle common business events, like\n[automation](https://stripe.partners/?f_category=automation) or [marketing and\nsales](https://stripe.partners/?f_category=marketing-and-sales), by integrating\na partner application.\n\n[OptionalHandle the Sofort redirect\nmanually](https://docs.stripe.com/payments/sofort/save-during-payment#handle-redirect)\n## See also\n\n- [Accept a SEPA Direct Debit\npayment](https://docs.stripe.com/payments/sepa-debit/accept-a-payment)\n- [Set up a subscription with SEPA Direct Debit in the\nEU](https://docs.stripe.com/billing/subscriptions/sepa-debit)\n\n## Links\n\n- [support\npage](https://support.stripe.com/questions/sofort-is-being-deprecated-as-a-standalone-payment-method)\n- [Save payment details during\npayment](https://docs.stripe.com/payments/save-during-payment)\n- [Payment Element migration\nguide](https://docs.stripe.com/payments/payment-element/migration)\n- [accepting SEPA Direct Debit\npayments](https://docs.stripe.com/payments/sepa-debit/accept-a-payment)\n- [single use](https://docs.stripe.com/payments/payment-methods#usage)\n- [delayed\nnotification](https://docs.stripe.com/payments/payment-methods#payment-notification)\n-\n[authenticate](https://docs.stripe.com/payments/payment-methods#customer-actions)\n- [Customers](https://docs.stripe.com/api/customers)\n- [IBAN](https://en.wikipedia.org/wiki/International_Bank_Account_Number)\n- [SEPA Direct Debit](https://docs.stripe.com/payments/sepa-debit)\n- [PaymentMethod](https://docs.stripe.com/api/payment_methods)\n- [set up a\nsubscription](https://docs.stripe.com/billing/subscriptions/sepa-debit)\n- [Dashboard](https://dashboard.stripe.com/account/payments/settings)\n- [Sofort Terms of Service](https://stripe.com/sofort/legal)\n- [SEPA Direct Debit Terms of\nService](https://stripe.com/sepa-direct-debit/legal)\n- [PaymentIntent](https://docs.stripe.com/api/payment_intents)\n- [Register now](https://dashboard.stripe.com/register)\n- [setup future\nusage](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-setup_future_usage)\n- [Payment Intents](https://docs.stripe.com/payments/payment-intents)\n- [payment method\ntypes](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-payment_method_types)\n- [client\nsecret](https://docs.stripe.com/api/payment_intents/object#payment_intent_object-client_secret)\n-\n[stripe.confirmSofortPayment](https://docs.stripe.com/js/payment_intents/confirm_sofort_payment)\n-\n[return_url](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-return_url)\n- [retrieving](https://docs.stripe.com/api/payment_intents/retrieve)\n- [expanding](https://docs.stripe.com/api/expanding_objects)\n-\n[payment_method_details](https://docs.stripe.com/api/charges/object#charge_object-payment_method_details-sofort)\n-\n[payment_intent.processing](https://docs.stripe.com/api/events/types#event_types-payment_intent.processing)\n- [sandbox](https://docs.stripe.com/sandboxes)\n-\n[payment_intent.succeeded](https://docs.stripe.com/api/events/types#event_types-payment_intent.succeeded)\n-\n[payment_intent.failed](https://docs.stripe.com/api/events/types#event_types-payment_intent.failed)\n- [webhook](https://docs.stripe.com/webhooks)\n- [View your test payments in the\nDashboard](https://dashboard.stripe.com/test/payments)\n- [Build a custom\nwebhook](https://docs.stripe.com/payments/handling-payment-events#build-your-own-webhook)\n- [automation](https://stripe.partners/?f_category=automation)\n- [marketing and sales](https://stripe.partners/?f_category=marketing-and-sales)",
  "metadata": {
    "title": "Save bank details during a Sofort payment | Stripe Documentation",
    "description": "Learn how to save your customer's IBAN bank details from a Sofort payment.",
    "sourceURL": "https://docs.stripe.com/payments/sofort/save-during-payment"
  }
}