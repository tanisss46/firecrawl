{
  "content": "# Event destinations\n\n## Send events from Stripe to webhook endpoints and cloud services.\n\nSet up an event destination to receive events from Stripe across multiple\ndestination types, including webhook endpoints, and [Amazon\nEventBridge](https://docs.stripe.com/event-destinations/eventbridge).\n\nAdditionally, you can use thin events created by [API\nv2](https://docs.stripe.com/api-v2-overview) endpoints. The SDKs for API v2\nincludes helpers that allow your application to fetch the latest object state\nfrom Stripe.\n\n## Use cases\n\nWhen building Stripe integrations, you might want your applications to receive\nevents in real-time from your Stripe accounts, enabling your backend systems to\nrespond and perform actions accordingly.\n\nWith an event destination, Stripe pushes real-time event data from your account,\nenabling you to run backend actions, such as:\n\n- Sending users a notification when a customer confirms a payment\n- Initiating an internal claims reconciliation process when a customer disputes\na charge\n- Granting access to your user when they make successful recurring subscription\npayments\n\n## Supported destination types\n\nSend events to an AWS account using [Amazon\nEventBridge](https://docs.stripe.com/event-destinations/eventbridge), or deliver\nthem to an HTTPS endpoint through [webhook\nendpoints](https://docs.stripe.com/webhooks).\n\n## Events overview\n\nStripe generates event data to keep you informed about the activity in your\naccount.\n\nWhen an event occurs, Stripe generates a new `Event` object. After your\ndestination receives the `Event`, your app can run backend actions (for example,\ncalling your shipping provider’s APIs to schedule a shipment after you receive a\n`payment_intent.succeeded` event). We provide two different types of `Event`\nobjects:\n\n- [Thin events](https://docs.stripe.com/api/v2/events): These events only\ninclude the ID of the affected objects. These are generated by API v2 endpoints.\nAPI v1 endpoints also generate thin events. See a [full list of thin\nevents](https://docs.stripe.com/api/v2/events/event-types).\n- [Snapshot events](https://docs.stripe.com/api/events): These events provide an\neventually-consistent snapshot of the object that has changed and are only\ngenerated by API v1 endpoints. They might include a `previous_attributes`\nproperty that indicates the change when applicable. See a [full list of snapshot\nevents](https://docs.stripe.com/api/events/types).\n\nThis table outlines high-level differences across thin events and snapshot\nevents.\n\nCharacteristicsSnapshot eventsThin eventsCreated byAPI v1 resource state\nchangesAPI v2 resource state changesPayloadLarge: Includes a snapshot of the API\nobject related to the eventSmall: Only includes an ID of the API object related\nto the eventSDK typingUntypedTypedVersioningVersioned by API versionUnversioned,\nallowing you to upgrade your integration without changing your webhook endpoint\nconfiguration\nA single API request might result in the creation of multiple events. For\nexample, creating a new subscription for a customer might result in\n`customer.subscription.created` and `payment_intent.succeeded` events. Select\nthe events you want to subscribe to for each event destination.\n\n## Thin events\n\nThin events are lightweight events you can access through the [API\nv2](https://docs.stripe.com/api-v2-overview) namespace. Thin events have a more\ngranular permissions model and their payloads contain no API-versioned data,\nonly the IDs of the objects related to the event. This helps update integrations\nthat receive events and are built with a well-typed Stripe SDK. Thin Events:\n\n- Include a `data` property that can include additional information about the\nevent.\n- Are fully typed in the SDKs for API v2.\n\nYou can retrieve [Event](https://docs.stripe.com/api/v2/events) objects for each\nnotification from the `/v2/core/events` endpoint. These API objects include the\n`data` property that can provide additional details about the thin event.\n\n### Prevent application errors\n\nIf your application needs a corresponding API object related to an event (for\nexample, the [Meter](https://docs.stripe.com/api/billing/meter/retrieve)), you\nmust call the Stripe API for the object’s latest state. Although this method\nrequires an additional network call to Stripe, it helps prevent application\nerrors caused by outdated object data (for example, race conditions). The SDKs\nfor API v2 contain helper methods that allow you to retrieve records associated\nwith an event.\n\n### Example thin event payload\n\nThe following is an example of an `v1.billing.meter.error_report_triggered`\nevent. The `related_object` field includes the `id` of the object, but doesn’t\ninclude the object record itself.\n\n```\n{\n \"id\": \"evt_test_65R9Ijk8dKEYZcXeRWn16R9A7j1FSQ3w3TGDPLLGSM4CW0\",\n \"object\": \"v2.core.event\",\n \"type\": \"v1.billing.meter.error_report_triggered\",\n \"livemode\": false,\n \"created\": \"2024-09-17T06:20:52.246Z\",\n \"related_object\": {\n \"id\": \"mtr_test_61R9IeP0SgKbYROOx41PEAQhH0qO23oW\",\n \"type\": \"billing.meter\",\n \"url\": \"/v1/billing/meters/mtr_test_61R9IeP0SgKbYROOx41PEAQhH0qO23oW\"\n }\n}\n```\n\nAs a result, a thin event payload is much smaller than a snapshot event payload.\nFor comparison, the following is an example of an `invoice.created` snapshot\nevent:\n\n```\n{\n \"object\": {\n \"id\": \"in_1KnN0G589O8KAxCGfVSpD0Pj\",\n \"object\": \"invoice\",\n \"account_country\": \"US\",\n```\n\nSee all 185 lines\n## Retrieve additional information associated with a thin event\n\nThere are two types of information you can retreive related to a thin event:\n\n- **Related object resource definition**: Each thin event details a specific\noccurrence related to a Stripe object. Use the `fetchRelatedObject()` method to\nretrieve the latest version of the object associated with the event. For\nexample, if you receive a `v1.billing.meter.error_report_triggered` event,\n`fetchRelatedObject()` retrieves the current version of the meter object that\ntriggered an error report.\n- **Additional event payload fields**: Thin events might contain additional\ncontextual data that’s only retrievable with the API. Use the `retrieve()` call\nwith the thin event ID to retrieve these additional payload fields. For example,\nfetching a `v1.billing.meter.error_report_triggered` event with the API return\nan additional `data` hash. This hash includes contextual fields about the errors\ntriggered, such as the time the validation error occurred, a list of sample\nerror messages, and the number of validation errors.\n\nThe following example demonstrates how to retrieve the related object definition\nand additional event payload fields associated with a thin event:\n\n```\ncom.stripe.model.ThinEvent thinEvent = client.parseThinEvent(payload,\nsignatureHeader, endpointSecret);\ncom.stripe.model.v2.Event event =\nclient.v2().core().events().retrieve(thinEvent.getId());\nif (event instanceof V1BillingMeterErrorReportTriggeredEvent) {\nV1BillingMeterErrorReportTriggeredEvent postedEvent =\n(V1BillingMeterErrorReportTriggeredEvent) event;\n// On each type of event, the Stripe library provides a \"fetchRelatedObject\"\nmethod\n // that performs a network request to Stripe to fetch the latest version\n // of the object directly associated with the event, in this case, an\n // \"Meter\" object.\n Meter op = postedEvent.fetchRelatedObject();\n}\n```\n\n## Event permissions\n\nTo view an event in the Dashboard, assign the [Admin or Developer\nrole](https://docs.stripe.com/get-started/account/teams/roles) to your user\naccount. To retrieve an event using the API, use either a [secret API\nkey](https://docs.stripe.com/keys#create-api-secret-key), which allows you to\nview all event types by default, or a [restricted API\nkey](https://docs.stripe.com/keys#create-restricted-api-secret-key) with `Read`\naccess enabled for the specific event type’s resource. For example, you can\ngrant `Read` access to `payment_intent` resources on your restricted API key to\nprogrammatically retrieve `payment_intent.succeeded events`.\n\n## Event retention\n\nYou can access events created within the last 13 months in the **Events** tab in\nWorkbench; however, you can only manually re-send or view delivery attempts that\nare less than 15 days old from the **Event Deliveries** section. For events\nolder than 30 days, you can access a summary view, which only includes truncated\nfields of the original event data.\n\nYou can access thin events within the last 30 days using the [Retrieve\nevent](https://docs.stripe.com/api/v2/events/retrieve) and [List\nevents](https://docs.stripe.com/api/v2/events/list) API v2 endpoints. To access\nsnapshot events within the last 30 days, use the [Retrieve\nevent](https://docs.stripe.com/api/events/retrieve) and [List\nevent](https://docs.stripe.com/api/events/list) API v1 endpoints.\n\n## Manage an event destination\n\nTo create, delete, and update an event destination in the Dashboard, open the\n[Webhooks](https://dashboard.stripe.com/webhooks) tab in Workbench or use the\n[event destinations API](https://docs.stripe.com/api/v2/event-destinations/).\n\n## Disable an event destination\n\nYou can disable an event destination. After you disable it, Stripe stops sending\nany events to that destination. After you re-enabled a destination, Stripe\nresumes sending events to the destination.\n\n## Links\n\n- [Amazon EventBridge](https://docs.stripe.com/event-destinations/eventbridge)\n- [API v2](https://docs.stripe.com/api-v2-overview)\n- [webhook endpoints](https://docs.stripe.com/webhooks)\n- [Thin events](https://docs.stripe.com/api/v2/events)\n- [full list of thin events](https://docs.stripe.com/api/v2/events/event-types)\n- [Snapshot events](https://docs.stripe.com/api/events)\n- [full list of snapshot events](https://docs.stripe.com/api/events/types)\n- [Meter](https://docs.stripe.com/api/billing/meter/retrieve)\n- [Admin or Developer\nrole](https://docs.stripe.com/get-started/account/teams/roles)\n- [secret API key](https://docs.stripe.com/keys#create-api-secret-key)\n- [restricted API\nkey](https://docs.stripe.com/keys#create-restricted-api-secret-key)\n- [Retrieve event](https://docs.stripe.com/api/v2/events/retrieve)\n- [List events](https://docs.stripe.com/api/v2/events/list)\n- [Retrieve event](https://docs.stripe.com/api/events/retrieve)\n- [List event](https://docs.stripe.com/api/events/list)\n- [Webhooks](https://dashboard.stripe.com/webhooks)\n- [event destinations API](https://docs.stripe.com/api/v2/event-destinations/)",
  "metadata": {
    "title": "Event destinations | Stripe Documentation",
    "description": "Send events from Stripe to webhook endpoints and cloud services.",
    "sourceURL": "https://docs.stripe.com/event-destinations"
  }
}