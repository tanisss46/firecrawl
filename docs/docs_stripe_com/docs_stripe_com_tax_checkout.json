{
  "content": "# Automatically collect tax on Checkout sessions\n\n## Learn how to automatically calculate taxes in Checkout.\n\nStripe Tax automatically calculates the taxes on all purchases and\n[subscriptions](https://docs.stripe.com/billing/subscriptions/creating)\naccumulated during a Checkout session. If you haven’t integrated with Checkout,\nyou must complete the integration using the [Accept a Payment\nguide](https://docs.stripe.com/checkout/quickstart).\n\n## Get started with a video demo\n\nThis short video shows to how to enable automatic tax collection when using\nhosted integrations like Stripe Checkout.\n\n[Activate Stripe Tax](https://docs.stripe.com/tax/checkout#activate)\n[Log in](https://dashboard.stripe.com/settings/tax) or [sign\nup](https://dashboard.stripe.com/register) for Stripe to activate Stripe Tax.\n\n[Update your products and prices\n(optional)](https://docs.stripe.com/tax/checkout#product-and-price-setup)\nStripe Tax uses information stored on\n[products](https://docs.stripe.com/api/products) and\n[prices](https://docs.stripe.com/api/prices) to calculate tax, such as [tax\ncode](https://docs.stripe.com/api/products/object#product_object-tax_code) and\n[tax\nbehavior](https://docs.stripe.com/api/prices/object#price_object-tax_behavior).\nIf you don’t explicitly specify these configurations, Stripe Tax will use the\ndefault tax code selected in [Tax\nSettings](https://dashboard.stripe.com/settings/tax).\n\nFor more information, see [Specify product tax codes and tax\nbehaviour](https://docs.stripe.com/tax/products-prices-tax-codes-tax-behavior).\n\n[Create a Checkout Session](https://docs.stripe.com/tax/checkout#create-session)\nAfter updating your products and prices, you’re ready to start calculating tax\non your Checkout sessions. You can create sessions for one time and recurring\npurchases.\n\nA customer’s tax rates come from their location, which Checkout assesses from\nthe customer’s address. The address that Checkout uses to calculate taxes\ndepends on whether the customer is new or existing, and whether you collect\nshipping addresses during the Checkout Session:\n\nNew CustomerExisting CustomerCollect a billing address onlyCheckout calculates\ntaxes based on the customer’s billing address entered into the Checkout\nSessionIf the customer has a previously saved shipping address, Checkout\ncalculates taxes based on that address. Otherwise, you can calculate taxes based\non billing address entered during Checkout (by specifying\n[customer_update[address]=auto](https://docs.stripe.com/api/checkout/sessions/create#create_checkout_session-customer_update-address))\nor the billing address saved to the customer (the default behavior).Collect a\nshipping addressCheckout calculates taxes based on the customer’s shipping\naddress entered into the Checkout SessionCheckout calculates taxes based on the\ncustomer’s shipping address entered into the Checkout Session. Existing\naddresses on the customer won’t apply in this case.\n#### Note\n\nIf you wish to ensure that Google Pay is offered as a payment method while using\nStripe Tax in Checkout, you must require collecting a shipping address. Apple\nPay with Stripe Tax displays only when the customer’s browser supports Apple Pay\nversion 12.\n\n[Calculating tax for new\ncustomers](https://docs.stripe.com/tax/checkout#new-customers)\nIf you don’t pass in an existing customer when creating a Checkout session,\nCheckout creates a new customer and automatically saves billing address and\nshipping information. For tax collection purposes, Checkout uses billing and\nshipping addresses to determine the customer’s location.\n\nCheckout uses the shipping address entered during the session to determine the\ncustomer’s location for calculating tax. If you don’t collect shipping\ninformation, Checkout uses the billing address.\n\nStripe-hosted pageEmbedded form\n```\ncurl https://api.stripe.com/v1/checkout/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"line_items[0][price]\"={{PRICE_ID}} \\\n -d \"line_items[0][quantity]\"=2 \\\n -d \"automatic_tax[enabled]\"=true \\\n -d mode=payment \\\n --data-urlencode success_url=\"https://example.com/success\" \\\n --data-urlencode cancel_url=\"https://example.com/cancel\"\n```\n\n## Calculate tax for existing customers\n\nTo calculate tax on Checkout sessions created for existing customers, you can\nset the `automatic_tax[enabled]` parameter to `true` when creating the session.\nYou can either base tax calculations on the customer’s existing addresses or new\naddresses collected during the session:\n\n### Use the existing addresses on the customer for taxes\n\nIf you’ve already collected the addresses of existing customers, you can base\ntax calculations on those addresses rather than the addresses collected during\ncheckout:\n\n- **The customer address that Checkout uses for taxes**: If available, Checkout\nuses the customer’s saved [shipping\naddress](https://docs.stripe.com/api/customers/object#customer_object-shipping-address)\nto calculate taxes. Otherwise, Checkout uses the customer’s saved [billing\naddress](https://docs.stripe.com/api/customers/object#customer_object-address)\nto calculate taxes.\n- **Customer address requirements**: When using existing addresses for taxes,\nthe customer must either have a valid [shipping\naddress](https://docs.stripe.com/api/customers/object#customer_object-shipping-address)\nor [billing\naddress](https://docs.stripe.com/api/customers/object#customer_object-address)\nsaved. You can see whether or not a customer’s saved addresses are valid by\nchecking the customer’s\n[customer.tax.automatic_tax](https://docs.stripe.com/api/customers/object#customer_object-tax-automatic_tax)\nproperty. If the property is `supported` or `not_collecting`, it means the\ncustomer’s saved addresses are valid, and you can enable Stripe Tax on Checkout\nsessions for that customer.\nStripe-hosted pageEmbedded form\n```\ncurl https://api.stripe.com/v1/checkout/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"line_items[0][price]\"={{PRICE_ID}} \\\n -d \"line_items[0][quantity]\"=2 \\\n -d \"automatic_tax[enabled]\"=true \\\n -d customer={{CUSTOMER_ID}} \\\n -d mode=payment \\\n --data-urlencode success_url=\"https://example.com/success\" \\\n --data-urlencode cancel_url=\"https://example.com/cancel\"\n```\n\n### Use the addresses collected during Checkout for taxes\n\nYou can configure Checkout to save new billing or shipping addresses to a\ncustomer. In this case, Checkout calculates tax using the address entered during\ncheckout.\n\n- **The address that Checkout uses for taxes**: If you [collect shipping\naddresses](https://docs.stripe.com/api/checkout/sessions/create#create_checkout_session-shipping_address_collection),\nCheckout uses the shipping address entered during the session to calculate\ntaxes. Otherwise, Checkout uses the billing address entered during the session\nto calculate taxes.\n- **Where Checkout saves the addresses collected during checkout**: If you\n[collect shipping\naddresses](https://docs.stripe.com/api/checkout/sessions/create#create_checkout_session-shipping_address_collection),\nCheckout saves the shipping address entered during the session to the customer’s\n[customer.shipping.address](https://docs.stripe.com/api/customers/object#customer_object-shipping-address)\nproperty. Otherwise, Checkout saves the billing address entered during the\nsession to the customer’s\n[customer.address](https://docs.stripe.com/api/customers/object#customer_object-address)\nproperty. In both cases, the address used for taxes overrides any existing\naddresses.\n\nIf you collect shipping addresses with Checkout, set the\n`customer_update[shipping]` property to `auto` so that you copy the shipping\ninformation from Checkout to the customer.\n\nStripe-hosted pageEmbedded form\n```\ncurl https://api.stripe.com/v1/checkout/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"line_items[0][price]\"={{PRICE_ID}} \\\n -d \"line_items[0][quantity]\"=2 \\\n -d \"automatic_tax[enabled]\"=true \\\n -d customer={{CUSTOMER_ID}} \\\n -d \"customer_update[shipping]\"=auto \\\n -d \"shipping_address_collection[allowed_countries][0]\"=US \\\n -d mode=payment \\\n --data-urlencode success_url=\"https://example.com/success\" \\\n --data-urlencode cancel_url=\"https://example.com/cancel\"\n```\n\nIf you don’t collect shipping addresses with Checkout, and you want to use\nbilling addresses entered during checkout for taxes, you must save the billing\naddress to the customer. Set the `customer_update[address]` property to `auto`\nso that you copy the newly-entered address onto the provided customer.\n\nStripe-hosted pageEmbedded form\n```\ncurl https://api.stripe.com/v1/checkout/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"line_items[0][price]\"={{PRICE_ID}} \\\n -d \"line_items[0][quantity]\"=2 \\\n -d \"automatic_tax[enabled]\"=true \\\n -d customer={{CUSTOMER_ID}} \\\n -d \"customer_update[address]\"=auto \\\n -d mode=payment \\\n --data-urlencode success_url=\"https://example.com/success\" \\\n --data-urlencode cancel_url=\"https://example.com/cancel\"\n```\n\n## Check the response\n\nTo inspect the results of the latest tax calculation, you can read the tax\namount calculated by Checkout from the\n[total_details.amount_tax](https://docs.stripe.com/api/checkout/sessions/object#checkout_session_object-total_details)\non the Checkout Session resource. Additionally, the tax outcome for each payment\nis available when [viewing a\npayment](https://dashboard.stripe.com/test/payments) in the Dashboard.\n\n## See also\n\n- [Determining customer\nlocations](https://docs.stripe.com/tax/customer-locations)\n- [Checkout and tax IDs](https://docs.stripe.com/tax/checkout/tax-ids)\n- [Reporting and filing](https://docs.stripe.com/tax/reports)\n- [Use Stripe Tax with Connect](https://docs.stripe.com/tax/connect)\n- [Calculate tax in your custom checkout\nflow](https://docs.stripe.com/tax/custom)\n\n## Links\n\n- [subscriptions](https://docs.stripe.com/billing/subscriptions/creating)\n- [Accept a Payment guide](https://docs.stripe.com/checkout/quickstart)\n- [Log in](https://dashboard.stripe.com/settings/tax)\n- [sign up](https://dashboard.stripe.com/register)\n- [products](https://docs.stripe.com/api/products)\n- [prices](https://docs.stripe.com/api/prices)\n- [tax\ncode](https://docs.stripe.com/api/products/object#product_object-tax_code)\n- [tax\nbehavior](https://docs.stripe.com/api/prices/object#price_object-tax_behavior)\n- [Specify product tax codes and tax\nbehaviour](https://docs.stripe.com/tax/products-prices-tax-codes-tax-behavior)\n-\n[customer_update[address]=auto](https://docs.stripe.com/api/checkout/sessions/create#create_checkout_session-customer_update-address)\n- [https://example.com/success](https://example.com/success)\n- [https://example.com/cancel](https://example.com/cancel)\n- [shipping\naddress](https://docs.stripe.com/api/customers/object#customer_object-shipping-address)\n- [billing\naddress](https://docs.stripe.com/api/customers/object#customer_object-address)\n-\n[customer.tax.automatic_tax](https://docs.stripe.com/api/customers/object#customer_object-tax-automatic_tax)\n- [collect shipping\naddresses](https://docs.stripe.com/api/checkout/sessions/create#create_checkout_session-shipping_address_collection)\n-\n[total_details.amount_tax](https://docs.stripe.com/api/checkout/sessions/object#checkout_session_object-total_details)\n- [viewing a payment](https://dashboard.stripe.com/test/payments)\n- [Determining customer\nlocations](https://docs.stripe.com/tax/customer-locations)\n- [Checkout and tax IDs](https://docs.stripe.com/tax/checkout/tax-ids)\n- [Reporting and filing](https://docs.stripe.com/tax/reports)\n- [Use Stripe Tax with Connect](https://docs.stripe.com/tax/connect)\n- [Calculate tax in your custom checkout\nflow](https://docs.stripe.com/tax/custom)",
  "metadata": {
    "title": "Automatically collect tax on Checkout sessions | Stripe Documentation",
    "description": "Learn how to integrate Stripe Tax with Checkout to automatically calculate taxes on sales and subscriptions. Stripe Tax uses customer billing and shipping addresses to determine applicable tax rates for new and existing customers. This guide explains how to configure your Checkout integration to handle tax calculations.",
    "sourceURL": "https://docs.stripe.com/tax/checkout"
  }
}