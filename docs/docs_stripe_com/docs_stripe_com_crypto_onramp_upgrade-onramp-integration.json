{
  "content": "# Upgrade your onramp integrationPublic preview\n\n## Learn about the API changes when upgrading your onramp beta integration.\n\n#### Caution\n\nFollow this guide if you integrated with the onramp API before 2023-06-21.\n\nWe made changes to the Stripe fiat-to-crypto onramp API as part of our public\nrelease. If you integrated with onramp before 2023-06-21, you’re integrated with\nthe beta onramp API.\n\nThis guide covers the changes made, impact to existing integrations, and\ninstructions for migrating to this latest version.\n\n## Changes from the onramp beta\n\n- Flatted `transaction_details` into the top-level `POST\n/v1/crypto/onramp_sessions` request body\n- Renamed the following fields in onramp API requests and resources-\n`supported_destination_currencies` is now `destination_currencies`\n- `supported_destination_networks` is now `destination_networks`\n- `source_exchange_amount` is now `source_amount`\n- `destination_exchange_amount` is now `destination_amount`\n- Changed the onramp quotes path from `/v1/crypto/onramp/quotes` to\n`/v1/crypto/onramp_quotes`\n\nExamples of what the changes look like in onramp request and responses follow:\n\n### Fetch an onramp quote\n\nTo fetch an onramp quote, run a command similar to the following:\n\n```\ncurl -G https://api.stripe.com/v1/crypto/onramp_quotes \\\ncurl -G https://api.stripe.com/v1/crypto/onramp/quotes \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -H \"Stripe-Version: 2025-02-24.acacia;crypto_onramp_beta=v2\" \\\n -d \"source_amount\"=\"200\" \\\n -d \"source_exchange_amount\"=\"200\" \\\n```\n\nYou receive a response similar to the following:\n\n```\n{\n \"id\": \"2e5818944df6a2325c7e9c1e72d27174b9bedfc8e64ace47c081370a5b982a7b\",\n \"rate_fetched_at\": 1674265506.3408287,\n \"destination_network_quotes\": {\n \"ethereum\": [\n {\n\"id\": \"d160a80828eabb6b6d4aeafac585eee62d95425c7fb7577866ab04b9a786df00\",\n \"destination_currency\": \"eth\",\n \"destination_amount\": \"0.253568242640499553\",\n \"destination_exchange_amount\": \"0.253568242640499553\",\n \"destination_network\": \"ethereum\",\n \"fees\": {\n \"network_fee_monetary\": \"1.45\",\n \"transaction_fee_monetary\": \"12.71\"\n },\n \"source_total_amount\": \"214.20\"\n },\n {\n\"id\": \"53f864cb28a42f11e1d9d5aff7e43ac96b056406f74cbf618399c6fa40f3d275\",\n \"destination_currency\": \"usdc\",\n \"destination_amount\": \"200.00\",\n \"destination_exchange_amount\": \"200.00\",\n \"destination_network\": \"ethereum\",\n \"fees\": {\n \"network_fee_monetary\": \"5.80\",\n \"transaction_fee_monetary\": \"12.76\"\n },\n \"source_total_amount\": \"218.56\"\n }\n ],\n ...\n },\n \"livemode\": true,\n \"source_currency\": \"usd\",\n \"source_amount\": \"200.00\",\n \"source_exchange_amount\": \"200.00\"\n}\n```\n\n### Creating an onramp session\n\nTo create an onramp session, run a command similar to the following:\n\n```\ncurl -X POST https://api.stripe.com/v1/crypto/onramp_sessions \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -H \"Stripe-Version: 2025-02-24.acacia;crypto_onramp_beta=v2\" \\\n -d \"wallet_addresses[ethereum]\"=\"0xB00F0759DbeeF5E543Cc3E3B07A6442F5f3928a2\" \\\n -d \"source_currency\"=\"usd\" \\\n -d \"destination_amount\"=\"0.1\" \\\n -d \"destination_currency\"=\"eth\" \\\n -d \"destination_network\"=\"ethereum\" \\\n -d \"destination_currencies[]\"=\"eth\" \\\n -d \"destination_networks[]\"=\"ethereum\" \\\n-d\n\"transaction_details[wallet_addresses][ethereum]\"=\"0xB00F0759DbeeF5E543Cc3E3B07A6442F5f3928a2\"\n\\\n -d \"transaction_details[source_currency]\"=\"usd\" \\\n -d \"transaction_details[destination_exchange_amount]\"=\"10\" \\\n -d \"transaction_details[destination_currency]\"=\"eth\" \\\n -d \"transaction_details[destination_network]\"=\"ethereum\" \\\n -d \"transaction_details[supported_destination_currencies][]\"=\"eth\" \\\n -d \"transaction_details[supported_destination_networks][]\"=\"ethereum\"\n```\n\nYou receive a response similar to the following:\n\n```\n{\n \"id\": \"cos_0MYvv9589O8KAxCGPm84FhVR\",\n \"object\": \"crypto.onramp_session\",\n\"client_secret\":\n\"cos_0MYvv9589O8KAxCGPm84FhVR_secret_IGBYKVlTlnJL8UGxji48pKxBO00deNcBuVc\",\n \"created\": 1675794575,\n \"livemode\": false,\n \"status\": \"initialized\",\n \"transaction_details\": {\n \"destination_currency\": \"eth\",\n \"destination_network\": \"ethereum\",\n \"fees\": null,\n \"lock_wallet_address\": false,\n \"source_currency\": \"usd\",\n \"source_amount\": null,\n \"destination_amount\": \"0.100000000000000000\",\n \"destination_currencies\": [\n \"eth\"\n ],\n \"destination_networks\": [\n \"ethereum\"\n ],\n \"source_exchange_amount\": null,\n \"destination_exchange_amount\": \"0.100000000000000000\",\n \"supported_destination_currencies\": [\n \"eth\"\n ],\n \"supported_destination_networks\": [\n \"ethereum\"\n ],\n \"transaction_id\": null,\n \"wallet_address\": null,\n \"wallet_addresses\": {\n \"bitcoin\": null,\n \"ethereum\": \"0xB00F0759DbeeF5E543Cc3E3B07A6442F5f3928a2\",\n \"polygon\": null,\n \"solana\": null,\n \"stellar\": null,\n \"destination_tags\": null\n }\n }\n}\n```\n\n## Impact to existing integrations\n\nWe released these changes in a way that doesn’t break existing beta\nintegrations. If you encounter any issues with your integration, please contact\n[Stripe support](https://support.stripe.com/).\n\n## Migrate from beta to the latest onramp version\n\n#### Common mistake\n\nOnly follow this section if:\n\n- Stripe approved your onramp onboarding application before 2023-06-21.\n- You integrated with onramp before 2023-06-21.\n\nOtherwise, these instructions don’t apply to you since you’re already on the\nlatest onramp version.\n\n### Version compatibility\n\n#### Public preview\n\nIf you want to upgrade your API version, start specifying the\n`crypto_onramp_beta=v2` as part of the `Stripe-Version` header in your requests.\n\nBeta integrations can now pass a `crypto_onramp_beta` version as part of the\n`Stripe-Version` header to consume either the beta or latest onramp API version.\nUse the following matrix to determine what behavior to expect based on the\n`Stripe-Version` header passed.\n\nVersionHeaderExpected API behaviorunspecified`Stripe-Version:\n2025-02-24.acacia`beta`v1``Stripe-Version:\n2025-02-24.acacia;crypto_onramp_beta=v1`beta`v2``Stripe-Version:\n2025-02-24.acacia;crypto_onramp_beta=v2`latest\nIf you’d like to upgrade your API version, start specifying the\n`crypto_onramp_beta=v2` as part of the `Stripe-Version` header in your requests.\n\n## Links\n\n- [Stripe support](https://support.stripe.com/)",
  "metadata": {
    "title": "Upgrade your onramp integration | Stripe Documentation",
    "description": "Learn about the API changes when upgrading your onramp beta integration.",
    "sourceURL": "https://docs.stripe.com/crypto/onramp/upgrade-onramp-integration"
  }
}