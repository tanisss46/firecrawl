{
  "content": "# Export data to a data warehouse\n\n## Automate data exports from Stripe to Snowflake or Redshift.\n\nData Pipeline currently supports\n[Snowflake](https://docs.snowflake.com/en/user-guide/intro-regions.html)\n(deployed on AWS) and [Amazon\nRedshift](https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/select-region.html)\ndata regions. For additional information on supported instances, view the table\nbelow.\n\nAWS RegionSnowflake Amazon Redshift RA3 (with encryption) us-west-2\n(Oregon)us-east-2 (Ohio)us-east-1 (N. Virginia)us-west-1 (N.\nCalifornia)ca-central-1 (Central Canada)sa-east-1 (São Paulo)eu-central-1\n(Frankfurt)eu-west-1 (Ireland)eu-west-2 (London)eu-west-3 (Paris)eu-north-1\n(Stockholm)me-south-1 (Bahrain)ap-southeast-1 (Singapore)ap-southeast-2\n(Sydney)ap-northeast-1 (Tokyo)ap-northeast-2 (Seoul)ap-east-1 (Hong Kong)\n#### Note\n\nIf you’re using another data warehouse besides Snowflake or Amazon Redshift, or\nif your warehouse region isn’t listed above, let us know at\n[data-pipeline@stripe.com](mailto:data-pipeline@stripe.com).\n\n## Get started\n\nWhen you sign up for Data Pipeline, Stripe sends a data share to your Snowflake\nor Amazon Redshift account. After you accept the data share, you can access your\ncore Stripe data in Snowflake or Amazon Redshift within 12 hours. After the\ninitial load, your Stripe data [refreshes\nregularly](https://docs.stripe.com/stripe-data/available-data).\n\n#### Note\n\nYou can only have one warehouse account connected to your Stripe account.\n\nSnowflakeAmazon Redshift RA3\n### Link your Snowflake account\n\nFirst, send all your up-to-date Stripe data and reports through the Dashboard:\n\n- On the [Data Pipeline\nsettings](https://dashboard.stripe.com/settings/stripe-data-pipeline) page in\nthe Dashboard, click **Sign up**.\n- From the drawer, select **Snowflake**, then click **Continue**.\n- Enter your Snowflake [Account\nIdentifier](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html)\nand your AWS region, then click **Next**.\n- the SQL from the code block and insert it in a SQL worksheet in Snowflake\nwarehouse and run the query to retrieve the unique value. Enter the value in the\ntext box and click **Subscribe**.\n\n### Access your data share in Snowflake\n\nNext, after 48 hours, access your data share from your Snowflake account:\n\n- Navigate to your Snowflake account to accept the Stripe data share.\n- In Snowflake, have an `ACCOUNTADMIN` navigate to **Data** > **Shared Data**.\nIn the **Ready to Get** section, navigate to a share entitled\n`SHARE_[ACCOUNT_IDENTIFIER]` from one of three Stripe accounts, depending on\nyour data warehouse region:- `GSWUDFY_STRIPE_AWS_US_EAST_1`: data warehouses in\n`us-east-1`\n- `JZA07263`: data warehouses in `us-west-2`\n- `VM70738`: data warehouses in `us-east-2`\nThen, click **Get shared data** to accept the share.\n- In the modal that opens, give the database a name (for example, “Stripe”),\nselect the roles to grant access to (for example, `SYSADMIN`), then click **Get\nData**.\n- Confirm that you can view your Stripe data in **Data From Direct Shares** and\n**Databases**. You can now query your Stripe data directly in Snowflake.\n\n### Change the warehouse account\n\nTo change the warehouse account your Stripe account is connected to:\n\n- Turn off Data Pipeline from the Dashboard [settings\npage](https://dashboard.stripe.com/settings/stripe-data-pipeline).\n- Sign up for Data Pipeline again using the steps detailed above for the new\nwarehouse account you want to connect to.\n\nTo add another Stripe account to your warehouse account:\n\n- Follow the [sign\nup](https://docs.stripe.com/stripe-data/access-data-in-warehouse/data-warehouses#get-started)\nsteps above for your new Stripe account.\n- Use the same account identifier as above for the respective warehouse. To find\nyour Account ID, navigate to the Dashboard [settings\npage](https://dashboard.stripe.com/settings/stripe-data-pipeline) and locate\n**ID** under the **Connected data warehouse** section.\n\n## Query Stripe data in your data warehouse\n\nIn Snowflake and Amazon Redshift, your data is available as secure views. To\nquery your data, follow the steps below.\n\nSnowflakeAmazon Redshift RA3\nView your available Stripe data by navigating to **Views** in the database you\ncreated. For each table, you can also see the available columns by clicking on\nthe table and navigating to **Columns**.\n\n## Financial reports in Data Pipeline\n\nTo facilitate your financial close, you can access Stripe’s\n[reports](https://docs.stripe.com/stripe-reports) directly in your data\nwarehouse.\n\n#### Note\n\nAt this time, financial reports aren’t available for Amazon Redshift.\n\nFinancial report templates have a `FINANCIAL_REPORT` prefix and are available as\nviews in your data warehouse.\n\n!\n\n### Generating financial reports in Snowflake\n\nGenerating financial reports from Data Pipeline requires setting a few custom\nvariables. These are the same variables you set when generating the report\nthrough the Dashboard or API:\n\n- `START_DATE` (varchar)—The starting date of the report (inclusive).\n- `END_DATE` (varchar)—The ending date of the report (exclusive).\n- `TIMEZONE` (varchar)—The time zone of non-UTC datetime columns.\n\nTo set these variables and run the report query:\n\n- Create a new worksheet.\n- Set the database schema and required variables to your desired values.\n\n```\n-- set schema based on the name you gave your Stripe database\nuse schema db_name.stripe;\n-- set financial report template variables\nset (TIMEZONE, START_DATE, END_DATE) = ('UTC', '2021-09-01', '2021-10-01');\n```\n\n#### Caution\n\nRun these lines of code separately before attempting to query tables that\nrequire them. Otherwise, you might receive an error that a session variable\ndoesn’t exist.\n\nIf you’re using the [Snowflake Connector for\nPython](https://docs.snowflake.com/en/user-guide/python-connector.html), set the\nsession parameter `TIMEZONE` with the `ALTER SESSION SET TIMEZONE = 'UTC'`\ncommand.\n- After running the code that sets the necessary variables, query the view of\nthe report you want to generate. For example, running:\n\n```\nselect * from FINANCIAL_REPORT_BALANCE_CHANGE_FROM_ACTIVITY_ITEMIZED;\n```\n\nReturns the same results that the itemized balance change from the activity\nreport displays in the Dashboard or through the API:\n\n!\n\n#### Need support for a different file format?\n\nIf you want to upload files with a different structure or in a custom format,\n[contact us](mailto:data-pipeline@stripe.com).\n\n## Links\n\n- [Snowflake](https://docs.snowflake.com/en/user-guide/intro-regions.html)\n- [Amazon\nRedshift](https://docs.aws.amazon.com/awsconsolehelpdocs/latest/gsg/select-region.html)\n- [refreshes regularly](https://docs.stripe.com/stripe-data/available-data)\n- [Data Pipeline\nsettings](https://dashboard.stripe.com/settings/stripe-data-pipeline)\n- [Account\nIdentifier](https://docs.snowflake.com/en/user-guide/admin-account-identifier.html)\n- [reports](https://docs.stripe.com/stripe-reports)\n- [Snowflake Connector for\nPython](https://docs.snowflake.com/en/user-guide/python-connector.html)",
  "metadata": {
    "title": "Export data to a data warehouse | Stripe Documentation",
    "description": "Automate data exports from Stripe to Snowflake or Redshift.",
    "sourceURL": "https://docs.stripe.com/stripe-data/access-data-in-warehouse/data-warehouses"
  }
}