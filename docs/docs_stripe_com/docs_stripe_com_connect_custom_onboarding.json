{
  "content": "# Onboarding solutions for Custom accounts\n\n## Choose the onboarding method for Custom accounts that suits your business.\n\nStripe offers several ways to onboard Custom connected accounts. You can choose\nthe best onboarding method for your business.\n\n#### Note\n\nWe recommend using Stripe-hosted onboarding or embedded onboarding components.\nBoth automatically update to handle changing requirements when they apply to a\nconnected account. With embedded components, you can [match them to your\nbranding](https://docs.stripe.com/connect/customize-connect-embedded-components)\nand [control which policies and terms are\nshown](https://docs.stripe.com/connect/embedded-onboarding#customize-policies-shown-to-your-users).\n\nMethodProsCons[Stripe-hosted\nonboarding](https://docs.stripe.com/connect/custom/onboarding#stripe-hosted-onboarding)-\nLowest effort integration\n- Stripe-branded with limited platform branding\n- Limited control over the flow logic\n- Connected accounts redirect to Stripe instead of completing the process\nwithout leaving your site\n[Embedded\nonboarding](https://docs.stripe.com/connect/custom/onboarding#embedded-onboarding)-\n[Highly\nthemeable](https://docs.stripe.com/connect/customize-connect-embedded-components)\n- Limited or no Stripe branding\n- Connected accounts remain in the flow of your site\n- Low effort integration\n- Limited control over the flow logic\n[API-based\nonboarding](https://docs.stripe.com/connect/custom/onboarding#api-based-onboarding)\n- Exercise full control over your own UI\n- Expensive and time-consuming to build\n- Continuing high maintenance, especially to keep in compliance with changing\nglobal requirements\n- Can’t resolve Stripe risk reviews\n\n## Stripe hosted onboarding\n\nStripe hosted onboarding allows you to redirect your user to Stripe to complete\nthe onboarding process in a co-branded interface. Create an [Account\nLink](https://docs.stripe.com/api/account_links) and direct your user to the\nhosted onboarding flow. The\n[return_url](https://docs.stripe.com/api/account_links/create#create_account_link-return_url)\nallows Stripe to return the user to your application and allow you to progress\nthe connected account accordingly.\n\nTo integrate Stripe hosted onboarding, follow our [Stripe hosted onboarding\nguide](https://docs.stripe.com/connect/custom/hosted-onboarding).\n\nOnboard new user\n\n[Create Account](https://docs.stripe.com/api/accounts/create)\n\nRe-onboard existing user\n\nCall [Account Retrieve](https://docs.stripe.com/api/accounts/retrieve)\n\nIf `requirements.currently_due` is not empty\n\nRedirect to [hosted\nonboarding](https://docs.stripe.com/connect/custom/hosted-onboarding)\n\n## Embedded onboarding\n\nEmbedded onboarding is a highly themeable onboarding UI with limited Stripe\nbranding. Connected account users interact with the embedded component without\never leaving your application. Embedded onboarding uses the [Accounts\nAPI](https://docs.stripe.com/api/accounts) to read the requirements and generate\nan onboarding form that is localized for all Stripe-supported countries and has\nrobust data validation. In addition, embedded onboarding handles all:\n\n- Business types\n- Configurations of company representatives\n- Verification document uploading\n- Identify verification and statuses\n- International bank accounts\n- Error states\n\nYou can integrate embedded onboarding with a few lines of code, whereas\nAPI-based onboarding requires you to construct custom logic. To integrate\nembedded onboarding, follow our [embedded components\nguide](https://docs.stripe.com/connect/get-started-connect-embedded-components)\nand integrate the [Account\nonboarding](https://docs.stripe.com/connect/supported-embedded-components/account-onboarding)\nembedded component.\n\nOnboard new user\n\n[Create Account](https://docs.stripe.com/api/accounts/create)\n\nRe-onboard existing user\n\nCall [Account Retrieve](https://docs.stripe.com/api/accounts/retrieve)\n\nIf `requirements.currently_due` is not empty\n\nRender the [onboarding\ncomponent](https://docs.stripe.com/connect/supported-embedded-components/account-onboarding)\n\n## API-based onboarding\n\nAPI-based onboarding involves building out each aspect of your site’s onboarding\nuser interface to call the corresponding Stripe APIs. Your integration must\nsatisfy all of Stripe’s onboarding requirements.\n\nOnboard new user\n\nRe-onboard existing user\n\n[Retrieve](https://docs.stripe.com/api/accounts/retrieve) the connected account\n\nShow UI to collect `requirements` from your user\n\n[Create](https://docs.stripe.com/api/accounts/create) a connected account\n\nIf `requirements.currently_due` is not empty\n\nPresent forms to collect information and validate fields\n\nUpdate the connected account with the collected information\n\n### Establish Requirements\n\nThe following factors affect the [onboarding\nrequirements](https://docs.stripe.com/connect/required-verification-information)\nfor your connected accounts:\n\n- The origin country of the connected accounts\n- The [service agreement\ntype](https://docs.stripe.com/connect/service-agreement-types) applicable to the\nconnected accounts\n- The [capabilities](https://docs.stripe.com/connect/account-capabilities)\nrequested for the connected accounts\n- The [business\ntype](https://docs.stripe.com/api/accounts/object#account_object-business_type)\n(for example, individual or company) and\n[company.structure](https://docs.stripe.com/api/accounts/object#account_object-company-structure)\n(for example, public corporation or private partnership)\n\nUse the interactive form to see how changing these factors affects the\nrequirements.\n\n### Requirements form\n\n### Create forms to collect information\n\nAs a best practice, organize the required parameters into logical groupings or\nforms in your onboarding flow. You might wish to encode a mapping between the\nStripe parameters and the logical groupings. Suggested logical groupings for\nparameters are shown in the first column of the example requirements table.\n\nAfter you encode the required parameters into your application, generate UIs for\nthe parameters corresponding to these requirements. For each parameter, design a\nUI form that includes:\n\n- Parameter label, localized to each supported country and language\n- Parameter description, localized to each supported country and language\n- Parameter input fields with data validation logic and document uploading where\nrequired\n\nIt’s important to architect your application logic to account for the\npossibility of additional parameters in the future. For example, Stripe might\nintroduce new parameters, new verifications, or new thresholds that you must\nincorporate into your onboarding flows over time.\n\nChanging any of the factors that determine your connected accounts requirements\nmeans you must also adjust your collection forms.\n[Country](https://docs.stripe.com/api/accounts/object#account_object-country)\nand [service agreement\ntype](https://docs.stripe.com/api/accounts/object#account_object-tos_acceptance-service_agreement)\nare immutable, while\n[capabilities](https://docs.stripe.com/api/accounts/object#account_object-capabilities)\nand [business\ntype](https://docs.stripe.com/api/accounts/object#account_object-business_type)\nare mutable.\n\n- To change an immutable field such as country or service agreement type, create\na new connected account with the new values. Doing so produces new requirements\nfor you to incorporate in your collection flows.\n- To change a mutable field such as capabilities or business type, update the\nconnected account. Doing so produces new requirements for you to incorporate in\nyour collection flows.\n\n### Include Stripe Terms of Service Agreement\n\nYour connected accounts must accept Stripe terms of service before they can be\nactivated. You can [wrap Stripe terms of service in your own terms of\nservice](https://docs.stripe.com/connect/updating-service-agreements#adding-stripes-service-agreement-to-your-terms-of-service).\n\n### Create the Connected Account\n\nUse the [Create Account](https://docs.stripe.com/api/accounts/create) API to\ncreate a connected account with country, service type agreement, desired\ncapabilities, business type, and any other information matching your\n[requirements](https://docs.stripe.com/connect/custom/onboarding#establish-requirements).\nAt a minimum, you must specify `capabilities` and `type`. If you don’t specify\nother parameters, they’re assigned the following default values:\n\n- The service type agreement (`tos_acceptance.service_agreement`) defaults to\n`full`.\n- The `country` defaults to the same country as your platform.\n\nThe following code sample creates a Custom connected account with\n`card_payments` and `transfers` capabilities under a full service agreement for\nan individual.\n\n#### Note\n\nThis example includes only some of the fields you can set when creating an\naccount. For a full list of the fields you can set, such as `address` and\n`website_url`, see the [Create Account API\nreference](https://docs.stripe.com/api/accounts/create).\n\n```\ncurl https://api.stripe.com/v1/accounts \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d country=US \\\n -d type=custom \\\n -d \"capabilities[card_payments][requested]\"=true \\\n -d \"capabilities[transfers][requested]\"=true\n```\n\n### Take your account through the onboarding flow\n\nYou can enable connected accounts in either of two ways:\n\n- Incremental onboarding strategy: Collect the minimum [required\ninformation](https://docs.stripe.com/connect/custom/onboarding#establish-requirements)\nup front and the rest later\n- Upfront onboarding strategy: Collect all information up front\n\nThe incremental onboarding strategy speeds up initial onboarding but requires\nadditional information collection later on. The upfront onboarding strategy\nminimizes enablement disruption throughout the connected account’s lifecycle at\nthe expense of a lengthier application process. You can decide which strategy\nbetter suits your use case.\n\nTo implement your onboarding strategy, inspect the requirements hash of the\nconnected account you created. The requirements hash provides a complete list of\nparameters you must collect to activate the connected account.\n\n- If you choose the incremental onboarding strategy, inspect the `currently_due`\nfield in the requirements hash and build an onboarding flow that only collects\nfor the listed parameters.\n- If you choose the upfront onboarding strategy, inspect the `eventually_due`\nfield in the requirements hash and build an onboarding flow that collects for\nall the listed parameters.\n\n```\n{\n ...\n \"requirements\": {\n \"alternatives\": [],\n \"current_deadline\": null,\n \"currently_due\": [\n \"business_profile.product_description\",\n \"business_profile.support_phone\",\n \"business_profile.url\",\n \"external_account\",\n \"tos_acceptance.date\",\n \"tos_acceptance.ip\"\n ],\n \"disabled_reason\": \"requirements.past_due\",\n \"errors\": [],\n \"eventually_due\": [\n \"business_profile.product_description\",\n \"business_profile.support_phone\",\n \"business_profile.url\",\n \"external_account\",\n \"tos_acceptance.date\",\n \"tos_acceptance.ip\"\n ],\n \"past_due\": [],\n \"pending_verification\": []\n },\n ...\n}\n```\n\n### Update the connected account\n\nUpdate the connected account object with new information as it progresses\nthrough your onboarding flow. Perform an [Update\nAccount](https://docs.stripe.com/api/accounts/update) call, identifying the\nconnected account by the `id` value you stored earlier.\n\n```\ncurl https://api.stripe.com/v1/accounts/{{CONNECTED_ACCOUNT_ID}} \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n --data-urlencode \"business_profile[url]\"=\"https://furever.dev\" \\\n -d \"tos_acceptance[date]\"=1609798905 \\\n -d \"tos_acceptance[ip]\"=\"8.8.8.8\"\n```\n\nStripe validates every update to a connected account. Update the account at each\nstep in onboarding to allow Stripe to validate information as soon as it’s\nadded, while your users continue through the onboarding flow. After Stripe\nconfirms acceptance of our terms of service, any changes to the connected\naccount trigger reverification. For example, if you change the connected\naccount’s name and ID number, Stripe reruns verifications.\n\nWhen updating a connected account, you must handle any [verification\nerrors](https://docs.stripe.com/connect/custom/onboarding#verification-handling)\nor [HTTP error codes](https://docs.stripe.com/error-handling) returned by the\nAccounts API.\n\n## Verification handling\n\nWhen the connected account’s data is submitted, Stripe verifies it. This process\nmight take minutes or hours depending on the nature of the verification\nrequired. During this process, the capabilities you requested have [a pending\nstatus](https://docs.stripe.com/api/accounts/object#account_object-capabilities).\n\n### Review status\n\nYou can retrieve the status of your connected account’s capabilities by:\n\n- Inspecting the Account object’s\n[capabilities](https://docs.stripe.com/api/accounts/object#account_object-capabilities)\nhash for the relevant capability.\n- Requesting capabilities directly from the [Capabilities\nAPI](https://docs.stripe.com/api/capabilities/retrieve) and inspecting the\nstatus of the relevant capability.\n- Listening for `account.updated`\n[events](https://docs.stripe.com/api/events/types#event_types-account.updated)\nin your [webhook](https://docs.stripe.com/connect/webhooks) endpoint and\ninspecting the `capabilities` hash for the relevant capability.\n\nAfter verifications are complete, the capability becomes `active` and available\nto the connected account. Account verifications run continuously, and if a\nfuture verification fails, a capability can transition out of `active`. Listen\nfor `account.updated` events to detect changes to capability states.\n\nConfirm that your Connect integration is compliant and operational by checking\nthat the account’s `charges_enabled` and `payouts_enabled` are both true. You\ncan use the API or listen for `account.updated` events. For details on other\nrelevant fields, check the account’s\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)\nhash. You can’t confirm the integration based on a single value because statuses\ncan vary depending on the application and related policies.\n\n-\n[charges_enabled](https://docs.stripe.com/api/accounts/object#account_object-charges_enabled)\nconfirms that your full charge path including the charge and transfer works\ncorrectly and evaluates if either `card_payments` or `transfers` capabilities\nare active.\n-\n[payouts_enabled](https://docs.stripe.com/api/accounts/object#account_object-payouts_enabled)\nevaluates whether your connected account can pay out to an external account.\nDepending on your risk policies, you can allow your connected account to start\ntransacting without payouts enabled. You [must eventually enable\npayouts](https://docs.stripe.com/connect/manage-payout-schedule) to pay your\nconnected accounts.\n\nYou can use the following logic as a starting point for defining a summary\nstatus to display to your connected account.\n\n```\n# Set your secret key. Remember to switch to your live secret key in production.\n# See your keys here: https://dashboard.stripe.com/apikeys\nStripe.api_key = 'sk_test_BQokikJOvBiI2HlWgH4olfQ2'\n\ndef account_state(account)\n reqs = account.requirements\n\n if reqs.disabled_reason && reqs.disabled_reason.include?(\"rejected\")\n \"rejected\"\n elsif account.payouts_enabled && account.charges_enabled\n if reqs.pending_verification\n \"pending enablement\"\n elsif !reqs.disabled_reason && !reqs.currently_due\n if !reqs.eventually_due\n \"complete\"\n else\n \"enabled\"\n end\n else\n \"restricted\"\n end\n elsif !account.payouts_enabled && account.charges_enabled\n \"restricted (payouts disabled)\"\n elsif !account.charges_enabled && account.payouts_enabled\n \"restricted (charges disabled)\"\n elsif reqs.past_due\n \"restricted (past due)\"\n elsif reqs.pending_verification\n \"pending (disabled)\"\n else\n \"restricted\"\n end\nend\n\naccounts = Stripe::Account.list(limit: 10)\n\naccounts.each do |account|\n puts \"#{account.id} has state: #{account_state(account)}\"\nend\n```\n\n### Handle verification errors\n\nHandle verification failures differently depending on your onboarding flow.\n\n#### Note\n\nYou can’t use the API to respond to Stripe risk reviews. You can enable your\nconnected accounts to respond using embedded components, Stripe-hosted\nonboarding, or remediation links. You can also use the Dashboard to respond to\nrisk reviews on behalf of your connected accounts.\n\nAPIEmbeddedHosted\nListen to the\n[account.updated](https://docs.stripe.com/api/events/types#event_types-account.updated)\nevent. If the account contains any `currently_due` fields when the\n`current_deadline` arrives, the corresponding functionality is disabled and\nthose fields are added to `past_due`.\n\n[Create a\nform](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\nwith clear instructions that the account can use to correct the information.\nNotify the account, then [submit the corrected\ninformation](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\nusing the Accounts API.\n\n[account.updated\nevent](https://docs.stripe.com/api/events/types#event_types-account.updated)\n\nIf `requirements.currently_due` contains fields\n\nDirect account to onboarding in time to finish before\n[current_deadline](https://docs.stripe.com/api/accounts/object#account_object-requirements-current_deadline)\n\nNo action required\n\nIf `requirements.past_due` contains fields\n\nAccount possibly disabled; direct it to onboarding\n\nPresent [dynamically generated\nUI](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\nto collect and validate fields\n\n[Update\naccount](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\nwith fields collected\n\nIf `requirements.currently_due` contains fields\n\nYesNo\nIf you plan to create custom flows to handle all your verification errors:\n\n- Review the details regarding all possible [verification errors and how to\nhandle them](https://docs.stripe.com/connect/handling-api-verification).\n- [Test verification\nstates](https://docs.stripe.com/connect/testing-verification).\n\n## See also\n\nLearn more about working with Custom accounts.\n\n- [Handle verification\nupdates](https://docs.stripe.com/connect/handle-verification-updates)\n- [Updating\nAccounts](https://docs.stripe.com/connect/updating-service-agreements)\n- [Identity Verification](https://docs.stripe.com/connect/identity-verification)\n\n## Links\n\n- [match them to your\nbranding](https://docs.stripe.com/connect/customize-connect-embedded-components)\n- [control which policies and terms are\nshown](https://docs.stripe.com/connect/embedded-onboarding#customize-policies-shown-to-your-users)\n- [Stripe-hosted\nonboarding](https://docs.stripe.com/connect/custom/onboarding#stripe-hosted-onboarding)\n- [Embedded\nonboarding](https://docs.stripe.com/connect/custom/onboarding#embedded-onboarding)\n- [API-based\nonboarding](https://docs.stripe.com/connect/custom/onboarding#api-based-onboarding)\n- [Account Link](https://docs.stripe.com/api/account_links)\n-\n[return_url](https://docs.stripe.com/api/account_links/create#create_account_link-return_url)\n- [Stripe hosted onboarding\nguide](https://docs.stripe.com/connect/custom/hosted-onboarding)\n- [Create Account](https://docs.stripe.com/api/accounts/create)\n- [Account Retrieve](https://docs.stripe.com/api/accounts/retrieve)\n- [Accounts API](https://docs.stripe.com/api/accounts)\n- [embedded components\nguide](https://docs.stripe.com/connect/get-started-connect-embedded-components)\n- [Account\nonboarding](https://docs.stripe.com/connect/supported-embedded-components/account-onboarding)\n- [onboarding\nrequirements](https://docs.stripe.com/connect/required-verification-information)\n- [service agreement\ntype](https://docs.stripe.com/connect/service-agreement-types)\n- [capabilities](https://docs.stripe.com/connect/account-capabilities)\n- [business\ntype](https://docs.stripe.com/api/accounts/object#account_object-business_type)\n-\n[company.structure](https://docs.stripe.com/api/accounts/object#account_object-company-structure)\n- [Country](https://docs.stripe.com/api/accounts/object#account_object-country)\n- [service agreement\ntype](https://docs.stripe.com/api/accounts/object#account_object-tos_acceptance-service_agreement)\n-\n[capabilities](https://docs.stripe.com/api/accounts/object#account_object-capabilities)\n- [wrap Stripe terms of service in your own terms of\nservice](https://docs.stripe.com/connect/updating-service-agreements#adding-stripes-service-agreement-to-your-terms-of-service)\n- [Update Account](https://docs.stripe.com/api/accounts/update)\n- [https://furever.dev](https://furever.dev)\n- [HTTP error codes](https://docs.stripe.com/error-handling)\n- [Capabilities API](https://docs.stripe.com/api/capabilities/retrieve)\n- [events](https://docs.stripe.com/api/events/types#event_types-account.updated)\n- [webhook](https://docs.stripe.com/connect/webhooks)\n-\n[requirements](https://docs.stripe.com/api/accounts/object#account_object-requirements)\n-\n[charges_enabled](https://docs.stripe.com/api/accounts/object#account_object-charges_enabled)\n-\n[payouts_enabled](https://docs.stripe.com/api/accounts/object#account_object-payouts_enabled)\n- [must eventually enable\npayouts](https://docs.stripe.com/connect/manage-payout-schedule)\n- [https://dashboard.stripe.com/apikeys](https://dashboard.stripe.com/apikeys)\n-\n[current_deadline](https://docs.stripe.com/api/accounts/object#account_object-requirements-current_deadline)\n- [dynamically generated\nUI](https://docs.stripe.com/connect/custom/onboarding#create-forms-to-collect-information)\n- [Update\naccount](https://docs.stripe.com/connect/custom/onboarding#update-the-connected-account)\n- [verification errors and how to handle\nthem](https://docs.stripe.com/connect/handling-api-verification)\n- [Test verification\nstates](https://docs.stripe.com/connect/testing-verification)\n- [Handle verification\nupdates](https://docs.stripe.com/connect/handle-verification-updates)\n- [Updating\nAccounts](https://docs.stripe.com/connect/updating-service-agreements)\n- [Identity Verification](https://docs.stripe.com/connect/identity-verification)",
  "metadata": {
    "title": "Onboarding solutions for Custom accounts | Stripe Documentation",
    "description": "Choose the onboarding method for Custom accounts that suits your business.",
    "sourceURL": "https://docs.stripe.com/connect/custom/onboarding"
  }
}