{
  "content": "# Access transactions for a Financial Connections account\n\n## Access an account's transactions with your user's permission.\n\nThe Financial Connections API allows you to retrieve transactions on a\n[Financial Connections\nAccount](https://docs.stripe.com/api/financial_connections/accounts/object). Use\ntransaction data to build a variety of products and solutions, such as:\n\n- Expedite the underwriting process and improve access to credit and other\nfinancial services for your users.\n- Mitigate fraud and reduce risk during user onboarding by evaluating a user’s\ntransaction history, and understanding cash inflows and outflows from their\nfinancial accounts.\n- Help your users track expenses, handle bills, and manage their finances.\n\n## Before you begin\n\nYou must have a completed Financial Connections registration to access\ntransactions in live mode. Check your [Dashboard\nsettings](https://dashboard.stripe.com/settings/financial-connections) to check\nthe state of your registration or begin the registration process. Test mode\nFinancial Connections data is always available.\n\n[Create a\ncustomerRecommendedServer-side](https://docs.stripe.com/financial-connections/transactions#customer)\nWe recommend that you create a [Customer](https://docs.stripe.com/api/customers)\nwith an email address to represent your user, that you then attach to your\npayment. Attaching a Customer object allows you to [list previously linked\naccounts](https://docs.stripe.com/api/financial_connections/accounts/list)\nlater. By providing an email address on the Customer object, Financial\nConnections can improve the authentication flow by streamlining sign-in or\nsign-up for your user, depending on whether they’re a returning\n[Link](https://support.stripe.com/questions/link-for-financial-connections-support-for-businesses)\nuser.\n\n```\ncurl https://api.stripe.com/v1/customers \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d email={{CUSTOMER_EMAIL}}\n```\n\n[Request access to an account's\ntransactionsServer-side](https://docs.stripe.com/financial-connections/transactions#request-access-to-transactions)\nYou must collect an account before you can access its transaction data. To learn\nmore about how to collect Financial Connections Accounts consult the integration\nguide most relevant to your use case: [accept\npayments](https://docs.stripe.com/financial-connections/ach-direct-debit-payments),\n[facilitate Connect\npayouts](https://docs.stripe.com/financial-connections/connect-payouts), or\n[build other-data powered\nproducts](https://docs.stripe.com/financial-connections/other-data-powered-products).\n\nWhen collecting an account, you specify the data you need access to with the\n[permissions](https://docs.stripe.com/financial-connections/fundamentals#data-permissions)\nparameter. The set of requested data permissions are viewable by the user in the\n[authentication\nflow](https://docs.stripe.com/financial-connections/fundamentals#authentication-flow).\nFinancial Connections Accounts are collectible through various integration\npaths, and how you specify the parameter varies slightly by API.\n\nPayment IntentsSetup IntentsSessionsCheckoutInvoicesSubscriptions\n```\ncurl https://api.stripe.com/v1/payment_intents \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d amount=20000 \\\n -d currency=usd \\\n -d customer={{CUSTOMER_ID}} \\\n -d \"payment_method_types[]\"=us_bank_account \\\n-d\n\"payment_method_options[us_bank_account][financial_connections][permissions][]\"=transactions\n\\\n-d\n\"payment_method_options[us_bank_account][financial_connections][permissions][]\"=payment_method\n```\n\nWhen using dynamic payment methods for certain payments APIs, you can also\nconfigure requested permissions in the Dashboard. Learn how to [access\nadditional account data on Financial Connections\naccounts](https://docs.stripe.com/financial-connections/ach-direct-debit-payments?dashboard-or-api=dashboard#access).\n\n[Subscribe to transaction\ndataServer-side](https://docs.stripe.com/financial-connections/transactions#subscribe-to-transactions)\nWhen you subscribe to an account’s transaction data, Stripe automatically\nretrieves new transactions in the background every day and notifies you when\nthey’re available. Subscribing to daily updates is the easiest way to keep the\naccount’s transaction data up to date.\n\nTo get the Financial Connections Account ID you want to subscribe to\ntransactions for, consult the documentation for our [payments\nintegrations](https://docs.stripe.com/financial-connections/ach-direct-debit-payments#finding-the-financial-connections-account-id)\nor check the guide for [Financial Connections\nSessions](https://docs.stripe.com/financial-connections/other-data-powered-products?platform=web#collect-an-account).\n\nSubscribe to transaction data by calling the [subscribe\nAPI](https://docs.stripe.com/api/financial_connections/accounts/subscribe):\n\n```\ncurl\nhttps://api.stripe.com/v1/financial_connections/accounts/{{ACCOUNT_ID}}/subscribe\n\\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d \"features[]\"=transactions\n```\n\n#### Note\n\nSubscriptions aren’t allowed on inactive accounts.\n\nIn addition to activating a subscription to future transaction data, this API\ncall automatically initiates a transaction refresh:\n\n```\n{\n \"id\": \"fca_1LDYuMGxLVUXRs6HW0lrat9T\",\n \"object\": \"financial_connections.account\",\n \"display_name\": \"Savings\",\n \"institution_name\": \"Test Bank\",\n \"status\": \"active\",\n \"permissions\": [\"transactions\"],\n \"subscriptions\": [\"transactions\"],\n \"transaction_refresh\": {\n \"id\": \"fctxnref_1aaaxqEitUZY8Svm4QdcWZKt\",\n \"last_attempted_at\": 1706742786,\n \"next_refresh_available_at\": null,\n \"status\": \"pending\"\n }\n // ...\n}\n```\n\nAs long as you remain subscribed to transaction data, Stripe initiates a new\nrefresh every day.\n\n### Wait for the refresh to complete\n\nAll Financial Connections data refreshes are asynchronous. After you initiate a\ntransaction refresh, you must wait for it to complete, then retrieve the\nresulting transactions.\n\nThe\n[transaction_refresh](https://docs.stripe.com/api/financial_connections/accounts/object#financial_connections_account_object-transaction_refresh)\nfield on a Financial Connections account represents the transaction refresh\nstate. This field remains `null` until you request the `transactions` permission\nand initiate a refresh. After you start a transaction refresh, the state changes\nto `pending`, and after completion, it moves to either `succeeded` or `failed`.\nWe send the\n[financial_connections.account.refreshed_transactions](https://docs.stripe.com/api/events/types#event_types-financial_connections.account.refreshed_transactions)\nevent when the transaction refresh completes. To determine the success of the\nrefresh, check the `transaction_refresh.status` field while handling the\nwebhook.\n\n[Retrieve\ntransactionsServer-side](https://docs.stripe.com/financial-connections/transactions#retrieve-transactions)\nAfter Stripe successfully refreshes transactions on the account, you can\nretrieve them using the [transactions list\nAPI](https://docs.stripe.com/api/financial_connections/transactions/list):\n\n```\ncurl -G https://api.stripe.com/v1/financial_connections/transactions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d account={{ACCOUNT_ID}}\n```\n\nStripe returns a [paginated](https://docs.stripe.com/api/pagination) list of up\nto the last 180 days of transaction history on an account, depending on the\naccount’s financial institution.\n\n```\n{\n \"object\": \"list\",\n \"data\": [\n {\n \"id\": \"fctxn_1LXp9RGxLVUXRs6HtTSVfxse\",\n \"object\": \"financial_connections.transaction\",\n \"account\": \"fca_1LDYuMGxLVUXRs6HW0lrat9T\",\n \"amount\": -1000,\n \"currency\": \"usd\",\n \"description\": \"Rocket Rides\",\n \"livemode\": true,\n \"status\": \"posted\",\n \"status_transitions\": {\n \"posted_at\": 1651784999,\n \"void_at\": null\n },\n \"transacted_at\": 1651784999,\n \"transaction_refresh\": \"fctxnref_1LXp8WGxLVUXRs6Hkc5PNUXf\",\n \"updated\": 1651784999\n },\n {...},\n {...}\n ],\n \"has_more\": false,\n \"url\": \"/v1/financial_connections/transactions\"\n}\n```\n\nThe\n[status](https://docs.stripe.com/api/financial_connections/transactions/object#financial_connections_transaction_object-status)\nof a transaction is one of `pending`, `posted`, or `void`. Information included\nin the\n[description](https://docs.stripe.com/api/financial_connections/transactions/object#financial_connections_transaction_object-description)\nfield varies, but can include metadata such as the business name.\n\n### Retrieving transactions since last refresh\n\nYou might wish to retrieve only new transaction data since your last data pull.\nFor example, some users save previously retrieved transaction data to their\ndatabase, and subsequently merge new or updated data as it becomes available.\n\nTo retrieve only new or updated transaction data since your last refresh, pass\nthe `transaction_refresh` identifier provided by your last observed\n[financial_connections.account.refreshed_transactions](https://docs.stripe.com/api/events/types#event_types-financial_connections.account.refreshed_transactions)\nwebhook event object to the list API:\n\n```\ncurl -G https://api.stripe.com/v1/financial_connections/transactions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d account={{ACCOUNT_ID}} \\\n -d \"transaction_refresh[after]\"=fctxnref_1LXp8WGxLVUXRs6Hkc5PNUXf\n```\n\nThe following is an example\n[webhook](https://docs.stripe.com/webhooks#webhook-endpoint-def) integration\nthat only retrieves and records new or updated transaction data:\n\n```\nimport stripe\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/stripe_webhooks', methods=['POST'])\ndef webhook():\n event = None\n try:\nevent = stripe.Event.construct_from(json.loads(request.data), stripe.api_key)\n except ValueError as e:\n # Invalid payload\n raise e\n\n if event.type == \"financial_connections.account.refreshed_transactions\":\n account = event.data.object\n sync_transactions(account[\"id\"], account[\"transaction_refresh\"][\"id\"])\n\n return jsonify(success=True)\n\ndef sync_transactions(account_id, current_refresh):\n# Fetches the last transaction_refresh observed for this account from internal\ndatabase\nlast_observed_transaction_refresh =\nget_previous_transaction_refresh(key=account_id)\n\n # Get transactions since the last seen transaction_refresh\n response = stripe.financial_connections.Transaction.list(\n account=account_id,\n transaction_refresh={\"after\": last_observed_transaction_refresh},\n )\n\n# We know every transaction is either new or updated because of the\n`transaction_refresh` filter in the list endpoint\n for transaction in response.data:\n record_transaction(transaction) # Saves the transaction to the DB\n\n# Updates the last observed transaction_refresh for this account to the current\nrefresh\n set_previous_transaction_refresh(key=account_id, value=current_refresh)\n```\n\n[OptionalUnsubscribe from transaction\ndata](https://docs.stripe.com/financial-connections/transactions#unsubscribe-from-transaction-data)[OptionalRefresh\ntransactions on\ndemand](https://docs.stripe.com/financial-connections/transactions#refresh-transactions-on-demand)\n\n## Links\n\n- [Financial Connections\nAccount](https://docs.stripe.com/api/financial_connections/accounts/object)\n- [Dashboard\nsettings](https://dashboard.stripe.com/settings/financial-connections)\n- [Customer](https://docs.stripe.com/api/customers)\n- [list previously linked\naccounts](https://docs.stripe.com/api/financial_connections/accounts/list)\n-\n[Link](https://support.stripe.com/questions/link-for-financial-connections-support-for-businesses)\n- [accept\npayments](https://docs.stripe.com/financial-connections/ach-direct-debit-payments)\n- [facilitate Connect\npayouts](https://docs.stripe.com/financial-connections/connect-payouts)\n- [build other-data powered\nproducts](https://docs.stripe.com/financial-connections/other-data-powered-products)\n-\n[permissions](https://docs.stripe.com/financial-connections/fundamentals#data-permissions)\n- [authentication\nflow](https://docs.stripe.com/financial-connections/fundamentals#authentication-flow)\n- [access additional account data on Financial Connections\naccounts](https://docs.stripe.com/financial-connections/ach-direct-debit-payments?dashboard-or-api=dashboard#access)\n- [payments\nintegrations](https://docs.stripe.com/financial-connections/ach-direct-debit-payments#finding-the-financial-connections-account-id)\n- [Financial Connections\nSessions](https://docs.stripe.com/financial-connections/other-data-powered-products?platform=web#collect-an-account)\n- [subscribe\nAPI](https://docs.stripe.com/api/financial_connections/accounts/subscribe)\n-\n[transaction_refresh](https://docs.stripe.com/api/financial_connections/accounts/object#financial_connections_account_object-transaction_refresh)\n-\n[financial_connections.account.refreshed_transactions](https://docs.stripe.com/api/events/types#event_types-financial_connections.account.refreshed_transactions)\n- [transactions list\nAPI](https://docs.stripe.com/api/financial_connections/transactions/list)\n- [paginated](https://docs.stripe.com/api/pagination)\n-\n[status](https://docs.stripe.com/api/financial_connections/transactions/object#financial_connections_transaction_object-status)\n-\n[description](https://docs.stripe.com/api/financial_connections/transactions/object#financial_connections_transaction_object-description)\n- [webhook](https://docs.stripe.com/webhooks#webhook-endpoint-def)",
  "metadata": {
    "title": "Access transactions for a Financial Connections account | Stripe Documentation",
    "description": "Access an account's transactions with your user's permission.",
    "sourceURL": "https://docs.stripe.com/financial-connections/transactions"
  }
}