{
  "content": "# Deep links in the customer portal\n\n## Design streamlined customer flows with the customer portal API.\n\nWith the [customer portal](https://docs.stripe.com/customer-management), you can\nprovide subscription and payment method management to your customers without\nbuilding it yourself. If you want to streamline customer actions and further\ncustomize workflows between your own app and Stripe, you can create a customer\nportal\n[flow](https://docs.stripe.com/api/customer_portal/session#portal_session_object-flow).\n\n## Customer portal flows\n\nA *flow* is a customizable deep link into the customer portal. Portal flows\nallow you to:\n\n- Deep link directly to the page with the specified action for your customer to\ncomplete. al components to access the rest of the customer portal are\nhidden so the customer can focus on the single action.\n- Customize the redirect behavior after the customer completes the\naction—redirect them immediately to your own URL, to a hosted confirmation page,\nor back to the portal homepage.\n- Personalize the flow with unique options like prefilled promotion codes or\ncustom messages.\n\n### Flow types\n\nA flow’s\n[type](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data-type)\ndefines what single flow or action your customer will complete. Below are the\ncurrently available flow types:\n\nFlow typeDescriptionExample`payment_method_update`Use `payment_method_update` to\nlet your customer add a new payment method. The payment method is set as the\n`customer.invoice_settings.default_payment_method`.\n\n![Example of payment method update\nflow](https://b.stripecdn.com/docs-statics-srv/assets/payment_method_update.6f92b4642ce28020952f263360c83014.png)\n\nPayment method update flow\n\n`subscription_cancel`\n\nUse `subscription_cancel` to let your customer cancel a specific subscription.\n\nYou can customize whether the subscription cancels immediately or at the end of\nthe period by updating your portal configuration through the\n[API](https://docs.stripe.com/api/customer_portal/configuration#portal_configuration_object-features-subscription_cancel-mode)\nor the [Dashboard](https://dashboard.stripe.com/test/settings/billing/portal).\n\n![Example of subscription cancel\nflow](https://b.stripecdn.com/docs-statics-srv/assets/subscription_cancel.6943958d0358b97241a1f4d2703d3bfb.png)\n\nSubscription cancel flow\n\n`subscription_update`\n\nUse `subscription_update` to let your customer select different update options\nsuch as upgrading or downgrading to another plan or updating the current plan\nquantity.\n\nYou can customize the available plans by updating your portal configuration\nthrough the\n[API](https://docs.stripe.com/api/customer_portal/configuration#portal_configuration_object-features-subscription_update-products)\nor the [Dashboard](https://dashboard.stripe.com/test/settings/billing/portal).\n\n![Example of subscription update\nflow](https://b.stripecdn.com/docs-statics-srv/assets/subscription_update.8426206cdf98ba10d04680b782644b67.png)\n\nSubscription update flow\n\n`subscription_update_confirm`\n\nUse `subscription_update_confirm` to let your customer confirm a specific update\nto their subscription.\n\nYou can use this option when you have your own pricing page but want to offload\nthe work of displaying update details such as upcoming invoice and prorations,\nhandling payment failures, or handling [3D Secure\nauthentication](https://docs.stripe.com/payments/3d-secure).\n\nYou can also specify a coupon or promotion code to apply on the subscription\nupdate. You could use this for promotional campaigns when you offer a discount\nfor switching to another plan.\n\n![Example of subscription update confirm\nflow](https://b.stripecdn.com/docs-statics-srv/assets/subscription_update_confirm.5a06b658cc8a15971fdfae54fc7708da.png)\n\nSubscription update confirm flow\n\n[Create a\nflow](https://docs.stripe.com/customer-management/portal-deep-links#create-a-flow)\n#### Note\n\nCustomer portal flows are an extension to the [customer portal\nAPI](https://docs.stripe.com/api/customer_portal/sessions/create). First follow\nthe general guide to [integrate the customer portal with the\nAPI](https://docs.stripe.com/customer-management/integrate-customer-portal)\nbefore using this guide.\n\nTo create a flow, specify\n[flow_data](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data)\nwhen you create a portal session.\n\nSet the\n[type](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data-type)\nof flow you want your customer to complete. Depending on the flow `type`, you\nmight need to pass in additional data such as a subscription ID.\n\nBelow are examples on how to set up each flow type.\n\nPayment method updateSubscription cancelSubscription updateSubscription update\nconfirm\n```\ncurl https://api.stripe.com/v1/billing_portal/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d customer={{CUSTOMER_ID}} \\\n --data-urlencode return_url=\"https://example.com/account/overview\" \\\n -d \"flow_data[type]\"=payment_method_update\n```\n\nThe portal session `url` for the response now deep links into the flow you\ncreated. Use that URL to redirect customers to the portal flow from your site.\n\n[Customize after completion\nbehavior](https://docs.stripe.com/customer-management/portal-deep-links#customize-after-completion)\nAfter your customer successfully completes the flow, they see a localized\nconfirmation page that shows the details of their completed update. You can\ncustomize the confirmation message on this page, redirect to a URL of your\nchoice, or redirect them back to the customer portal homepage where their full\naccount details are visible.\n\nTo customize this behavior, set\n[after_completion](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data-after_completion)\non `flow_data`.\n\nThe following example lets your customer cancel their subscription, and redirect\nback to your own site afterwards:\n\n```\ncurl https://api.stripe.com/v1/billing_portal/sessions \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -d customer={{CUSTOMER_ID}} \\\n --data-urlencode return_url=\"https://example.com/account/overview\" \\\n -d \"flow_data[type]\"=subscription_cancel \\\n -d \"flow_data[subscription_cancel][subscription]\"={{SUBSCRIPTION_ID}} \\\n -d \"flow_data[after_completion][type]\"=redirect \\\n--data-urlencode\n\"flow_data[after_completion][redirect][return_url]\"=\"https://example.com/account/subscription_canceled\"\n```\n\n#### Note\n\nThe top level `return_url` is a link back to your website that the customer can\nclick at any time (if they decide not to cancel, for example). The\n`flow_data[after_completion][redirect][return_url]` is a link back to your\nwebsite after a customer successfully cancels their subscription.\n\n## Links\n\n- [customer portal](https://docs.stripe.com/customer-management)\n-\n[flow](https://docs.stripe.com/api/customer_portal/session#portal_session_object-flow)\n-\n[type](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data-type)\n-\n[API](https://docs.stripe.com/api/customer_portal/configuration#portal_configuration_object-features-subscription_cancel-mode)\n- [Dashboard](https://dashboard.stripe.com/test/settings/billing/portal)\n-\n[API](https://docs.stripe.com/api/customer_portal/configuration#portal_configuration_object-features-subscription_update-products)\n- [3D Secure authentication](https://docs.stripe.com/payments/3d-secure)\n- [customer portal\nAPI](https://docs.stripe.com/api/customer_portal/sessions/create)\n- [integrate the customer portal with the\nAPI](https://docs.stripe.com/customer-management/integrate-customer-portal)\n-\n[flow_data](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data)\n- [https://example.com/account/overview](https://example.com/account/overview)\n-\n[after_completion](https://docs.stripe.com/api/customer_portal/sessions/create#create_portal_session-flow_data-after_completion)\n-\n[https://example.com/account/subscription_canceled](https://example.com/account/subscription_canceled)",
  "metadata": {
    "title": "Deep links in the customer portal | Stripe Documentation",
    "description": "Design streamlined customer flows with the customer portal API.",
    "sourceURL": "https://docs.stripe.com/customer-management/portal-deep-links"
  }
}