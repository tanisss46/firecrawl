{
  "content": "# Working with SetupIntents, PaymentMethods, and BankAccounts\n\n## Set up money movements in Treasury.\n\nYou can use\n[PaymentMethod](https://docs.stripe.com/payments/payment-methods#payment-method-object)\nobjects to save account credentials for a US-based bank account for future use.\nAfter creating the `PaymentMethod`, you can use the same object repeatedly to\nmove funds into and out of a financial account. Depending on your use case, you\ncan attach the `PaymentMethod` to either a\n[Customer](https://docs.stripe.com/api/customers) object or the Stripe account.\n\n- Attach the `PaymentMethod` to a `Customer` object if you intend to use the\npayment method for an outbound payment to a third party.\n- Attach the `PaymentMethod` to a connected account or platform account if you\nintend to use the payment method for an inbound transfer or outbound transfer\nbetween an external account that belongs to the same business as the Stripe\naccount.\n\n#### Note\n\nThe `Customer` object defines a third-party entity that represents the owner of\nan external bank account.\n\nIf you previously collected customer payment details with Stripe using the\n[BankAccounts](https://docs.stripe.com/ach-deprecated) object, you can\nsubstitute the `BankAccount` for a `PaymentMethod` in those requests. For\n`InboundTransfers`, the `BankAccount` `status` value in this case must be\n`verified`. We recommend using `PaymentMethods` where possible to get the full\nsuite of features.\n\nIn some cases, banks on the receiving end of ACH money movements notify Stripe\nthat account information (such as account number or routing number) has changed.\nIf we receive such a notification for an account associated with a\n`PaymentMethod` or `BankAccount` object, we automatically update the object. See\nthe [ACH Notification of Change\nhandling](https://docs.stripe.com/treasury/moving-money/notification-of-change)\nguide for more information.\n\n## Create a SetupIntent to save us_bank_account details\n\n[SetupIntents](https://docs.stripe.com/payments/setup-intents) enable you to set\nup a payment method to use with money movement endpoints of the Stripe API. Use\n`SetupIntents` to save customer or account credentials as a payment method and\noptimize them for the objects you intend to use it with. For example, when\nsetting up a US bank account, it’s necessary to verify the bank account if you\nintend to debit that external account with an inbound transfer. Stripe updates\nthe `SetupIntent` object throughout the setup process.\n\nThe following example demonstrates using a `SetupIntent` with a bank account\nthat allows for bidirectional fund transfers. For complete details on how to set\nup a payment method for creating payments and bank account verification, see the\n[Save details for future payments with ACH Direct\nDebit](https://docs.stripe.com/payments/ach-direct-debit/set-up-payment) guide.\nWhen setting up payment methods for managing financial account funds with\n`SetupIntents`, the following fields are the most relevant:\n\n-\n[flow_directions](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-flow_directions):\nthis array defines the directionality of the flows for a payment method. Its\npossible values are `inbound` and `outbound`, denoting whether the payment\nmethod can move funds into, out of, or both into and out of a financial account.\nYou can also configure an existing payment method to become bidirectional.\n-\n[attach_to_self](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-attach_to_self):\na Boolean flag to indicate whether you want to attach this payment method to the\nin-context `Account` object. Set this value to true to create an\naccount-attached payment method for managing this account’s own money movement\nflows such as inbound transfers and outbound transfers.\n-\n[customer](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-confirm):\nID of the `Customer` object the payment method is attached to on successful\nsetup. You can use `Customer`-attached payment methods with outbound payments to\nsend money to third parties and customers. You can also use them with Stripe\nPayments `PaymentIntents` to receive money. You must set the `attach_to_self`\nattribute to false or leave it blank when creating a customer-attached payment\nmethod.\n\n### Permissions\n\nTo use a payment method for ‘inbound’ flow directions (such as\n`InboundTransfers`), you need [permission from the account\nholder](https://docs.stripe.com/payments/setup-intents#mandates). Creating this\nagreement (`Mandate` object) up front and associating it with the payment method\nallows you to charge the payment method later.\n\nAdd terms to your website or app that state how you plan to debit funds from\nexternal accounts, and let connected accounts opt in. At a minimum, make sure\nthat your terms cover the following:\n\n- Connected account permission for you to initiate a debit or a series of debits\non their behalf\n- The anticipated frequency of debits (one-time or recurring)\n- How the debit amount is determined\n\nWhile you need a mandate to debit an external bank account in the US with\ninbound transfers, you don’t need it to send money to a bank account with\noutbound transfers or outbound payments.\n\n### Creating a SetupIntent\n\nTo create a `SetupIntent`, you must either use an existing payment method with\nthe `payment_method` parameter, or provide new credentials using the inline\n`payment_method_data` parameter.\n\nUse `POST /v1/setup_intents` to create a `SetupIntent`.\n\n```\ncurl https://api.stripe.com/v1/setup_intents \\\n -u \"sk_test_BQokikJOvBiI2HlWgH4olfQ2:\" \\\n -H \"Stripe-Account: {{CONNECTED_ACCOUNT_ID}}\" \\\n -d payment_method={{PAYMENT_METHOD_ID}}\n```\n\nIf successful, the response returns the newly created `SetupIntent` object.\n\n```\n{\n // ID of the Customer to attach the resulting PaymentMethod to\n \"customer\": \"{{CUSTOMER_ID}}\",\n \"attach_to_self\": false,\n // Configure what direction of funds flows this PaymentMethod will support.\n \"flow_directions\": [\"inbound\", \"outbound\"],\n // US Bank Account credentials\n \"payment_method_types\": [\"us_bank_account\"],\n \"payment_method_data\": {\n \"type\": \"us_bank_account\",\n```\n\nSee all 48 lines\nThe `SetupIntent` has one of the following statuses:\n\nSTATUSDESCRIPTIONNEXT STEPS`succeeded`The bank account has been instantly\nverified or verification isn’t necessary.No action\nneeded.`requires_action`Further action needed to complete bank account\nverification.See `next_action` for further setup steps.\nAfter successfully confirming the `SetupIntent`, Stripe sends an email\nconfirmation of the mandate and collected bank account details to your connected\naccount. The default email references Stripe Payments, so if you use Stripe\nTreasury without Stripe Payments, you might want to turn off Stripe emails and\nsend [custom\nmessages](https://docs.stripe.com/payments/ach-direct-debit#mandate-and-microdeposit-emails)\ninstead.\n\n## Links\n\n-\n[PaymentMethod](https://docs.stripe.com/payments/payment-methods#payment-method-object)\n- [Customer](https://docs.stripe.com/api/customers)\n- [BankAccounts](https://docs.stripe.com/ach-deprecated)\n- [ACH Notification of Change\nhandling](https://docs.stripe.com/treasury/moving-money/notification-of-change)\n- [SetupIntents](https://docs.stripe.com/payments/setup-intents)\n- [Save details for future payments with ACH Direct\nDebit](https://docs.stripe.com/payments/ach-direct-debit/set-up-payment)\n-\n[flow_directions](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-flow_directions)\n-\n[attach_to_self](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-attach_to_self)\n-\n[customer](https://docs.stripe.com/api/setup_intents/create#create_setup_intent-confirm)\n- [permission from the account\nholder](https://docs.stripe.com/payments/setup-intents#mandates)\n- [custom\nmessages](https://docs.stripe.com/payments/ach-direct-debit#mandate-and-microdeposit-emails)",
  "metadata": {
    "title": "Working with SetupIntents, PaymentMethods, and BankAccounts | Stripe Documentation",
    "description": "Set up money movements in Treasury.",
    "sourceURL": "https://docs.stripe.com/treasury/moving-money/working-with-bankaccount-objects"
  }
}