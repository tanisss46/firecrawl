{
  "content": "# Card payments without bank authentication\n\n## Build a simpler mobile integration with regional limitations.\n\niOSAndroidReact Native\nThis integration supports businesses accepting only US and Canadian cards. It’s\nsimpler up front, but does not scale to support a global customer base.\n\n### How does this integration work?\n\n### How does it compare to the global integration?\n\nGrowing or global businesses should use Stripe’s [global\nintegration](https://docs.stripe.com/payments/accept-a-payment) to support bank\nrequests for two-factor authentication and allow customers to pay with more\npayment methods.\n\n[Install the Stripe iOS\nSDKClient-side](https://docs.stripe.com/payments/mobile/without-card-authentication#ios-install-sdk)\nFirst, you need a Stripe account. [Register\nnow](https://dashboard.stripe.com/register).\n\nThe [Stripe iOS SDK](https://github.com/stripe/stripe-ios) is open source,\n[fully documented](https://stripe.dev/stripe-ios/index.html), and compatible\nwith apps supporting iOS 13 or above.\n\nSwift Package ManagerCocoaPodsCarthageManual Framework\nTo install the SDK, follow these steps:\n\n- In Xcode, select **File** > **Add Package Dependencies…** and enter\n`https://github.com/stripe/stripe-ios-spm` as the repository URL.\n- Select the latest version number from our [releases\npage](https://github.com/stripe/stripe-ios/releases).\n- Add the **StripePaymentsUI** product to the [target of your\napp](https://developer.apple.com/documentation/swift_packages/adding_package_dependencies_to_your_app).\n\n#### Note\n\nFor details on the latest SDK release and past versions, see the\n[Releases](https://github.com/stripe/stripe-ios/releases) page on GitHub. To\nreceive notifications when a new release is published, [watch\nreleases](https://help.github.com/en/articles/watching-and-unwatching-releases-for-a-repository#watching-releases-for-a-repository)\nfor the repository.\n\nConfigure the SDK with your Stripe [publishable\nkey](https://dashboard.stripe.com/test/apikeys) on app start. This enables your\napp to make requests to the Stripe API.\n\n```\nimport UIKit\nimport StripePaymentsUI\n\n@main\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\nfunc application(_ application: UIApplication, didFinishLaunchingWithOptions\nlaunchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n StripeAPI.defaultPublishableKey = \"pk_test_TYooMQauvdEDq54NiTphI7jx\"\n // do any other necessary launch configuration\n return true\n }\n}\n```\n\n#### Note\n\nUse your [test mode](https://docs.stripe.com/keys#obtain-api-keys) keys while\nyou test and develop, and your [live\nmode](https://docs.stripe.com/keys#test-live-modes) keys when you publish your\napp.\n\n[Collect card\ndetailsClient-side](https://docs.stripe.com/payments/mobile/without-card-authentication#ios-collect-payment-details)\nSecurely collect card information on the client with\n[STPPaymentCardTextField](https://stripe.dev/stripe-ios/stripe-payments-ui/Classes/STPPaymentCardTextField.html),\na drop-in UI component provided by the SDK that collects the card number,\nexpiration date, CVC, and postal code.\n\n[STPPaymentCardTextField](https://stripe.dev/stripe-ios/stripe-payments-ui/Classes/STPPaymentCardTextField.html)\nperforms on-the-fly validation and formatting.\n\nCreate an instance of the card component and a **Pay** button with the following\ncode:\n\n```\nimport UIKit\nimport StripePaymentsUI\n\nclass CheckoutViewController: UIViewController {\n\n lazy var cardTextField: STPPaymentCardTextField = {\n let cardTextField = STPPaymentCardTextField()\n return cardTextField\n }()\n lazy var payButton: UIButton = {\n let button = UIButton(type: .custom)\n button.layer.cornerRadius = 5\n button.backgroundColor = .systemBlue\n button.titleLabel?.font = UIFont.systemFont(ofSize: 22)\n button.setTitle(\"Pay\", for: .normal)\n button.addTarget(self, action: #selector(pay), for: .touchUpInside)\n return button\n }()\n\n override func viewDidLoad() {\n super.viewDidLoad()\n view.backgroundColor = .white\nlet stackView = UIStackView(arrangedSubviews: [cardTextField, payButton])\n stackView.axis = .vertical\n stackView.spacing = 20\n stackView.translatesAutoresizingMaskIntoConstraints = false\n view.addSubview(stackView)\n NSLayoutConstraint.activate([\nstackView.leftAnchor.constraint(equalToSystemSpacingAfter: view.leftAnchor,\nmultiplier: 2),\nview.rightAnchor.constraint(equalToSystemSpacingAfter: stackView.rightAnchor,\nmultiplier: 2),\nstackView.topAnchor.constraint(equalToSystemSpacingBelow:\nview.safeAreaLayoutGuide.topAnchor, multiplier: 2),\n ])\n }\n\n @objc\n func pay() {\n // ...\n }\n}\n```\n\nRun your app and make sure your checkout page shows the card component. When the\ncustomer taps **Pay**, call\n[createPaymentMethod](https://stripe.dev/stripe-ios/stripe-payments/Classes/STPAPIClient.html#/c:@CM@StripePayments@StripeCore@objc(cs)STPAPIClient(im)createPaymentMethodWithPayment:completion:)\nto collect the card details and create a\n[PaymentMethod](https://docs.stripe.com/api/payment_methods). Send the ID of the\nPaymentMethod to your server.\n\n```\nfunc pay() {\n // Create a PaymentMethod with the card text field's card details\nSTPAPIClient.shared.createPaymentMethod(with: cardTextField.paymentMethodParams)\n{ (paymentMethod, error) in\n guard let paymentMethod = paymentMethod else {\n // Display the error to the customer\n return\n }\n let paymentMethodID = paymentMethod.stripeId\n // Send paymentMethodID to your server for the next step\n }\n}\n```\n\n[Make a\npaymentServer-side](https://docs.stripe.com/payments/mobile/without-card-authentication#ios-create-payment-intent)\nSet up an endpoint on your server to receive the request from the client. Use\nthe official libraries for access to the Stripe API from your server:\n\n```\n# Available as a gem\nsudo gem install stripe\n```\n\n```\n# If you use bundler, you can add this line to your Gemfile\ngem 'stripe'\n```\n\nStripe uses a [PaymentIntent](https://docs.stripe.com/api/payment_intents)\nobject to represent your intent to collect payment from a customer, tracking\ncharge attempts and payment state changes throughout the process.\n\nCreate an HTTP endpoint to respond to the request from step 2. In that endpoint,\nyou should decide how much to charge the customer. To create a payment, create a\nPaymentIntent using the PaymentMethod ID from step 2 with the following\nparameters:\n\nAlways decide how much to charge on the server, a trusted environment, as\nopposed to the client. This prevents malicious customers from being able to\nchoose their own prices.\n\n```\n# Check the status of the PaymentIntent to make sure it succeeded\n\ncurl https://api.stripe.com/v1/payment_intents \\\n -u sk_test_BQokikJOvBiI2HlWgH4olfQ2: \\\n -d amount=1099 \\\n -d currency=usd \\\n\n# A PaymentIntent can be confirmed some time after creation,\n# but here we want to confirm (collect payment) immediately.\n -d confirm=true \\\n -d payment_method=\"{{PAYMENT_METHOD_ID}}\" \\\n\n# If the payment requires any follow-up actions from the\n# customer, like two-factor authentication, Stripe will error\n# and you will need to prompt them for a new payment method.\n -d error_on_requires_action=true\n```\n\n#### Warning\n\nIf you set\n[error_on_requires_action](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-error_on_requires_action)\nto `true` when confirming a payment, Stripe automatically fails the payment if\nit requires two-factor authentication from the user.\n\n#### Payment Intents API response\n\nWhen you make a payment with the API, the response includes a status of the\nPaymentIntent. If the payment was successful, it will have a status of\n`succeeded`.\n\n```\n{\n \"id\": \"pi_0FdpcX589O8KAxCGR6tGNyWj\",\n \"object\": \"payment_intent\",\n \"amount\": 1099,\n \"charges\": {\n \"object\": \"list\",\n \"data\": [\n {\n \"id\": \"ch_GA9w4aF29fYajT\",\n \"object\": \"charge\",\n \"amount\": 1099,\n \"refunded\": false,\n \"status\": \"succeeded\",\n }\n ]\n },\n\"client_secret\": \"pi_0FdpcX589O8KAxCGR6tGNyWj_secret_e00tjcVrSv2tjjufYqPNZBKZc\",\n \"currency\": \"usd\",\n \"last_payment_error\": null,\n \"status\": \"succeeded\",\n}\n```\n\nIf the payment is declined, the response includes the error code and error\nmessage. Here’s an example of a payment that failed because two-factor\nauthentication was required for the card.\n\n```\n{\n \"error\": {\n \"code\": \"authentication_required\",\n \"decline_code\": \"authentication_not_handled\",\n \"doc_url\": \"https://docs.stripe.com/error-codes#authentication-required\",\n\"message\": \"This payment required an authentication action to complete, but\n`error_on_requires_action` was set. When you're ready, you can upgrade your\nintegration to handle actions at\nhttps://stripe.com/docs/payments/payment-intents/upgrade-to-handle-actions.\",\n \"payment_intent\": {\n \"id\": \"pi_1G8JtxDpqHItWkFAnB32FhtI\",\n \"object\": \"payment_intent\",\n \"amount\": 1099,\n \"status\": \"requires_payment_method\",\n \"last_payment_error\": {\n \"code\": \"authentication_required\",\n \"decline_code\": \"authentication_not_handled\",\n\"doc_url\": \"https://docs.stripe.com/error-codes#authentication-required\",\n\"message\": \"This payment required an authentication action to complete, but\n`error_on_requires_action` was set. When you're ready, you can upgrade your\nintegration to handle actions at\nhttps://stripe.com/docs/payments/payment-intents/upgrade-to-handle-actions.\",\n \"type\": \"card_error\"\n },\n },\n \"type\": \"card_error\"\n }\n}\n```\n\n[Test the\nintegration](https://docs.stripe.com/payments/mobile/without-card-authentication#ios-test)\nThere are several test cards you can use in test mode to make sure this\nintegration is ready. Use them with any CVC, postal code, and future expiration\ndate.\n\nNumberDescription4242424242424242Succeeds and immediately processes the\npayment.4000000000009995Always fails with a decline code of\n`insufficient_funds`.4000002500003155Requires authentication, which in this\nintegration will fail with a decline code of `authentication_not_handled`.\nSee the full list of [test cards](https://docs.stripe.com/testing).\n\n[Upgrade your integration to handle card\nauthentication](https://docs.stripe.com/payments/mobile/without-card-authentication#ios-upgrade-to-handle-card-authentication)\nCongratulations! You completed a payments integration for basic card payments.\nNote that this integration **declines cards that require authentication during\npayment**.\n\nIf you start seeing payments in the Dashboard listed as `Failed`, then it’s time\nto [upgrade your\nintegration](https://docs.stripe.com/payments/payment-intents/upgrade-to-handle-actions).\nStripe’s global integration handles these payments instead of automatically\ndeclining them.\n\n## Links\n\n- [global integration](https://docs.stripe.com/payments/accept-a-payment)\n- [Register now](https://dashboard.stripe.com/register)\n- [Stripe iOS SDK](https://github.com/stripe/stripe-ios)\n- [fully documented](https://stripe.dev/stripe-ios/index.html)\n- [releases page](https://github.com/stripe/stripe-ios/releases)\n- [target of your\napp](https://developer.apple.com/documentation/swift_packages/adding_package_dependencies_to_your_app)\n- [watch\nreleases](https://help.github.com/en/articles/watching-and-unwatching-releases-for-a-repository#watching-releases-for-a-repository)\n- [publishable key](https://dashboard.stripe.com/test/apikeys)\n- [test mode](https://docs.stripe.com/keys#obtain-api-keys)\n- [live mode](https://docs.stripe.com/keys#test-live-modes)\n-\n[STPPaymentCardTextField](https://stripe.dev/stripe-ios/stripe-payments-ui/Classes/STPPaymentCardTextField.html)\n-\n[createPaymentMethod](https://stripe.dev/stripe-ios/stripe-payments/Classes/STPAPIClient.html#/c:@CM@StripePayments@StripeCore@objc(cs)STPAPIClient(im)createPaymentMethodWithPayment:completion:)\n- [PaymentMethod](https://docs.stripe.com/api/payment_methods)\n- [PaymentIntent](https://docs.stripe.com/api/payment_intents)\n-\n[error_on_requires_action](https://docs.stripe.com/api/payment_intents/create#create_payment_intent-error_on_requires_action)\n-\n[https://docs.stripe.com/error-codes#authentication-required](https://docs.stripe.com/error-codes#authentication-required)\n-\n[https://stripe.com/docs/payments/payment-intents/upgrade-to-handle-actions.](https://stripe.com/docs/payments/payment-intents/upgrade-to-handle-actions)\n- [test cards](https://docs.stripe.com/testing)\n- [upgrade your\nintegration](https://docs.stripe.com/payments/payment-intents/upgrade-to-handle-actions)",
  "metadata": {
    "title": "Card payments without bank authentication | Stripe Documentation",
    "description": "Build a simpler mobile integration with regional limitations.",
    "sourceURL": "https://docs.stripe.com/payments/mobile/without-card-authentication"
  }
}