{
  "content": "# Masterpass guideDeprecated\n\n## Accept payments via Masterpass in your existing Stripe integration.\n\n#### Warning\n\nMastercard plans to deprecate Masterpass in favor of [Secure Remote\nCommerce](https://docs.stripe.com/secure-remote-commerce), which delivers\nunified online checkout supporting a number of card brands. Stripe doesn’t\nsupport new Masterpass integrations and existing integrations must migrate to\nSecure Remote Commerce as soon as possible.\n\nMasterpass is a third-party service that stores payment and shipping information\nfor its users in order to streamline the checkout process. Instead of entering\npayment information on your checkout page, users can click the Masterpass button\ninstead. Your Stripe integration receives a unique transaction ID that it can\nuse to create a charge against the payment information stored in the user’s\nMasterpass account.\n\n## Integrating the Masterpass button\n\nTo get started, generate your Masterpass **Checkout ID** in the\n[Dashboard](https://dashboard.stripe.com/account/payments/settings) and\nconfigure your sandbox and production callback URLs.\n\nTo use Masterpass on your website, add the following script tag to your HTML\ndocument:\n\nSandboxProduction\n```\n<script type=\"text/javascript\"\nsrc=\"https://sandbox.masterpass.com/integration/merchant.js\"></script>\n```\n\nTo display the Masterpass button, use the following image:\n\n```\n<img id=\"mpbutton\"\nsrc=\"https://static.masterpass.com/dyn/img/btn/global/mp_chk_btn_147x034px.svg\"/>\n```\n\nAttach a click handler to the image and use it to invoke the\n`masterpass.checkout` function with the desired parameters:\n\n```\nlet button = document.getElementById(\"mpbutton\");\n\nbutton.addEventListener(\"click\", ev =>\n masterpass.checkout({\n checkoutId: \"{MASTERPASS_CHECKOUT_ID}\",\n allowedCardTypes: [\"master\", \"amex\", \"visa\"],\n amount: \"10.00\",\n currency: \"USD\",\n cartId: \"{UNIQUE_ID}\",\n callbackUrl: \"{CALLBACK_URL}\"\n }));\n```\n\nThe `masterpass.checkout` function requires the following parameters:\n\nParameterDescription`checkoutId`The Checkout ID for your Masterpass project,\ncopied from the\n[Dashboard](https://dashboard.stripe.com/account/payments/settings)`allowedCardTypes`A\nlist of the Masterpass-compatible payment providers that you want to\nsupport`amount`The amount of the transaction, expressed in decimal\nformat`currency`The currency in which to perform the transaction`cartId`A unique\nstring that you generate to identify the purchase`callbackUrl`(Optional)\nOverrides the default `callbackUrl` configured when activating Masterpass.\nFor more details about the `masterpass.checkout` function and the parameters\nthat it accepts,\n[refer](https://developer.mastercard.com/documentation/masterpass-merchant-integration-v7/7#standard-checkout1)\nto Mastercard’s documentation.\n\n## Completing the payment\n\nWhen the user clicks the Masterpass button on your checkout page, it takes them\nto the Masterpass website where they can select an existing payment method from\ntheir account or input a new one. When the user completes the process,\nMasterpass redirects them to the callback URL that you configured when\nactivating Masterpass, or the specified callback URL when invoking\n`masterpass.checkout` function. It appends an `oauth_verifier` URL query\nparameter that your application can use to complete the transaction.\n\nIn the route handler for the redirect destination, extract the URL query\nparameter and use it to\n[confirm](https://docs.stripe.com/api/payment_intents/confirm) the\n[PaymentIntent](https://docs.stripe.com/api/payment_intents) that you have\ncreated at the beginning of the checkout flow. See [accept a\npayment](https://docs.stripe.com/payments/accept-a-payment) to learn how to\nmanage your checkout flow using Payment Intents.\n\nThe following code example demonstrates how to confirm a PaymentIntent with\nMasterpass in Node.js with the Express framework:\n\n```\napp.get('/callback', async (req, res) => {\n// retrieve the PaymentIntent ID created at the beginning of the checkout flow.\n const payment_intent_id = '{{PAYMENT_INTENT_ID}}';\n\nconst payment_intent = await stripe.paymentIntents.confirm(payment_intent_id, {\n amount: 1000,\n currency: 'usd',\n payment_method_data: {\n type: 'card',\n card: {\n masterpass: {\n cart_id: '{{UNIQUE_ID}}',\n transaction_id: req.query.oauth_verifier,\n },\n },\n },\n });\n\n res.send('<h1>Charge succeeded</h1>');\n});\n```\n\nUse the Masterpass sandbox environment while testing, and the Masterpass\nproduction environment in Stripe’s live mode. When creating the source, be sure\nto use the same unique value for the `cart_id` property that you used on your\ncheckout page.\n\n## Testing Masterpass\n\nTo test your Masterpass integration against Mastercard’s sandbox, create a new\nMasterpass user account during the checkout process on your website. Configure\nthe account to use one of the [test\ncards](https://developer.mastercard.com/page/masterpass-sandbox-testing-guidelines#new-web-experience)\nfrom the Masterpass documentation. Complete the checkout process as normal,\nselecting the test card as your Masterpass payment method. If everything works\ncorrectly, Masterpass redirects you back to your application, which creates the\ncharge as expected.\n\n## Links\n\n- [Secure Remote Commerce](https://docs.stripe.com/secure-remote-commerce)\n- [implementation requirements](https://developer.mastercard.com)\n- [Operating\nRules](https://masterpass.com/assets/pdf/masterpassoperatingrules.pdf)\n- [Dashboard](https://dashboard.stripe.com/account/payments/settings)\n-\n[https://sandbox.masterpass.com/integration/merchant.js](https://sandbox.masterpass.com/integration/merchant.js)\n-\n[https://static.masterpass.com/dyn/img/btn/global/mp_chk_btn_147x034px.svg](https://static.masterpass.com/dyn/img/btn/global/mp_chk_btn_147x034px.svg)\n-\n[refer](https://developer.mastercard.com/documentation/masterpass-merchant-integration-v7/7#standard-checkout1)\n- [confirm](https://docs.stripe.com/api/payment_intents/confirm)\n- [PaymentIntent](https://docs.stripe.com/api/payment_intents)\n- [accept a payment](https://docs.stripe.com/payments/accept-a-payment)\n- [test\ncards](https://developer.mastercard.com/page/masterpass-sandbox-testing-guidelines#new-web-experience)",
  "metadata": {
    "title": "Masterpass guide | Stripe Documentation",
    "description": "Accept payments via Masterpass in your existing Stripe integration.",
    "sourceURL": "https://docs.stripe.com/masterpass"
  }
}